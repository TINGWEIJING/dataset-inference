# MINGD
# Batch size 1000, Train accuracy 60
Namespace(alpha_l_1=1.0, alpha_l_2=0.01, alpha_l_inf=0.001, batch_size=500, combine_ratio=0.5, concat=0, concat_factor=1.0, config_file=None, data_path=None, dataset='CIFAR10', device='cuda:0', distance=None, dropRate=0.0, epochs=50, epsilon_l_1=12, epsilon_l_2=0.5, epsilon_l_inf=0.03137254901960784, experiment='3-var', feature_type='mingd', gap=0.001, gpu_id=0, imagenet_architecture='wrn', k=100, lr_max=0.1, lr_min=0.0, lr_mode=1, mode='teacher', model_dataset='CIFAR10', model_id='teacher_normalized', model_type='wrn-28-10', noise_sigma=0.05, normalize=1, num_iter=500, opt_type='SGD', path=None, pseudo_labels=0, randomize=0, regressor_embed=0, restarts=1, resume=0, resume_iter=-1, reverse_train_test=0, seed=0, smallest_adv=1, target_batch_size=1000, target_epoch=0, target_te_acc=0, target_tr_acc=60)
Model Directory: ./models/CIFAR10/model_teacher_normalized_1000
File Directory: ./files/CIFAR10_1000/model_teacher_normalized_tr_acc_60
cuda:0
22-10-07 17:59
No Transform
Files already downloaded and verified
Files already downloaded and verified
No Transform
Files already downloaded and verified
Files already downloaded and verified
Loading model from ./models/CIFAR10/model_teacher_normalized_1000/tr_acc_60.pt
Traceback (most recent call last):
  File "./src/generate_features.py", line 197, in feature_extractor
    student.load_state_dict(torch.load(location, map_location = args.device)) 
  File "/home/user/tingweijing/env/DIenv/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1223, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.block1.nblockLayer.4.batch_norm1.weight", "module.block1.nblockLayer.4.batch_norm1.bias", "module.block1.nblockLayer.4.batch_norm1.running_mean", "module.block1.nblockLayer.4.batch_norm1.running_var", "module.block1.nblockLayer.4.batch_norm2.weight", "module.block1.nblockLayer.4.batch_norm2.bias", "module.block1.nblockLayer.4.batch_norm2.running_mean", "module.block1.nblockLayer.4.batch_norm2.running_var", "module.block1.nblockLayer.4.conv1.weight", "module.block1.nblockLayer.4.conv2.weight", "module.block2.nblockLayer.4.batch_norm1.weight", "module.block2.nblockLayer.4.batch_norm1.bias", "module.block2.nblockLayer.4.batch_norm1.running_mean", "module.block2.nblockLayer.4.batch_norm1.running_var", "module.block2.nblockLayer.4.batch_norm2.weight", "module.block2.nblockLayer.4.batch_norm2.bias", "module.block2.nblockLayer.4.batch_norm2.running_mean", "module.block2.nblockLayer.4.batch_norm2.running_var", "module.block2.nblockLayer.4.conv1.weight", "module.block2.nblockLayer.4.conv2.weight", "module.block3.nblockLayer.4.batch_norm1.weight", "module.block3.nblockLayer.4.batch_norm1.bias", "module.block3.nblockLayer.4.batch_norm1.running_mean", "module.block3.nblockLayer.4.batch_norm1.running_var", "module.block3.nblockLayer.4.batch_norm2.weight", "module.block3.nblockLayer.4.batch_norm2.bias", "module.block3.nblockLayer.4.batch_norm2.running_mean", "module.block3.nblockLayer.4.batch_norm2.running_var", "module.block3.nblockLayer.4.conv1.weight", "module.block3.nblockLayer.4.conv2.weight". 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "./src/generate_features.py", line 405, in <module>
    feature_extractor(args)
  File "./src/generate_features.py", line 200, in feature_extractor
    student.load_state_dict(torch.load(location, map_location = args.device))   
  File "/home/user/tingweijing/env/DIenv/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1223, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.module.conv1.weight", "module.module.block1.nblockLayer.0.batch_norm1.weight", "module.module.block1.nblockLayer.0.batch_norm1.bias", "module.module.block1.nblockLayer.0.batch_norm1.running_mean", "module.module.block1.nblockLayer.0.batch_norm1.running_var", "module.module.block1.nblockLayer.0.batch_norm2.weight", "module.module.block1.nblockLayer.0.batch_norm2.bias", "module.module.block1.nblockLayer.0.batch_norm2.running_mean", "module.module.block1.nblockLayer.0.batch_norm2.running_var", "module.module.block1.nblockLayer.0.conv1.weight", "module.module.block1.nblockLayer.0.conv2.weight", "module.module.block1.nblockLayer.0.conv_inp.weight", "module.module.block1.nblockLayer.1.batch_norm1.weight", "module.module.block1.nblockLayer.1.batch_norm1.bias", "module.module.block1.nblockLayer.1.batch_norm1.running_mean", "module.module.block1.nblockLayer.1.batch_norm1.running_var", "module.module.block1.nblockLayer.1.batch_norm2.weight", "module.module.block1.nblockLayer.1.batch_norm2.bias", "module.module.block1.nblockLayer.1.batch_norm2.running_mean", "module.module.block1.nblockLayer.1.batch_norm2.running_var", "module.module.block1.nblockLayer.1.conv1.weight", "module.module.block1.nblockLayer.1.conv2.weight", "module.module.block1.nblockLayer.2.batch_norm1.weight", "module.module.block1.nblockLayer.2.batch_norm1.bias", "module.module.block1.nblockLayer.2.batch_norm1.running_mean", "module.module.block1.nblockLayer.2.batch_norm1.running_var", "module.module.block1.nblockLayer.2.batch_norm2.weight", "module.module.block1.nblockLayer.2.batch_norm2.bias", "module.module.block1.nblockLayer.2.batch_norm2.running_mean", "module.module.block1.nblockLayer.2.batch_norm2.running_var", "module.module.block1.nblockLayer.2.conv1.weight", "module.module.block1.nblockLayer.2.conv2.weight", "module.module.block1.nblockLayer.3.batch_norm1.weight", "module.module.block1.nblockLayer.3.batch_norm1.bias", "module.module.block1.nblockLayer.3.batch_norm1.running_mean", "module.module.block1.nblockLayer.3.batch_norm1.running_var", "module.module.block1.nblockLayer.3.batch_norm2.weight", "module.module.block1.nblockLayer.3.batch_norm2.bias", "module.module.block1.nblockLayer.3.batch_norm2.running_mean", "module.module.block1.nblockLayer.3.batch_norm2.running_var", "module.module.block1.nblockLayer.3.conv1.weight", "module.module.block1.nblockLayer.3.conv2.weight", "module.module.block1.nblockLayer.4.batch_norm1.weight", "module.module.block1.nblockLayer.4.batch_norm1.bias", "module.module.block1.nblockLayer.4.batch_norm1.running_mean", "module.module.block1.nblockLayer.4.batch_norm1.running_var", "module.module.block1.nblockLayer.4.batch_norm2.weight", "module.module.block1.nblockLayer.4.batch_norm2.bias", "module.module.block1.nblockLayer.4.batch_norm2.running_mean", "module.module.block1.nblockLayer.4.batch_norm2.running_var", "module.module.block1.nblockLayer.4.conv1.weight", "module.module.block1.nblockLayer.4.conv2.weight", "module.module.block2.nblockLayer.0.batch_norm1.weight", "module.module.block2.nblockLayer.0.batch_norm1.bias", "module.module.block2.nblockLayer.0.batch_norm1.running_mean", "module.module.block2.nblockLayer.0.batch_norm1.running_var", "module.module.block2.nblockLayer.0.batch_norm2.weight", "module.module.block2.nblockLayer.0.batch_norm2.bias", "module.module.block2.nblockLayer.0.batch_norm2.running_mean", "module.module.block2.nblockLayer.0.batch_norm2.running_var", "module.module.block2.nblockLayer.0.conv1.weight", "module.module.block2.nblockLayer.0.conv2.weight", "module.module.block2.nblockLayer.0.conv_inp.weight", "module.module.block2.nblockLayer.1.batch_norm1.weight", "module.module.block2.nblockLayer.1.batch_norm1.bias", "module.module.block2.nblockLayer.1.batch_norm1.running_mean", "module.module.block2.nblockLayer.1.batch_norm1.running_var", "module.module.block2.nblockLayer.1.batch_norm2.weight", "module.module.block2.nblockLayer.1.batch_norm2.bias", "module.module.block2.nblockLayer.1.batch_norm2.running_mean", "module.module.block2.nblockLayer.1.batch_norm2.running_var", "module.module.block2.nblockLayer.1.conv1.weight", "module.module.block2.nblockLayer.1.conv2.weight", "module.module.block2.nblockLayer.2.batch_norm1.weight", "module.module.block2.nblockLayer.2.batch_norm1.bias", "module.module.block2.nblockLayer.2.batch_norm1.running_mean", "module.module.block2.nblockLayer.2.batch_norm1.running_var", "module.module.block2.nblockLayer.2.batch_norm2.weight", "module.module.block2.nblockLayer.2.batch_norm2.bias", "module.module.block2.nblockLayer.2.batch_norm2.running_mean", "module.module.block2.nblockLayer.2.batch_norm2.running_var", "module.module.block2.nblockLayer.2.conv1.weight", "module.module.block2.nblockLayer.2.conv2.weight", "module.module.block2.nblockLayer.3.batch_norm1.weight", "module.module.block2.nblockLayer.3.batch_norm1.bias", "module.module.block2.nblockLayer.3.batch_norm1.running_mean", "module.module.block2.nblockLayer.3.batch_norm1.running_var", "module.module.block2.nblockLayer.3.batch_norm2.weight", "module.module.block2.nblockLayer.3.batch_norm2.bias", "module.module.block2.nblockLayer.3.batch_norm2.running_mean", "module.module.block2.nblockLayer.3.batch_norm2.running_var", "module.module.block2.nblockLayer.3.conv1.weight", "module.module.block2.nblockLayer.3.conv2.weight", "module.module.block2.nblockLayer.4.batch_norm1.weight", "module.module.block2.nblockLayer.4.batch_norm1.bias", "module.module.block2.nblockLayer.4.batch_norm1.running_mean", "module.module.block2.nblockLayer.4.batch_norm1.running_var", "module.module.block2.nblockLayer.4.batch_norm2.weight", "module.module.block2.nblockLayer.4.batch_norm2.bias", "module.module.block2.nblockLayer.4.batch_norm2.running_mean", "module.module.block2.nblockLayer.4.batch_norm2.running_var", "module.module.block2.nblockLayer.4.conv1.weight", "module.module.block2.nblockLayer.4.conv2.weight", "module.module.block3.nblockLayer.0.batch_norm1.weight", "module.module.block3.nblockLayer.0.batch_norm1.bias", "module.module.block3.nblockLayer.0.batch_norm1.running_mean", "module.module.block3.nblockLayer.0.batch_norm1.running_var", "module.module.block3.nblockLayer.0.batch_norm2.weight", "module.module.block3.nblockLayer.0.batch_norm2.bias", "module.module.block3.nblockLayer.0.batch_norm2.running_mean", "module.module.block3.nblockLayer.0.batch_norm2.running_var", "module.module.block3.nblockLayer.0.conv1.weight", "module.module.block3.nblockLayer.0.conv2.weight", "module.module.block3.nblockLayer.0.conv_inp.weight", "module.module.block3.nblockLayer.1.batch_norm1.weight", "module.module.block3.nblockLayer.1.batch_norm1.bias", "module.module.block3.nblockLayer.1.batch_norm1.running_mean", "module.module.block3.nblockLayer.1.batch_norm1.running_var", "module.module.block3.nblockLayer.1.batch_norm2.weight", "module.module.block3.nblockLayer.1.batch_norm2.bias", "module.module.block3.nblockLayer.1.batch_norm2.running_mean", "module.module.block3.nblockLayer.1.batch_norm2.running_var", "module.module.block3.nblockLayer.1.conv1.weight", "module.module.block3.nblockLayer.1.conv2.weight", "module.module.block3.nblockLayer.2.batch_norm1.weight", "module.module.block3.nblockLayer.2.batch_norm1.bias", "module.module.block3.nblockLayer.2.batch_norm1.running_mean", "module.module.block3.nblockLayer.2.batch_norm1.running_var", "module.module.block3.nblockLayer.2.batch_norm2.weight", "module.module.block3.nblockLayer.2.batch_norm2.bias", "module.module.block3.nblockLayer.2.batch_norm2.running_mean", "module.module.block3.nblockLayer.2.batch_norm2.running_var", "module.module.block3.nblockLayer.2.conv1.weight", "module.module.block3.nblockLayer.2.conv2.weight", "module.module.block3.nblockLayer.3.batch_norm1.weight", "module.module.block3.nblockLayer.3.batch_norm1.bias", "module.module.block3.nblockLayer.3.batch_norm1.running_mean", "module.module.block3.nblockLayer.3.batch_norm1.running_var", "module.module.block3.nblockLayer.3.batch_norm2.weight", "module.module.block3.nblockLayer.3.batch_norm2.bias", "module.module.block3.nblockLayer.3.batch_norm2.running_mean", "module.module.block3.nblockLayer.3.batch_norm2.running_var", "module.module.block3.nblockLayer.3.conv1.weight", "module.module.block3.nblockLayer.3.conv2.weight", "module.module.block3.nblockLayer.4.batch_norm1.weight", "module.module.block3.nblockLayer.4.batch_norm1.bias", "module.module.block3.nblockLayer.4.batch_norm1.running_mean", "module.module.block3.nblockLayer.4.batch_norm1.running_var", "module.module.block3.nblockLayer.4.batch_norm2.weight", "module.module.block3.nblockLayer.4.batch_norm2.bias", "module.module.block3.nblockLayer.4.batch_norm2.running_mean", "module.module.block3.nblockLayer.4.batch_norm2.running_var", "module.module.block3.nblockLayer.4.conv1.weight", "module.module.block3.nblockLayer.4.conv2.weight", "module.module.batch_norm.weight", "module.module.batch_norm.bias", "module.module.batch_norm.running_mean", "module.module.batch_norm.running_var", "module.module.fc.weight", "module.module.fc.bias". 
	Unexpected key(s) in state_dict: "module.conv1.weight", "module.block1.nblockLayer.0.batch_norm1.weight", "module.block1.nblockLayer.0.batch_norm1.bias", "module.block1.nblockLayer.0.batch_norm1.running_mean", "module.block1.nblockLayer.0.batch_norm1.running_var", "module.block1.nblockLayer.0.batch_norm1.num_batches_tracked", "module.block1.nblockLayer.0.batch_norm2.weight", "module.block1.nblockLayer.0.batch_norm2.bias", "module.block1.nblockLayer.0.batch_norm2.running_mean", "module.block1.nblockLayer.0.batch_norm2.running_var", "module.block1.nblockLayer.0.batch_norm2.num_batches_tracked", "module.block1.nblockLayer.0.conv1.weight", "module.block1.nblockLayer.0.conv2.weight", "module.block1.nblockLayer.0.conv_inp.weight", "module.block1.nblockLayer.1.batch_norm1.weight", "module.block1.nblockLayer.1.batch_norm1.bias", "module.block1.nblockLayer.1.batch_norm1.running_mean", "module.block1.nblockLayer.1.batch_norm1.running_var", "module.block1.nblockLayer.1.batch_norm1.num_batches_tracked", "module.block1.nblockLayer.1.batch_norm2.weight", "module.block1.nblockLayer.1.batch_norm2.bias", "module.block1.nblockLayer.1.batch_norm2.running_mean", "module.block1.nblockLayer.1.batch_norm2.running_var", "module.block1.nblockLayer.1.batch_norm2.num_batches_tracked", "module.block1.nblockLayer.1.conv1.weight", "module.block1.nblockLayer.1.conv2.weight", "module.block1.nblockLayer.2.batch_norm1.weight", "module.block1.nblockLayer.2.batch_norm1.bias", "module.block1.nblockLayer.2.batch_norm1.running_mean", "module.block1.nblockLayer.2.batch_norm1.running_var", "module.block1.nblockLayer.2.batch_norm1.num_batches_tracked", "module.block1.nblockLayer.2.batch_norm2.weight", "module.block1.nblockLayer.2.batch_norm2.bias", "module.block1.nblockLayer.2.batch_norm2.running_mean", "module.block1.nblockLayer.2.batch_norm2.running_var", "module.block1.nblockLayer.2.batch_norm2.num_batches_tracked", "module.block1.nblockLayer.2.conv1.weight", "module.block1.nblockLayer.2.conv2.weight", "module.block1.nblockLayer.3.batch_norm1.weight", "module.block1.nblockLayer.3.batch_norm1.bias", "module.block1.nblockLayer.3.batch_norm1.running_mean", "module.block1.nblockLayer.3.batch_norm1.running_var", "module.block1.nblockLayer.3.batch_norm1.num_batches_tracked", "module.block1.nblockLayer.3.batch_norm2.weight", "module.block1.nblockLayer.3.batch_norm2.bias", "module.block1.nblockLayer.3.batch_norm2.running_mean", "module.block1.nblockLayer.3.batch_norm2.running_var", "module.block1.nblockLayer.3.batch_norm2.num_batches_tracked", "module.block1.nblockLayer.3.conv1.weight", "module.block1.nblockLayer.3.conv2.weight", "module.block2.nblockLayer.0.batch_norm1.weight", "module.block2.nblockLayer.0.batch_norm1.bias", "module.block2.nblockLayer.0.batch_norm1.running_mean", "module.block2.nblockLayer.0.batch_norm1.running_var", "module.block2.nblockLayer.0.batch_norm1.num_batches_tracked", "module.block2.nblockLayer.0.batch_norm2.weight", "module.block2.nblockLayer.0.batch_norm2.bias", "module.block2.nblockLayer.0.batch_norm2.running_mean", "module.block2.nblockLayer.0.batch_norm2.running_var", "module.block2.nblockLayer.0.batch_norm2.num_batches_tracked", "module.block2.nblockLayer.0.conv1.weight", "module.block2.nblockLayer.0.conv2.weight", "module.block2.nblockLayer.0.conv_inp.weight", "module.block2.nblockLayer.1.batch_norm1.weight", "module.block2.nblockLayer.1.batch_norm1.bias", "module.block2.nblockLayer.1.batch_norm1.running_mean", "module.block2.nblockLayer.1.batch_norm1.running_var", "module.block2.nblockLayer.1.batch_norm1.num_batches_tracked", "module.block2.nblockLayer.1.batch_norm2.weight", "module.block2.nblockLayer.1.batch_norm2.bias", "module.block2.nblockLayer.1.batch_norm2.running_mean", "module.block2.nblockLayer.1.batch_norm2.running_var", "module.block2.nblockLayer.1.batch_norm2.num_batches_tracked", "module.block2.nblockLayer.1.conv1.weight", "module.block2.nblockLayer.1.conv2.weight", "module.block2.nblockLayer.2.batch_norm1.weight", "module.block2.nblockLayer.2.batch_norm1.bias", "module.block2.nblockLayer.2.batch_norm1.running_mean", "module.block2.nblockLayer.2.batch_norm1.running_var", "module.block2.nblockLayer.2.batch_norm1.num_batches_tracked", "module.block2.nblockLayer.2.batch_norm2.weight", "module.block2.nblockLayer.2.batch_norm2.bias", "module.block2.nblockLayer.2.batch_norm2.running_mean", "module.block2.nblockLayer.2.batch_norm2.running_var", "module.block2.nblockLayer.2.batch_norm2.num_batches_tracked", "module.block2.nblockLayer.2.conv1.weight", "module.block2.nblockLayer.2.conv2.weight", "module.block2.nblockLayer.3.batch_norm1.weight", "module.block2.nblockLayer.3.batch_norm1.bias", "module.block2.nblockLayer.3.batch_norm1.running_mean", "module.block2.nblockLayer.3.batch_norm1.running_var", "module.block2.nblockLayer.3.batch_norm1.num_batches_tracked", "module.block2.nblockLayer.3.batch_norm2.weight", "module.block2.nblockLayer.3.batch_norm2.bias", "module.block2.nblockLayer.3.batch_norm2.running_mean", "module.block2.nblockLayer.3.batch_norm2.running_var", "module.block2.nblockLayer.3.batch_norm2.num_batches_tracked", "module.block2.nblockLayer.3.conv1.weight", "module.block2.nblockLayer.3.conv2.weight", "module.block3.nblockLayer.0.batch_norm1.weight", "module.block3.nblockLayer.0.batch_norm1.bias", "module.block3.nblockLayer.0.batch_norm1.running_mean", "module.block3.nblockLayer.0.batch_norm1.running_var", "module.block3.nblockLayer.0.batch_norm1.num_batches_tracked", "module.block3.nblockLayer.0.batch_norm2.weight", "module.block3.nblockLayer.0.batch_norm2.bias", "module.block3.nblockLayer.0.batch_norm2.running_mean", "module.block3.nblockLayer.0.batch_norm2.running_var", "module.block3.nblockLayer.0.batch_norm2.num_batches_tracked", "module.block3.nblockLayer.0.conv1.weight", "module.block3.nblockLayer.0.conv2.weight", "module.block3.nblockLayer.0.conv_inp.weight", "module.block3.nblockLayer.1.batch_norm1.weight", "module.block3.nblockLayer.1.batch_norm1.bias", "module.block3.nblockLayer.1.batch_norm1.running_mean", "module.block3.nblockLayer.1.batch_norm1.running_var", "module.block3.nblockLayer.1.batch_norm1.num_batches_tracked", "module.block3.nblockLayer.1.batch_norm2.weight", "module.block3.nblockLayer.1.batch_norm2.bias", "module.block3.nblockLayer.1.batch_norm2.running_mean", "module.block3.nblockLayer.1.batch_norm2.running_var", "module.block3.nblockLayer.1.batch_norm2.num_batches_tracked", "module.block3.nblockLayer.1.conv1.weight", "module.block3.nblockLayer.1.conv2.weight", "module.block3.nblockLayer.2.batch_norm1.weight", "module.block3.nblockLayer.2.batch_norm1.bias", "module.block3.nblockLayer.2.batch_norm1.running_mean", "module.block3.nblockLayer.2.batch_norm1.running_var", "module.block3.nblockLayer.2.batch_norm1.num_batches_tracked", "module.block3.nblockLayer.2.batch_norm2.weight", "module.block3.nblockLayer.2.batch_norm2.bias", "module.block3.nblockLayer.2.batch_norm2.running_mean", "module.block3.nblockLayer.2.batch_norm2.running_var", "module.block3.nblockLayer.2.batch_norm2.num_batches_tracked", "module.block3.nblockLayer.2.conv1.weight", "module.block3.nblockLayer.2.conv2.weight", "module.block3.nblockLayer.3.batch_norm1.weight", "module.block3.nblockLayer.3.batch_norm1.bias", "module.block3.nblockLayer.3.batch_norm1.running_mean", "module.block3.nblockLayer.3.batch_norm1.running_var", "module.block3.nblockLayer.3.batch_norm1.num_batches_tracked", "module.block3.nblockLayer.3.batch_norm2.weight", "module.block3.nblockLayer.3.batch_norm2.bias", "module.block3.nblockLayer.3.batch_norm2.running_mean", "module.block3.nblockLayer.3.batch_norm2.running_var", "module.block3.nblockLayer.3.batch_norm2.num_batches_tracked", "module.block3.nblockLayer.3.conv1.weight", "module.block3.nblockLayer.3.conv2.weight", "module.batch_norm.weight", "module.batch_norm.bias", "module.batch_norm.running_mean", "module.batch_norm.running_var", "module.batch_norm.num_batches_tracked", "module.fc.weight", "module.fc.bias". 
# Batch size 1000, Train accuracy 70
Namespace(alpha_l_1=1.0, alpha_l_2=0.01, alpha_l_inf=0.001, batch_size=500, combine_ratio=0.5, concat=0, concat_factor=1.0, config_file=None, data_path=None, dataset='CIFAR10', device='cuda:0', distance=None, dropRate=0.0, epochs=50, epsilon_l_1=12, epsilon_l_2=0.5, epsilon_l_inf=0.03137254901960784, experiment='3-var', feature_type='mingd', gap=0.001, gpu_id=0, imagenet_architecture='wrn', k=100, lr_max=0.1, lr_min=0.0, lr_mode=1, mode='teacher', model_dataset='CIFAR10', model_id='teacher_normalized', model_type='wrn-28-10', noise_sigma=0.05, normalize=1, num_iter=500, opt_type='SGD', path=None, pseudo_labels=0, randomize=0, regressor_embed=0, restarts=1, resume=0, resume_iter=-1, reverse_train_test=0, seed=0, smallest_adv=1, target_batch_size=1000, target_epoch=0, target_te_acc=0, target_tr_acc=70)
Model Directory: ./models/CIFAR10/model_teacher_normalized_1000
File Directory: ./files/CIFAR10_1000/model_teacher_normalized_tr_acc_70
cuda:0
22-10-07 17:59
No Transform
Files already downloaded and verified
Files already downloaded and verified
No Transform
Files already downloaded and verified
Files already downloaded and verified
Loading model from ./models/CIFAR10/model_teacher_normalized_1000/tr_acc_70.pt
Traceback (most recent call last):
  File "./src/generate_features.py", line 197, in feature_extractor
    student.load_state_dict(torch.load(location, map_location = args.device)) 
  File "/home/user/tingweijing/env/DIenv/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1223, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.block1.nblockLayer.4.batch_norm1.weight", "module.block1.nblockLayer.4.batch_norm1.bias", "module.block1.nblockLayer.4.batch_norm1.running_mean", "module.block1.nblockLayer.4.batch_norm1.running_var", "module.block1.nblockLayer.4.batch_norm2.weight", "module.block1.nblockLayer.4.batch_norm2.bias", "module.block1.nblockLayer.4.batch_norm2.running_mean", "module.block1.nblockLayer.4.batch_norm2.running_var", "module.block1.nblockLayer.4.conv1.weight", "module.block1.nblockLayer.4.conv2.weight", "module.block2.nblockLayer.4.batch_norm1.weight", "module.block2.nblockLayer.4.batch_norm1.bias", "module.block2.nblockLayer.4.batch_norm1.running_mean", "module.block2.nblockLayer.4.batch_norm1.running_var", "module.block2.nblockLayer.4.batch_norm2.weight", "module.block2.nblockLayer.4.batch_norm2.bias", "module.block2.nblockLayer.4.batch_norm2.running_mean", "module.block2.nblockLayer.4.batch_norm2.running_var", "module.block2.nblockLayer.4.conv1.weight", "module.block2.nblockLayer.4.conv2.weight", "module.block3.nblockLayer.4.batch_norm1.weight", "module.block3.nblockLayer.4.batch_norm1.bias", "module.block3.nblockLayer.4.batch_norm1.running_mean", "module.block3.nblockLayer.4.batch_norm1.running_var", "module.block3.nblockLayer.4.batch_norm2.weight", "module.block3.nblockLayer.4.batch_norm2.bias", "module.block3.nblockLayer.4.batch_norm2.running_mean", "module.block3.nblockLayer.4.batch_norm2.running_var", "module.block3.nblockLayer.4.conv1.weight", "module.block3.nblockLayer.4.conv2.weight". 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "./src/generate_features.py", line 405, in <module>
    feature_extractor(args)
  File "./src/generate_features.py", line 200, in feature_extractor
    student.load_state_dict(torch.load(location, map_location = args.device))   
  File "/home/user/tingweijing/env/DIenv/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1223, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.module.conv1.weight", "module.module.block1.nblockLayer.0.batch_norm1.weight", "module.module.block1.nblockLayer.0.batch_norm1.bias", "module.module.block1.nblockLayer.0.batch_norm1.running_mean", "module.module.block1.nblockLayer.0.batch_norm1.running_var", "module.module.block1.nblockLayer.0.batch_norm2.weight", "module.module.block1.nblockLayer.0.batch_norm2.bias", "module.module.block1.nblockLayer.0.batch_norm2.running_mean", "module.module.block1.nblockLayer.0.batch_norm2.running_var", "module.module.block1.nblockLayer.0.conv1.weight", "module.module.block1.nblockLayer.0.conv2.weight", "module.module.block1.nblockLayer.0.conv_inp.weight", "module.module.block1.nblockLayer.1.batch_norm1.weight", "module.module.block1.nblockLayer.1.batch_norm1.bias", "module.module.block1.nblockLayer.1.batch_norm1.running_mean", "module.module.block1.nblockLayer.1.batch_norm1.running_var", "module.module.block1.nblockLayer.1.batch_norm2.weight", "module.module.block1.nblockLayer.1.batch_norm2.bias", "module.module.block1.nblockLayer.1.batch_norm2.running_mean", "module.module.block1.nblockLayer.1.batch_norm2.running_var", "module.module.block1.nblockLayer.1.conv1.weight", "module.module.block1.nblockLayer.1.conv2.weight", "module.module.block1.nblockLayer.2.batch_norm1.weight", "module.module.block1.nblockLayer.2.batch_norm1.bias", "module.module.block1.nblockLayer.2.batch_norm1.running_mean", "module.module.block1.nblockLayer.2.batch_norm1.running_var", "module.module.block1.nblockLayer.2.batch_norm2.weight", "module.module.block1.nblockLayer.2.batch_norm2.bias", "module.module.block1.nblockLayer.2.batch_norm2.running_mean", "module.module.block1.nblockLayer.2.batch_norm2.running_var", "module.module.block1.nblockLayer.2.conv1.weight", "module.module.block1.nblockLayer.2.conv2.weight", "module.module.block1.nblockLayer.3.batch_norm1.weight", "module.module.block1.nblockLayer.3.batch_norm1.bias", "module.module.block1.nblockLayer.3.batch_norm1.running_mean", "module.module.block1.nblockLayer.3.batch_norm1.running_var", "module.module.block1.nblockLayer.3.batch_norm2.weight", "module.module.block1.nblockLayer.3.batch_norm2.bias", "module.module.block1.nblockLayer.3.batch_norm2.running_mean", "module.module.block1.nblockLayer.3.batch_norm2.running_var", "module.module.block1.nblockLayer.3.conv1.weight", "module.module.block1.nblockLayer.3.conv2.weight", "module.module.block1.nblockLayer.4.batch_norm1.weight", "module.module.block1.nblockLayer.4.batch_norm1.bias", "module.module.block1.nblockLayer.4.batch_norm1.running_mean", "module.module.block1.nblockLayer.4.batch_norm1.running_var", "module.module.block1.nblockLayer.4.batch_norm2.weight", "module.module.block1.nblockLayer.4.batch_norm2.bias", "module.module.block1.nblockLayer.4.batch_norm2.running_mean", "module.module.block1.nblockLayer.4.batch_norm2.running_var", "module.module.block1.nblockLayer.4.conv1.weight", "module.module.block1.nblockLayer.4.conv2.weight", "module.module.block2.nblockLayer.0.batch_norm1.weight", "module.module.block2.nblockLayer.0.batch_norm1.bias", "module.module.block2.nblockLayer.0.batch_norm1.running_mean", "module.module.block2.nblockLayer.0.batch_norm1.running_var", "module.module.block2.nblockLayer.0.batch_norm2.weight", "module.module.block2.nblockLayer.0.batch_norm2.bias", "module.module.block2.nblockLayer.0.batch_norm2.running_mean", "module.module.block2.nblockLayer.0.batch_norm2.running_var", "module.module.block2.nblockLayer.0.conv1.weight", "module.module.block2.nblockLayer.0.conv2.weight", "module.module.block2.nblockLayer.0.conv_inp.weight", "module.module.block2.nblockLayer.1.batch_norm1.weight", "module.module.block2.nblockLayer.1.batch_norm1.bias", "module.module.block2.nblockLayer.1.batch_norm1.running_mean", "module.module.block2.nblockLayer.1.batch_norm1.running_var", "module.module.block2.nblockLayer.1.batch_norm2.weight", "module.module.block2.nblockLayer.1.batch_norm2.bias", "module.module.block2.nblockLayer.1.batch_norm2.running_mean", "module.module.block2.nblockLayer.1.batch_norm2.running_var", "module.module.block2.nblockLayer.1.conv1.weight", "module.module.block2.nblockLayer.1.conv2.weight", "module.module.block2.nblockLayer.2.batch_norm1.weight", "module.module.block2.nblockLayer.2.batch_norm1.bias", "module.module.block2.nblockLayer.2.batch_norm1.running_mean", "module.module.block2.nblockLayer.2.batch_norm1.running_var", "module.module.block2.nblockLayer.2.batch_norm2.weight", "module.module.block2.nblockLayer.2.batch_norm2.bias", "module.module.block2.nblockLayer.2.batch_norm2.running_mean", "module.module.block2.nblockLayer.2.batch_norm2.running_var", "module.module.block2.nblockLayer.2.conv1.weight", "module.module.block2.nblockLayer.2.conv2.weight", "module.module.block2.nblockLayer.3.batch_norm1.weight", "module.module.block2.nblockLayer.3.batch_norm1.bias", "module.module.block2.nblockLayer.3.batch_norm1.running_mean", "module.module.block2.nblockLayer.3.batch_norm1.running_var", "module.module.block2.nblockLayer.3.batch_norm2.weight", "module.module.block2.nblockLayer.3.batch_norm2.bias", "module.module.block2.nblockLayer.3.batch_norm2.running_mean", "module.module.block2.nblockLayer.3.batch_norm2.running_var", "module.module.block2.nblockLayer.3.conv1.weight", "module.module.block2.nblockLayer.3.conv2.weight", "module.module.block2.nblockLayer.4.batch_norm1.weight", "module.module.block2.nblockLayer.4.batch_norm1.bias", "module.module.block2.nblockLayer.4.batch_norm1.running_mean", "module.module.block2.nblockLayer.4.batch_norm1.running_var", "module.module.block2.nblockLayer.4.batch_norm2.weight", "module.module.block2.nblockLayer.4.batch_norm2.bias", "module.module.block2.nblockLayer.4.batch_norm2.running_mean", "module.module.block2.nblockLayer.4.batch_norm2.running_var", "module.module.block2.nblockLayer.4.conv1.weight", "module.module.block2.nblockLayer.4.conv2.weight", "module.module.block3.nblockLayer.0.batch_norm1.weight", "module.module.block3.nblockLayer.0.batch_norm1.bias", "module.module.block3.nblockLayer.0.batch_norm1.running_mean", "module.module.block3.nblockLayer.0.batch_norm1.running_var", "module.module.block3.nblockLayer.0.batch_norm2.weight", "module.module.block3.nblockLayer.0.batch_norm2.bias", "module.module.block3.nblockLayer.0.batch_norm2.running_mean", "module.module.block3.nblockLayer.0.batch_norm2.running_var", "module.module.block3.nblockLayer.0.conv1.weight", "module.module.block3.nblockLayer.0.conv2.weight", "module.module.block3.nblockLayer.0.conv_inp.weight", "module.module.block3.nblockLayer.1.batch_norm1.weight", "module.module.block3.nblockLayer.1.batch_norm1.bias", "module.module.block3.nblockLayer.1.batch_norm1.running_mean", "module.module.block3.nblockLayer.1.batch_norm1.running_var", "module.module.block3.nblockLayer.1.batch_norm2.weight", "module.module.block3.nblockLayer.1.batch_norm2.bias", "module.module.block3.nblockLayer.1.batch_norm2.running_mean", "module.module.block3.nblockLayer.1.batch_norm2.running_var", "module.module.block3.nblockLayer.1.conv1.weight", "module.module.block3.nblockLayer.1.conv2.weight", "module.module.block3.nblockLayer.2.batch_norm1.weight", "module.module.block3.nblockLayer.2.batch_norm1.bias", "module.module.block3.nblockLayer.2.batch_norm1.running_mean", "module.module.block3.nblockLayer.2.batch_norm1.running_var", "module.module.block3.nblockLayer.2.batch_norm2.weight", "module.module.block3.nblockLayer.2.batch_norm2.bias", "module.module.block3.nblockLayer.2.batch_norm2.running_mean", "module.module.block3.nblockLayer.2.batch_norm2.running_var", "module.module.block3.nblockLayer.2.conv1.weight", "module.module.block3.nblockLayer.2.conv2.weight", "module.module.block3.nblockLayer.3.batch_norm1.weight", "module.module.block3.nblockLayer.3.batch_norm1.bias", "module.module.block3.nblockLayer.3.batch_norm1.running_mean", "module.module.block3.nblockLayer.3.batch_norm1.running_var", "module.module.block3.nblockLayer.3.batch_norm2.weight", "module.module.block3.nblockLayer.3.batch_norm2.bias", "module.module.block3.nblockLayer.3.batch_norm2.running_mean", "module.module.block3.nblockLayer.3.batch_norm2.running_var", "module.module.block3.nblockLayer.3.conv1.weight", "module.module.block3.nblockLayer.3.conv2.weight", "module.module.block3.nblockLayer.4.batch_norm1.weight", "module.module.block3.nblockLayer.4.batch_norm1.bias", "module.module.block3.nblockLayer.4.batch_norm1.running_mean", "module.module.block3.nblockLayer.4.batch_norm1.running_var", "module.module.block3.nblockLayer.4.batch_norm2.weight", "module.module.block3.nblockLayer.4.batch_norm2.bias", "module.module.block3.nblockLayer.4.batch_norm2.running_mean", "module.module.block3.nblockLayer.4.batch_norm2.running_var", "module.module.block3.nblockLayer.4.conv1.weight", "module.module.block3.nblockLayer.4.conv2.weight", "module.module.batch_norm.weight", "module.module.batch_norm.bias", "module.module.batch_norm.running_mean", "module.module.batch_norm.running_var", "module.module.fc.weight", "module.module.fc.bias". 
	Unexpected key(s) in state_dict: "module.conv1.weight", "module.block1.nblockLayer.0.batch_norm1.weight", "module.block1.nblockLayer.0.batch_norm1.bias", "module.block1.nblockLayer.0.batch_norm1.running_mean", "module.block1.nblockLayer.0.batch_norm1.running_var", "module.block1.nblockLayer.0.batch_norm1.num_batches_tracked", "module.block1.nblockLayer.0.batch_norm2.weight", "module.block1.nblockLayer.0.batch_norm2.bias", "module.block1.nblockLayer.0.batch_norm2.running_mean", "module.block1.nblockLayer.0.batch_norm2.running_var", "module.block1.nblockLayer.0.batch_norm2.num_batches_tracked", "module.block1.nblockLayer.0.conv1.weight", "module.block1.nblockLayer.0.conv2.weight", "module.block1.nblockLayer.0.conv_inp.weight", "module.block1.nblockLayer.1.batch_norm1.weight", "module.block1.nblockLayer.1.batch_norm1.bias", "module.block1.nblockLayer.1.batch_norm1.running_mean", "module.block1.nblockLayer.1.batch_norm1.running_var", "module.block1.nblockLayer.1.batch_norm1.num_batches_tracked", "module.block1.nblockLayer.1.batch_norm2.weight", "module.block1.nblockLayer.1.batch_norm2.bias", "module.block1.nblockLayer.1.batch_norm2.running_mean", "module.block1.nblockLayer.1.batch_norm2.running_var", "module.block1.nblockLayer.1.batch_norm2.num_batches_tracked", "module.block1.nblockLayer.1.conv1.weight", "module.block1.nblockLayer.1.conv2.weight", "module.block1.nblockLayer.2.batch_norm1.weight", "module.block1.nblockLayer.2.batch_norm1.bias", "module.block1.nblockLayer.2.batch_norm1.running_mean", "module.block1.nblockLayer.2.batch_norm1.running_var", "module.block1.nblockLayer.2.batch_norm1.num_batches_tracked", "module.block1.nblockLayer.2.batch_norm2.weight", "module.block1.nblockLayer.2.batch_norm2.bias", "module.block1.nblockLayer.2.batch_norm2.running_mean", "module.block1.nblockLayer.2.batch_norm2.running_var", "module.block1.nblockLayer.2.batch_norm2.num_batches_tracked", "module.block1.nblockLayer.2.conv1.weight", "module.block1.nblockLayer.2.conv2.weight", "module.block1.nblockLayer.3.batch_norm1.weight", "module.block1.nblockLayer.3.batch_norm1.bias", "module.block1.nblockLayer.3.batch_norm1.running_mean", "module.block1.nblockLayer.3.batch_norm1.running_var", "module.block1.nblockLayer.3.batch_norm1.num_batches_tracked", "module.block1.nblockLayer.3.batch_norm2.weight", "module.block1.nblockLayer.3.batch_norm2.bias", "module.block1.nblockLayer.3.batch_norm2.running_mean", "module.block1.nblockLayer.3.batch_norm2.running_var", "module.block1.nblockLayer.3.batch_norm2.num_batches_tracked", "module.block1.nblockLayer.3.conv1.weight", "module.block1.nblockLayer.3.conv2.weight", "module.block2.nblockLayer.0.batch_norm1.weight", "module.block2.nblockLayer.0.batch_norm1.bias", "module.block2.nblockLayer.0.batch_norm1.running_mean", "module.block2.nblockLayer.0.batch_norm1.running_var", "module.block2.nblockLayer.0.batch_norm1.num_batches_tracked", "module.block2.nblockLayer.0.batch_norm2.weight", "module.block2.nblockLayer.0.batch_norm2.bias", "module.block2.nblockLayer.0.batch_norm2.running_mean", "module.block2.nblockLayer.0.batch_norm2.running_var", "module.block2.nblockLayer.0.batch_norm2.num_batches_tracked", "module.block2.nblockLayer.0.conv1.weight", "module.block2.nblockLayer.0.conv2.weight", "module.block2.nblockLayer.0.conv_inp.weight", "module.block2.nblockLayer.1.batch_norm1.weight", "module.block2.nblockLayer.1.batch_norm1.bias", "module.block2.nblockLayer.1.batch_norm1.running_mean", "module.block2.nblockLayer.1.batch_norm1.running_var", "module.block2.nblockLayer.1.batch_norm1.num_batches_tracked", "module.block2.nblockLayer.1.batch_norm2.weight", "module.block2.nblockLayer.1.batch_norm2.bias", "module.block2.nblockLayer.1.batch_norm2.running_mean", "module.block2.nblockLayer.1.batch_norm2.running_var", "module.block2.nblockLayer.1.batch_norm2.num_batches_tracked", "module.block2.nblockLayer.1.conv1.weight", "module.block2.nblockLayer.1.conv2.weight", "module.block2.nblockLayer.2.batch_norm1.weight", "module.block2.nblockLayer.2.batch_norm1.bias", "module.block2.nblockLayer.2.batch_norm1.running_mean", "module.block2.nblockLayer.2.batch_norm1.running_var", "module.block2.nblockLayer.2.batch_norm1.num_batches_tracked", "module.block2.nblockLayer.2.batch_norm2.weight", "module.block2.nblockLayer.2.batch_norm2.bias", "module.block2.nblockLayer.2.batch_norm2.running_mean", "module.block2.nblockLayer.2.batch_norm2.running_var", "module.block2.nblockLayer.2.batch_norm2.num_batches_tracked", "module.block2.nblockLayer.2.conv1.weight", "module.block2.nblockLayer.2.conv2.weight", "module.block2.nblockLayer.3.batch_norm1.weight", "module.block2.nblockLayer.3.batch_norm1.bias", "module.block2.nblockLayer.3.batch_norm1.running_mean", "module.block2.nblockLayer.3.batch_norm1.running_var", "module.block2.nblockLayer.3.batch_norm1.num_batches_tracked", "module.block2.nblockLayer.3.batch_norm2.weight", "module.block2.nblockLayer.3.batch_norm2.bias", "module.block2.nblockLayer.3.batch_norm2.running_mean", "module.block2.nblockLayer.3.batch_norm2.running_var", "module.block2.nblockLayer.3.batch_norm2.num_batches_tracked", "module.block2.nblockLayer.3.conv1.weight", "module.block2.nblockLayer.3.conv2.weight", "module.block3.nblockLayer.0.batch_norm1.weight", "module.block3.nblockLayer.0.batch_norm1.bias", "module.block3.nblockLayer.0.batch_norm1.running_mean", "module.block3.nblockLayer.0.batch_norm1.running_var", "module.block3.nblockLayer.0.batch_norm1.num_batches_tracked", "module.block3.nblockLayer.0.batch_norm2.weight", "module.block3.nblockLayer.0.batch_norm2.bias", "module.block3.nblockLayer.0.batch_norm2.running_mean", "module.block3.nblockLayer.0.batch_norm2.running_var", "module.block3.nblockLayer.0.batch_norm2.num_batches_tracked", "module.block3.nblockLayer.0.conv1.weight", "module.block3.nblockLayer.0.conv2.weight", "module.block3.nblockLayer.0.conv_inp.weight", "module.block3.nblockLayer.1.batch_norm1.weight", "module.block3.nblockLayer.1.batch_norm1.bias", "module.block3.nblockLayer.1.batch_norm1.running_mean", "module.block3.nblockLayer.1.batch_norm1.running_var", "module.block3.nblockLayer.1.batch_norm1.num_batches_tracked", "module.block3.nblockLayer.1.batch_norm2.weight", "module.block3.nblockLayer.1.batch_norm2.bias", "module.block3.nblockLayer.1.batch_norm2.running_mean", "module.block3.nblockLayer.1.batch_norm2.running_var", "module.block3.nblockLayer.1.batch_norm2.num_batches_tracked", "module.block3.nblockLayer.1.conv1.weight", "module.block3.nblockLayer.1.conv2.weight", "module.block3.nblockLayer.2.batch_norm1.weight", "module.block3.nblockLayer.2.batch_norm1.bias", "module.block3.nblockLayer.2.batch_norm1.running_mean", "module.block3.nblockLayer.2.batch_norm1.running_var", "module.block3.nblockLayer.2.batch_norm1.num_batches_tracked", "module.block3.nblockLayer.2.batch_norm2.weight", "module.block3.nblockLayer.2.batch_norm2.bias", "module.block3.nblockLayer.2.batch_norm2.running_mean", "module.block3.nblockLayer.2.batch_norm2.running_var", "module.block3.nblockLayer.2.batch_norm2.num_batches_tracked", "module.block3.nblockLayer.2.conv1.weight", "module.block3.nblockLayer.2.conv2.weight", "module.block3.nblockLayer.3.batch_norm1.weight", "module.block3.nblockLayer.3.batch_norm1.bias", "module.block3.nblockLayer.3.batch_norm1.running_mean", "module.block3.nblockLayer.3.batch_norm1.running_var", "module.block3.nblockLayer.3.batch_norm1.num_batches_tracked", "module.block3.nblockLayer.3.batch_norm2.weight", "module.block3.nblockLayer.3.batch_norm2.bias", "module.block3.nblockLayer.3.batch_norm2.running_mean", "module.block3.nblockLayer.3.batch_norm2.running_var", "module.block3.nblockLayer.3.batch_norm2.num_batches_tracked", "module.block3.nblockLayer.3.conv1.weight", "module.block3.nblockLayer.3.conv2.weight", "module.batch_norm.weight", "module.batch_norm.bias", "module.batch_norm.running_mean", "module.batch_norm.running_var", "module.batch_norm.num_batches_tracked", "module.fc.weight", "module.fc.bias". 
# Batch size 1000, Train accuracy 75
Namespace(alpha_l_1=1.0, alpha_l_2=0.01, alpha_l_inf=0.001, batch_size=500, combine_ratio=0.5, concat=0, concat_factor=1.0, config_file=None, data_path=None, dataset='CIFAR10', device='cuda:0', distance=None, dropRate=0.0, epochs=50, epsilon_l_1=12, epsilon_l_2=0.5, epsilon_l_inf=0.03137254901960784, experiment='3-var', feature_type='mingd', gap=0.001, gpu_id=0, imagenet_architecture='wrn', k=100, lr_max=0.1, lr_min=0.0, lr_mode=1, mode='teacher', model_dataset='CIFAR10', model_id='teacher_normalized', model_type='wrn-28-10', noise_sigma=0.05, normalize=1, num_iter=500, opt_type='SGD', path=None, pseudo_labels=0, randomize=0, regressor_embed=0, restarts=1, resume=0, resume_iter=-1, reverse_train_test=0, seed=0, smallest_adv=1, target_batch_size=1000, target_epoch=0, target_te_acc=0, target_tr_acc=75)
Model Directory: ./models/CIFAR10/model_teacher_normalized_1000
File Directory: ./files/CIFAR10_1000/model_teacher_normalized_tr_acc_75
cuda:0
22-10-07 17:59
No Transform
Files already downloaded and verified
Files already downloaded and verified
No Transform
Files already downloaded and verified
Files already downloaded and verified
Loading model from ./models/CIFAR10/model_teacher_normalized_1000/tr_acc_75.pt
Traceback (most recent call last):
  File "./src/generate_features.py", line 197, in feature_extractor
    student.load_state_dict(torch.load(location, map_location = args.device)) 
  File "/home/user/tingweijing/env/DIenv/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1223, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.block1.nblockLayer.4.batch_norm1.weight", "module.block1.nblockLayer.4.batch_norm1.bias", "module.block1.nblockLayer.4.batch_norm1.running_mean", "module.block1.nblockLayer.4.batch_norm1.running_var", "module.block1.nblockLayer.4.batch_norm2.weight", "module.block1.nblockLayer.4.batch_norm2.bias", "module.block1.nblockLayer.4.batch_norm2.running_mean", "module.block1.nblockLayer.4.batch_norm2.running_var", "module.block1.nblockLayer.4.conv1.weight", "module.block1.nblockLayer.4.conv2.weight", "module.block2.nblockLayer.4.batch_norm1.weight", "module.block2.nblockLayer.4.batch_norm1.bias", "module.block2.nblockLayer.4.batch_norm1.running_mean", "module.block2.nblockLayer.4.batch_norm1.running_var", "module.block2.nblockLayer.4.batch_norm2.weight", "module.block2.nblockLayer.4.batch_norm2.bias", "module.block2.nblockLayer.4.batch_norm2.running_mean", "module.block2.nblockLayer.4.batch_norm2.running_var", "module.block2.nblockLayer.4.conv1.weight", "module.block2.nblockLayer.4.conv2.weight", "module.block3.nblockLayer.4.batch_norm1.weight", "module.block3.nblockLayer.4.batch_norm1.bias", "module.block3.nblockLayer.4.batch_norm1.running_mean", "module.block3.nblockLayer.4.batch_norm1.running_var", "module.block3.nblockLayer.4.batch_norm2.weight", "module.block3.nblockLayer.4.batch_norm2.bias", "module.block3.nblockLayer.4.batch_norm2.running_mean", "module.block3.nblockLayer.4.batch_norm2.running_var", "module.block3.nblockLayer.4.conv1.weight", "module.block3.nblockLayer.4.conv2.weight". 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "./src/generate_features.py", line 405, in <module>
    feature_extractor(args)
  File "./src/generate_features.py", line 200, in feature_extractor
    student.load_state_dict(torch.load(location, map_location = args.device))   
  File "/home/user/tingweijing/env/DIenv/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1223, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.module.conv1.weight", "module.module.block1.nblockLayer.0.batch_norm1.weight", "module.module.block1.nblockLayer.0.batch_norm1.bias", "module.module.block1.nblockLayer.0.batch_norm1.running_mean", "module.module.block1.nblockLayer.0.batch_norm1.running_var", "module.module.block1.nblockLayer.0.batch_norm2.weight", "module.module.block1.nblockLayer.0.batch_norm2.bias", "module.module.block1.nblockLayer.0.batch_norm2.running_mean", "module.module.block1.nblockLayer.0.batch_norm2.running_var", "module.module.block1.nblockLayer.0.conv1.weight", "module.module.block1.nblockLayer.0.conv2.weight", "module.module.block1.nblockLayer.0.conv_inp.weight", "module.module.block1.nblockLayer.1.batch_norm1.weight", "module.module.block1.nblockLayer.1.batch_norm1.bias", "module.module.block1.nblockLayer.1.batch_norm1.running_mean", "module.module.block1.nblockLayer.1.batch_norm1.running_var", "module.module.block1.nblockLayer.1.batch_norm2.weight", "module.module.block1.nblockLayer.1.batch_norm2.bias", "module.module.block1.nblockLayer.1.batch_norm2.running_mean", "module.module.block1.nblockLayer.1.batch_norm2.running_var", "module.module.block1.nblockLayer.1.conv1.weight", "module.module.block1.nblockLayer.1.conv2.weight", "module.module.block1.nblockLayer.2.batch_norm1.weight", "module.module.block1.nblockLayer.2.batch_norm1.bias", "module.module.block1.nblockLayer.2.batch_norm1.running_mean", "module.module.block1.nblockLayer.2.batch_norm1.running_var", "module.module.block1.nblockLayer.2.batch_norm2.weight", "module.module.block1.nblockLayer.2.batch_norm2.bias", "module.module.block1.nblockLayer.2.batch_norm2.running_mean", "module.module.block1.nblockLayer.2.batch_norm2.running_var", "module.module.block1.nblockLayer.2.conv1.weight", "module.module.block1.nblockLayer.2.conv2.weight", "module.module.block1.nblockLayer.3.batch_norm1.weight", "module.module.block1.nblockLayer.3.batch_norm1.bias", "module.module.block1.nblockLayer.3.batch_norm1.running_mean", "module.module.block1.nblockLayer.3.batch_norm1.running_var", "module.module.block1.nblockLayer.3.batch_norm2.weight", "module.module.block1.nblockLayer.3.batch_norm2.bias", "module.module.block1.nblockLayer.3.batch_norm2.running_mean", "module.module.block1.nblockLayer.3.batch_norm2.running_var", "module.module.block1.nblockLayer.3.conv1.weight", "module.module.block1.nblockLayer.3.conv2.weight", "module.module.block1.nblockLayer.4.batch_norm1.weight", "module.module.block1.nblockLayer.4.batch_norm1.bias", "module.module.block1.nblockLayer.4.batch_norm1.running_mean", "module.module.block1.nblockLayer.4.batch_norm1.running_var", "module.module.block1.nblockLayer.4.batch_norm2.weight", "module.module.block1.nblockLayer.4.batch_norm2.bias", "module.module.block1.nblockLayer.4.batch_norm2.running_mean", "module.module.block1.nblockLayer.4.batch_norm2.running_var", "module.module.block1.nblockLayer.4.conv1.weight", "module.module.block1.nblockLayer.4.conv2.weight", "module.module.block2.nblockLayer.0.batch_norm1.weight", "module.module.block2.nblockLayer.0.batch_norm1.bias", "module.module.block2.nblockLayer.0.batch_norm1.running_mean", "module.module.block2.nblockLayer.0.batch_norm1.running_var", "module.module.block2.nblockLayer.0.batch_norm2.weight", "module.module.block2.nblockLayer.0.batch_norm2.bias", "module.module.block2.nblockLayer.0.batch_norm2.running_mean", "module.module.block2.nblockLayer.0.batch_norm2.running_var", "module.module.block2.nblockLayer.0.conv1.weight", "module.module.block2.nblockLayer.0.conv2.weight", "module.module.block2.nblockLayer.0.conv_inp.weight", "module.module.block2.nblockLayer.1.batch_norm1.weight", "module.module.block2.nblockLayer.1.batch_norm1.bias", "module.module.block2.nblockLayer.1.batch_norm1.running_mean", "module.module.block2.nblockLayer.1.batch_norm1.running_var", "module.module.block2.nblockLayer.1.batch_norm2.weight", "module.module.block2.nblockLayer.1.batch_norm2.bias", "module.module.block2.nblockLayer.1.batch_norm2.running_mean", "module.module.block2.nblockLayer.1.batch_norm2.running_var", "module.module.block2.nblockLayer.1.conv1.weight", "module.module.block2.nblockLayer.1.conv2.weight", "module.module.block2.nblockLayer.2.batch_norm1.weight", "module.module.block2.nblockLayer.2.batch_norm1.bias", "module.module.block2.nblockLayer.2.batch_norm1.running_mean", "module.module.block2.nblockLayer.2.batch_norm1.running_var", "module.module.block2.nblockLayer.2.batch_norm2.weight", "module.module.block2.nblockLayer.2.batch_norm2.bias", "module.module.block2.nblockLayer.2.batch_norm2.running_mean", "module.module.block2.nblockLayer.2.batch_norm2.running_var", "module.module.block2.nblockLayer.2.conv1.weight", "module.module.block2.nblockLayer.2.conv2.weight", "module.module.block2.nblockLayer.3.batch_norm1.weight", "module.module.block2.nblockLayer.3.batch_norm1.bias", "module.module.block2.nblockLayer.3.batch_norm1.running_mean", "module.module.block2.nblockLayer.3.batch_norm1.running_var", "module.module.block2.nblockLayer.3.batch_norm2.weight", "module.module.block2.nblockLayer.3.batch_norm2.bias", "module.module.block2.nblockLayer.3.batch_norm2.running_mean", "module.module.block2.nblockLayer.3.batch_norm2.running_var", "module.module.block2.nblockLayer.3.conv1.weight", "module.module.block2.nblockLayer.3.conv2.weight", "module.module.block2.nblockLayer.4.batch_norm1.weight", "module.module.block2.nblockLayer.4.batch_norm1.bias", "module.module.block2.nblockLayer.4.batch_norm1.running_mean", "module.module.block2.nblockLayer.4.batch_norm1.running_var", "module.module.block2.nblockLayer.4.batch_norm2.weight", "module.module.block2.nblockLayer.4.batch_norm2.bias", "module.module.block2.nblockLayer.4.batch_norm2.running_mean", "module.module.block2.nblockLayer.4.batch_norm2.running_var", "module.module.block2.nblockLayer.4.conv1.weight", "module.module.block2.nblockLayer.4.conv2.weight", "module.module.block3.nblockLayer.0.batch_norm1.weight", "module.module.block3.nblockLayer.0.batch_norm1.bias", "module.module.block3.nblockLayer.0.batch_norm1.running_mean", "module.module.block3.nblockLayer.0.batch_norm1.running_var", "module.module.block3.nblockLayer.0.batch_norm2.weight", "module.module.block3.nblockLayer.0.batch_norm2.bias", "module.module.block3.nblockLayer.0.batch_norm2.running_mean", "module.module.block3.nblockLayer.0.batch_norm2.running_var", "module.module.block3.nblockLayer.0.conv1.weight", "module.module.block3.nblockLayer.0.conv2.weight", "module.module.block3.nblockLayer.0.conv_inp.weight", "module.module.block3.nblockLayer.1.batch_norm1.weight", "module.module.block3.nblockLayer.1.batch_norm1.bias", "module.module.block3.nblockLayer.1.batch_norm1.running_mean", "module.module.block3.nblockLayer.1.batch_norm1.running_var", "module.module.block3.nblockLayer.1.batch_norm2.weight", "module.module.block3.nblockLayer.1.batch_norm2.bias", "module.module.block3.nblockLayer.1.batch_norm2.running_mean", "module.module.block3.nblockLayer.1.batch_norm2.running_var", "module.module.block3.nblockLayer.1.conv1.weight", "module.module.block3.nblockLayer.1.conv2.weight", "module.module.block3.nblockLayer.2.batch_norm1.weight", "module.module.block3.nblockLayer.2.batch_norm1.bias", "module.module.block3.nblockLayer.2.batch_norm1.running_mean", "module.module.block3.nblockLayer.2.batch_norm1.running_var", "module.module.block3.nblockLayer.2.batch_norm2.weight", "module.module.block3.nblockLayer.2.batch_norm2.bias", "module.module.block3.nblockLayer.2.batch_norm2.running_mean", "module.module.block3.nblockLayer.2.batch_norm2.running_var", "module.module.block3.nblockLayer.2.conv1.weight", "module.module.block3.nblockLayer.2.conv2.weight", "module.module.block3.nblockLayer.3.batch_norm1.weight", "module.module.block3.nblockLayer.3.batch_norm1.bias", "module.module.block3.nblockLayer.3.batch_norm1.running_mean", "module.module.block3.nblockLayer.3.batch_norm1.running_var", "module.module.block3.nblockLayer.3.batch_norm2.weight", "module.module.block3.nblockLayer.3.batch_norm2.bias", "module.module.block3.nblockLayer.3.batch_norm2.running_mean", "module.module.block3.nblockLayer.3.batch_norm2.running_var", "module.module.block3.nblockLayer.3.conv1.weight", "module.module.block3.nblockLayer.3.conv2.weight", "module.module.block3.nblockLayer.4.batch_norm1.weight", "module.module.block3.nblockLayer.4.batch_norm1.bias", "module.module.block3.nblockLayer.4.batch_norm1.running_mean", "module.module.block3.nblockLayer.4.batch_norm1.running_var", "module.module.block3.nblockLayer.4.batch_norm2.weight", "module.module.block3.nblockLayer.4.batch_norm2.bias", "module.module.block3.nblockLayer.4.batch_norm2.running_mean", "module.module.block3.nblockLayer.4.batch_norm2.running_var", "module.module.block3.nblockLayer.4.conv1.weight", "module.module.block3.nblockLayer.4.conv2.weight", "module.module.batch_norm.weight", "module.module.batch_norm.bias", "module.module.batch_norm.running_mean", "module.module.batch_norm.running_var", "module.module.fc.weight", "module.module.fc.bias". 
	Unexpected key(s) in state_dict: "module.conv1.weight", "module.block1.nblockLayer.0.batch_norm1.weight", "module.block1.nblockLayer.0.batch_norm1.bias", "module.block1.nblockLayer.0.batch_norm1.running_mean", "module.block1.nblockLayer.0.batch_norm1.running_var", "module.block1.nblockLayer.0.batch_norm1.num_batches_tracked", "module.block1.nblockLayer.0.batch_norm2.weight", "module.block1.nblockLayer.0.batch_norm2.bias", "module.block1.nblockLayer.0.batch_norm2.running_mean", "module.block1.nblockLayer.0.batch_norm2.running_var", "module.block1.nblockLayer.0.batch_norm2.num_batches_tracked", "module.block1.nblockLayer.0.conv1.weight", "module.block1.nblockLayer.0.conv2.weight", "module.block1.nblockLayer.0.conv_inp.weight", "module.block1.nblockLayer.1.batch_norm1.weight", "module.block1.nblockLayer.1.batch_norm1.bias", "module.block1.nblockLayer.1.batch_norm1.running_mean", "module.block1.nblockLayer.1.batch_norm1.running_var", "module.block1.nblockLayer.1.batch_norm1.num_batches_tracked", "module.block1.nblockLayer.1.batch_norm2.weight", "module.block1.nblockLayer.1.batch_norm2.bias", "module.block1.nblockLayer.1.batch_norm2.running_mean", "module.block1.nblockLayer.1.batch_norm2.running_var", "module.block1.nblockLayer.1.batch_norm2.num_batches_tracked", "module.block1.nblockLayer.1.conv1.weight", "module.block1.nblockLayer.1.conv2.weight", "module.block1.nblockLayer.2.batch_norm1.weight", "module.block1.nblockLayer.2.batch_norm1.bias", "module.block1.nblockLayer.2.batch_norm1.running_mean", "module.block1.nblockLayer.2.batch_norm1.running_var", "module.block1.nblockLayer.2.batch_norm1.num_batches_tracked", "module.block1.nblockLayer.2.batch_norm2.weight", "module.block1.nblockLayer.2.batch_norm2.bias", "module.block1.nblockLayer.2.batch_norm2.running_mean", "module.block1.nblockLayer.2.batch_norm2.running_var", "module.block1.nblockLayer.2.batch_norm2.num_batches_tracked", "module.block1.nblockLayer.2.conv1.weight", "module.block1.nblockLayer.2.conv2.weight", "module.block1.nblockLayer.3.batch_norm1.weight", "module.block1.nblockLayer.3.batch_norm1.bias", "module.block1.nblockLayer.3.batch_norm1.running_mean", "module.block1.nblockLayer.3.batch_norm1.running_var", "module.block1.nblockLayer.3.batch_norm1.num_batches_tracked", "module.block1.nblockLayer.3.batch_norm2.weight", "module.block1.nblockLayer.3.batch_norm2.bias", "module.block1.nblockLayer.3.batch_norm2.running_mean", "module.block1.nblockLayer.3.batch_norm2.running_var", "module.block1.nblockLayer.3.batch_norm2.num_batches_tracked", "module.block1.nblockLayer.3.conv1.weight", "module.block1.nblockLayer.3.conv2.weight", "module.block2.nblockLayer.0.batch_norm1.weight", "module.block2.nblockLayer.0.batch_norm1.bias", "module.block2.nblockLayer.0.batch_norm1.running_mean", "module.block2.nblockLayer.0.batch_norm1.running_var", "module.block2.nblockLayer.0.batch_norm1.num_batches_tracked", "module.block2.nblockLayer.0.batch_norm2.weight", "module.block2.nblockLayer.0.batch_norm2.bias", "module.block2.nblockLayer.0.batch_norm2.running_mean", "module.block2.nblockLayer.0.batch_norm2.running_var", "module.block2.nblockLayer.0.batch_norm2.num_batches_tracked", "module.block2.nblockLayer.0.conv1.weight", "module.block2.nblockLayer.0.conv2.weight", "module.block2.nblockLayer.0.conv_inp.weight", "module.block2.nblockLayer.1.batch_norm1.weight", "module.block2.nblockLayer.1.batch_norm1.bias", "module.block2.nblockLayer.1.batch_norm1.running_mean", "module.block2.nblockLayer.1.batch_norm1.running_var", "module.block2.nblockLayer.1.batch_norm1.num_batches_tracked", "module.block2.nblockLayer.1.batch_norm2.weight", "module.block2.nblockLayer.1.batch_norm2.bias", "module.block2.nblockLayer.1.batch_norm2.running_mean", "module.block2.nblockLayer.1.batch_norm2.running_var", "module.block2.nblockLayer.1.batch_norm2.num_batches_tracked", "module.block2.nblockLayer.1.conv1.weight", "module.block2.nblockLayer.1.conv2.weight", "module.block2.nblockLayer.2.batch_norm1.weight", "module.block2.nblockLayer.2.batch_norm1.bias", "module.block2.nblockLayer.2.batch_norm1.running_mean", "module.block2.nblockLayer.2.batch_norm1.running_var", "module.block2.nblockLayer.2.batch_norm1.num_batches_tracked", "module.block2.nblockLayer.2.batch_norm2.weight", "module.block2.nblockLayer.2.batch_norm2.bias", "module.block2.nblockLayer.2.batch_norm2.running_mean", "module.block2.nblockLayer.2.batch_norm2.running_var", "module.block2.nblockLayer.2.batch_norm2.num_batches_tracked", "module.block2.nblockLayer.2.conv1.weight", "module.block2.nblockLayer.2.conv2.weight", "module.block2.nblockLayer.3.batch_norm1.weight", "module.block2.nblockLayer.3.batch_norm1.bias", "module.block2.nblockLayer.3.batch_norm1.running_mean", "module.block2.nblockLayer.3.batch_norm1.running_var", "module.block2.nblockLayer.3.batch_norm1.num_batches_tracked", "module.block2.nblockLayer.3.batch_norm2.weight", "module.block2.nblockLayer.3.batch_norm2.bias", "module.block2.nblockLayer.3.batch_norm2.running_mean", "module.block2.nblockLayer.3.batch_norm2.running_var", "module.block2.nblockLayer.3.batch_norm2.num_batches_tracked", "module.block2.nblockLayer.3.conv1.weight", "module.block2.nblockLayer.3.conv2.weight", "module.block3.nblockLayer.0.batch_norm1.weight", "module.block3.nblockLayer.0.batch_norm1.bias", "module.block3.nblockLayer.0.batch_norm1.running_mean", "module.block3.nblockLayer.0.batch_norm1.running_var", "module.block3.nblockLayer.0.batch_norm1.num_batches_tracked", "module.block3.nblockLayer.0.batch_norm2.weight", "module.block3.nblockLayer.0.batch_norm2.bias", "module.block3.nblockLayer.0.batch_norm2.running_mean", "module.block3.nblockLayer.0.batch_norm2.running_var", "module.block3.nblockLayer.0.batch_norm2.num_batches_tracked", "module.block3.nblockLayer.0.conv1.weight", "module.block3.nblockLayer.0.conv2.weight", "module.block3.nblockLayer.0.conv_inp.weight", "module.block3.nblockLayer.1.batch_norm1.weight", "module.block3.nblockLayer.1.batch_norm1.bias", "module.block3.nblockLayer.1.batch_norm1.running_mean", "module.block3.nblockLayer.1.batch_norm1.running_var", "module.block3.nblockLayer.1.batch_norm1.num_batches_tracked", "module.block3.nblockLayer.1.batch_norm2.weight", "module.block3.nblockLayer.1.batch_norm2.bias", "module.block3.nblockLayer.1.batch_norm2.running_mean", "module.block3.nblockLayer.1.batch_norm2.running_var", "module.block3.nblockLayer.1.batch_norm2.num_batches_tracked", "module.block3.nblockLayer.1.conv1.weight", "module.block3.nblockLayer.1.conv2.weight", "module.block3.nblockLayer.2.batch_norm1.weight", "module.block3.nblockLayer.2.batch_norm1.bias", "module.block3.nblockLayer.2.batch_norm1.running_mean", "module.block3.nblockLayer.2.batch_norm1.running_var", "module.block3.nblockLayer.2.batch_norm1.num_batches_tracked", "module.block3.nblockLayer.2.batch_norm2.weight", "module.block3.nblockLayer.2.batch_norm2.bias", "module.block3.nblockLayer.2.batch_norm2.running_mean", "module.block3.nblockLayer.2.batch_norm2.running_var", "module.block3.nblockLayer.2.batch_norm2.num_batches_tracked", "module.block3.nblockLayer.2.conv1.weight", "module.block3.nblockLayer.2.conv2.weight", "module.block3.nblockLayer.3.batch_norm1.weight", "module.block3.nblockLayer.3.batch_norm1.bias", "module.block3.nblockLayer.3.batch_norm1.running_mean", "module.block3.nblockLayer.3.batch_norm1.running_var", "module.block3.nblockLayer.3.batch_norm1.num_batches_tracked", "module.block3.nblockLayer.3.batch_norm2.weight", "module.block3.nblockLayer.3.batch_norm2.bias", "module.block3.nblockLayer.3.batch_norm2.running_mean", "module.block3.nblockLayer.3.batch_norm2.running_var", "module.block3.nblockLayer.3.batch_norm2.num_batches_tracked", "module.block3.nblockLayer.3.conv1.weight", "module.block3.nblockLayer.3.conv2.weight", "module.batch_norm.weight", "module.batch_norm.bias", "module.batch_norm.running_mean", "module.batch_norm.running_var", "module.batch_norm.num_batches_tracked", "module.fc.weight", "module.fc.bias". 
# Batch size 1000, Train accuracy 80
Namespace(alpha_l_1=1.0, alpha_l_2=0.01, alpha_l_inf=0.001, batch_size=500, combine_ratio=0.5, concat=0, concat_factor=1.0, config_file=None, data_path=None, dataset='CIFAR10', device='cuda:0', distance=None, dropRate=0.0, epochs=50, epsilon_l_1=12, epsilon_l_2=0.5, epsilon_l_inf=0.03137254901960784, experiment='3-var', feature_type='mingd', gap=0.001, gpu_id=0, imagenet_architecture='wrn', k=100, lr_max=0.1, lr_min=0.0, lr_mode=1, mode='teacher', model_dataset='CIFAR10', model_id='teacher_normalized', model_type='wrn-28-10', noise_sigma=0.05, normalize=1, num_iter=500, opt_type='SGD', path=None, pseudo_labels=0, randomize=0, regressor_embed=0, restarts=1, resume=0, resume_iter=-1, reverse_train_test=0, seed=0, smallest_adv=1, target_batch_size=1000, target_epoch=0, target_te_acc=0, target_tr_acc=80)
Model Directory: ./models/CIFAR10/model_teacher_normalized_1000
File Directory: ./files/CIFAR10_1000/model_teacher_normalized_tr_acc_80
cuda:0
22-10-07 17:59
No Transform
Files already downloaded and verified
Files already downloaded and verified
No Transform
Files already downloaded and verified
Files already downloaded and verified
Loading model from ./models/CIFAR10/model_teacher_normalized_1000/tr_acc_80.pt
Traceback (most recent call last):
  File "./src/generate_features.py", line 197, in feature_extractor
    student.load_state_dict(torch.load(location, map_location = args.device)) 
  File "/home/user/tingweijing/env/DIenv/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1223, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.block1.nblockLayer.4.batch_norm1.weight", "module.block1.nblockLayer.4.batch_norm1.bias", "module.block1.nblockLayer.4.batch_norm1.running_mean", "module.block1.nblockLayer.4.batch_norm1.running_var", "module.block1.nblockLayer.4.batch_norm2.weight", "module.block1.nblockLayer.4.batch_norm2.bias", "module.block1.nblockLayer.4.batch_norm2.running_mean", "module.block1.nblockLayer.4.batch_norm2.running_var", "module.block1.nblockLayer.4.conv1.weight", "module.block1.nblockLayer.4.conv2.weight", "module.block2.nblockLayer.4.batch_norm1.weight", "module.block2.nblockLayer.4.batch_norm1.bias", "module.block2.nblockLayer.4.batch_norm1.running_mean", "module.block2.nblockLayer.4.batch_norm1.running_var", "module.block2.nblockLayer.4.batch_norm2.weight", "module.block2.nblockLayer.4.batch_norm2.bias", "module.block2.nblockLayer.4.batch_norm2.running_mean", "module.block2.nblockLayer.4.batch_norm2.running_var", "module.block2.nblockLayer.4.conv1.weight", "module.block2.nblockLayer.4.conv2.weight", "module.block3.nblockLayer.4.batch_norm1.weight", "module.block3.nblockLayer.4.batch_norm1.bias", "module.block3.nblockLayer.4.batch_norm1.running_mean", "module.block3.nblockLayer.4.batch_norm1.running_var", "module.block3.nblockLayer.4.batch_norm2.weight", "module.block3.nblockLayer.4.batch_norm2.bias", "module.block3.nblockLayer.4.batch_norm2.running_mean", "module.block3.nblockLayer.4.batch_norm2.running_var", "module.block3.nblockLayer.4.conv1.weight", "module.block3.nblockLayer.4.conv2.weight". 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "./src/generate_features.py", line 405, in <module>
    feature_extractor(args)
  File "./src/generate_features.py", line 200, in feature_extractor
    student.load_state_dict(torch.load(location, map_location = args.device))   
  File "/home/user/tingweijing/env/DIenv/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1223, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.module.conv1.weight", "module.module.block1.nblockLayer.0.batch_norm1.weight", "module.module.block1.nblockLayer.0.batch_norm1.bias", "module.module.block1.nblockLayer.0.batch_norm1.running_mean", "module.module.block1.nblockLayer.0.batch_norm1.running_var", "module.module.block1.nblockLayer.0.batch_norm2.weight", "module.module.block1.nblockLayer.0.batch_norm2.bias", "module.module.block1.nblockLayer.0.batch_norm2.running_mean", "module.module.block1.nblockLayer.0.batch_norm2.running_var", "module.module.block1.nblockLayer.0.conv1.weight", "module.module.block1.nblockLayer.0.conv2.weight", "module.module.block1.nblockLayer.0.conv_inp.weight", "module.module.block1.nblockLayer.1.batch_norm1.weight", "module.module.block1.nblockLayer.1.batch_norm1.bias", "module.module.block1.nblockLayer.1.batch_norm1.running_mean", "module.module.block1.nblockLayer.1.batch_norm1.running_var", "module.module.block1.nblockLayer.1.batch_norm2.weight", "module.module.block1.nblockLayer.1.batch_norm2.bias", "module.module.block1.nblockLayer.1.batch_norm2.running_mean", "module.module.block1.nblockLayer.1.batch_norm2.running_var", "module.module.block1.nblockLayer.1.conv1.weight", "module.module.block1.nblockLayer.1.conv2.weight", "module.module.block1.nblockLayer.2.batch_norm1.weight", "module.module.block1.nblockLayer.2.batch_norm1.bias", "module.module.block1.nblockLayer.2.batch_norm1.running_mean", "module.module.block1.nblockLayer.2.batch_norm1.running_var", "module.module.block1.nblockLayer.2.batch_norm2.weight", "module.module.block1.nblockLayer.2.batch_norm2.bias", "module.module.block1.nblockLayer.2.batch_norm2.running_mean", "module.module.block1.nblockLayer.2.batch_norm2.running_var", "module.module.block1.nblockLayer.2.conv1.weight", "module.module.block1.nblockLayer.2.conv2.weight", "module.module.block1.nblockLayer.3.batch_norm1.weight", "module.module.block1.nblockLayer.3.batch_norm1.bias", "module.module.block1.nblockLayer.3.batch_norm1.running_mean", "module.module.block1.nblockLayer.3.batch_norm1.running_var", "module.module.block1.nblockLayer.3.batch_norm2.weight", "module.module.block1.nblockLayer.3.batch_norm2.bias", "module.module.block1.nblockLayer.3.batch_norm2.running_mean", "module.module.block1.nblockLayer.3.batch_norm2.running_var", "module.module.block1.nblockLayer.3.conv1.weight", "module.module.block1.nblockLayer.3.conv2.weight", "module.module.block1.nblockLayer.4.batch_norm1.weight", "module.module.block1.nblockLayer.4.batch_norm1.bias", "module.module.block1.nblockLayer.4.batch_norm1.running_mean", "module.module.block1.nblockLayer.4.batch_norm1.running_var", "module.module.block1.nblockLayer.4.batch_norm2.weight", "module.module.block1.nblockLayer.4.batch_norm2.bias", "module.module.block1.nblockLayer.4.batch_norm2.running_mean", "module.module.block1.nblockLayer.4.batch_norm2.running_var", "module.module.block1.nblockLayer.4.conv1.weight", "module.module.block1.nblockLayer.4.conv2.weight", "module.module.block2.nblockLayer.0.batch_norm1.weight", "module.module.block2.nblockLayer.0.batch_norm1.bias", "module.module.block2.nblockLayer.0.batch_norm1.running_mean", "module.module.block2.nblockLayer.0.batch_norm1.running_var", "module.module.block2.nblockLayer.0.batch_norm2.weight", "module.module.block2.nblockLayer.0.batch_norm2.bias", "module.module.block2.nblockLayer.0.batch_norm2.running_mean", "module.module.block2.nblockLayer.0.batch_norm2.running_var", "module.module.block2.nblockLayer.0.conv1.weight", "module.module.block2.nblockLayer.0.conv2.weight", "module.module.block2.nblockLayer.0.conv_inp.weight", "module.module.block2.nblockLayer.1.batch_norm1.weight", "module.module.block2.nblockLayer.1.batch_norm1.bias", "module.module.block2.nblockLayer.1.batch_norm1.running_mean", "module.module.block2.nblockLayer.1.batch_norm1.running_var", "module.module.block2.nblockLayer.1.batch_norm2.weight", "module.module.block2.nblockLayer.1.batch_norm2.bias", "module.module.block2.nblockLayer.1.batch_norm2.running_mean", "module.module.block2.nblockLayer.1.batch_norm2.running_var", "module.module.block2.nblockLayer.1.conv1.weight", "module.module.block2.nblockLayer.1.conv2.weight", "module.module.block2.nblockLayer.2.batch_norm1.weight", "module.module.block2.nblockLayer.2.batch_norm1.bias", "module.module.block2.nblockLayer.2.batch_norm1.running_mean", "module.module.block2.nblockLayer.2.batch_norm1.running_var", "module.module.block2.nblockLayer.2.batch_norm2.weight", "module.module.block2.nblockLayer.2.batch_norm2.bias", "module.module.block2.nblockLayer.2.batch_norm2.running_mean", "module.module.block2.nblockLayer.2.batch_norm2.running_var", "module.module.block2.nblockLayer.2.conv1.weight", "module.module.block2.nblockLayer.2.conv2.weight", "module.module.block2.nblockLayer.3.batch_norm1.weight", "module.module.block2.nblockLayer.3.batch_norm1.bias", "module.module.block2.nblockLayer.3.batch_norm1.running_mean", "module.module.block2.nblockLayer.3.batch_norm1.running_var", "module.module.block2.nblockLayer.3.batch_norm2.weight", "module.module.block2.nblockLayer.3.batch_norm2.bias", "module.module.block2.nblockLayer.3.batch_norm2.running_mean", "module.module.block2.nblockLayer.3.batch_norm2.running_var", "module.module.block2.nblockLayer.3.conv1.weight", "module.module.block2.nblockLayer.3.conv2.weight", "module.module.block2.nblockLayer.4.batch_norm1.weight", "module.module.block2.nblockLayer.4.batch_norm1.bias", "module.module.block2.nblockLayer.4.batch_norm1.running_mean", "module.module.block2.nblockLayer.4.batch_norm1.running_var", "module.module.block2.nblockLayer.4.batch_norm2.weight", "module.module.block2.nblockLayer.4.batch_norm2.bias", "module.module.block2.nblockLayer.4.batch_norm2.running_mean", "module.module.block2.nblockLayer.4.batch_norm2.running_var", "module.module.block2.nblockLayer.4.conv1.weight", "module.module.block2.nblockLayer.4.conv2.weight", "module.module.block3.nblockLayer.0.batch_norm1.weight", "module.module.block3.nblockLayer.0.batch_norm1.bias", "module.module.block3.nblockLayer.0.batch_norm1.running_mean", "module.module.block3.nblockLayer.0.batch_norm1.running_var", "module.module.block3.nblockLayer.0.batch_norm2.weight", "module.module.block3.nblockLayer.0.batch_norm2.bias", "module.module.block3.nblockLayer.0.batch_norm2.running_mean", "module.module.block3.nblockLayer.0.batch_norm2.running_var", "module.module.block3.nblockLayer.0.conv1.weight", "module.module.block3.nblockLayer.0.conv2.weight", "module.module.block3.nblockLayer.0.conv_inp.weight", "module.module.block3.nblockLayer.1.batch_norm1.weight", "module.module.block3.nblockLayer.1.batch_norm1.bias", "module.module.block3.nblockLayer.1.batch_norm1.running_mean", "module.module.block3.nblockLayer.1.batch_norm1.running_var", "module.module.block3.nblockLayer.1.batch_norm2.weight", "module.module.block3.nblockLayer.1.batch_norm2.bias", "module.module.block3.nblockLayer.1.batch_norm2.running_mean", "module.module.block3.nblockLayer.1.batch_norm2.running_var", "module.module.block3.nblockLayer.1.conv1.weight", "module.module.block3.nblockLayer.1.conv2.weight", "module.module.block3.nblockLayer.2.batch_norm1.weight", "module.module.block3.nblockLayer.2.batch_norm1.bias", "module.module.block3.nblockLayer.2.batch_norm1.running_mean", "module.module.block3.nblockLayer.2.batch_norm1.running_var", "module.module.block3.nblockLayer.2.batch_norm2.weight", "module.module.block3.nblockLayer.2.batch_norm2.bias", "module.module.block3.nblockLayer.2.batch_norm2.running_mean", "module.module.block3.nblockLayer.2.batch_norm2.running_var", "module.module.block3.nblockLayer.2.conv1.weight", "module.module.block3.nblockLayer.2.conv2.weight", "module.module.block3.nblockLayer.3.batch_norm1.weight", "module.module.block3.nblockLayer.3.batch_norm1.bias", "module.module.block3.nblockLayer.3.batch_norm1.running_mean", "module.module.block3.nblockLayer.3.batch_norm1.running_var", "module.module.block3.nblockLayer.3.batch_norm2.weight", "module.module.block3.nblockLayer.3.batch_norm2.bias", "module.module.block3.nblockLayer.3.batch_norm2.running_mean", "module.module.block3.nblockLayer.3.batch_norm2.running_var", "module.module.block3.nblockLayer.3.conv1.weight", "module.module.block3.nblockLayer.3.conv2.weight", "module.module.block3.nblockLayer.4.batch_norm1.weight", "module.module.block3.nblockLayer.4.batch_norm1.bias", "module.module.block3.nblockLayer.4.batch_norm1.running_mean", "module.module.block3.nblockLayer.4.batch_norm1.running_var", "module.module.block3.nblockLayer.4.batch_norm2.weight", "module.module.block3.nblockLayer.4.batch_norm2.bias", "module.module.block3.nblockLayer.4.batch_norm2.running_mean", "module.module.block3.nblockLayer.4.batch_norm2.running_var", "module.module.block3.nblockLayer.4.conv1.weight", "module.module.block3.nblockLayer.4.conv2.weight", "module.module.batch_norm.weight", "module.module.batch_norm.bias", "module.module.batch_norm.running_mean", "module.module.batch_norm.running_var", "module.module.fc.weight", "module.module.fc.bias". 
	Unexpected key(s) in state_dict: "module.conv1.weight", "module.block1.nblockLayer.0.batch_norm1.weight", "module.block1.nblockLayer.0.batch_norm1.bias", "module.block1.nblockLayer.0.batch_norm1.running_mean", "module.block1.nblockLayer.0.batch_norm1.running_var", "module.block1.nblockLayer.0.batch_norm1.num_batches_tracked", "module.block1.nblockLayer.0.batch_norm2.weight", "module.block1.nblockLayer.0.batch_norm2.bias", "module.block1.nblockLayer.0.batch_norm2.running_mean", "module.block1.nblockLayer.0.batch_norm2.running_var", "module.block1.nblockLayer.0.batch_norm2.num_batches_tracked", "module.block1.nblockLayer.0.conv1.weight", "module.block1.nblockLayer.0.conv2.weight", "module.block1.nblockLayer.0.conv_inp.weight", "module.block1.nblockLayer.1.batch_norm1.weight", "module.block1.nblockLayer.1.batch_norm1.bias", "module.block1.nblockLayer.1.batch_norm1.running_mean", "module.block1.nblockLayer.1.batch_norm1.running_var", "module.block1.nblockLayer.1.batch_norm1.num_batches_tracked", "module.block1.nblockLayer.1.batch_norm2.weight", "module.block1.nblockLayer.1.batch_norm2.bias", "module.block1.nblockLayer.1.batch_norm2.running_mean", "module.block1.nblockLayer.1.batch_norm2.running_var", "module.block1.nblockLayer.1.batch_norm2.num_batches_tracked", "module.block1.nblockLayer.1.conv1.weight", "module.block1.nblockLayer.1.conv2.weight", "module.block1.nblockLayer.2.batch_norm1.weight", "module.block1.nblockLayer.2.batch_norm1.bias", "module.block1.nblockLayer.2.batch_norm1.running_mean", "module.block1.nblockLayer.2.batch_norm1.running_var", "module.block1.nblockLayer.2.batch_norm1.num_batches_tracked", "module.block1.nblockLayer.2.batch_norm2.weight", "module.block1.nblockLayer.2.batch_norm2.bias", "module.block1.nblockLayer.2.batch_norm2.running_mean", "module.block1.nblockLayer.2.batch_norm2.running_var", "module.block1.nblockLayer.2.batch_norm2.num_batches_tracked", "module.block1.nblockLayer.2.conv1.weight", "module.block1.nblockLayer.2.conv2.weight", "module.block1.nblockLayer.3.batch_norm1.weight", "module.block1.nblockLayer.3.batch_norm1.bias", "module.block1.nblockLayer.3.batch_norm1.running_mean", "module.block1.nblockLayer.3.batch_norm1.running_var", "module.block1.nblockLayer.3.batch_norm1.num_batches_tracked", "module.block1.nblockLayer.3.batch_norm2.weight", "module.block1.nblockLayer.3.batch_norm2.bias", "module.block1.nblockLayer.3.batch_norm2.running_mean", "module.block1.nblockLayer.3.batch_norm2.running_var", "module.block1.nblockLayer.3.batch_norm2.num_batches_tracked", "module.block1.nblockLayer.3.conv1.weight", "module.block1.nblockLayer.3.conv2.weight", "module.block2.nblockLayer.0.batch_norm1.weight", "module.block2.nblockLayer.0.batch_norm1.bias", "module.block2.nblockLayer.0.batch_norm1.running_mean", "module.block2.nblockLayer.0.batch_norm1.running_var", "module.block2.nblockLayer.0.batch_norm1.num_batches_tracked", "module.block2.nblockLayer.0.batch_norm2.weight", "module.block2.nblockLayer.0.batch_norm2.bias", "module.block2.nblockLayer.0.batch_norm2.running_mean", "module.block2.nblockLayer.0.batch_norm2.running_var", "module.block2.nblockLayer.0.batch_norm2.num_batches_tracked", "module.block2.nblockLayer.0.conv1.weight", "module.block2.nblockLayer.0.conv2.weight", "module.block2.nblockLayer.0.conv_inp.weight", "module.block2.nblockLayer.1.batch_norm1.weight", "module.block2.nblockLayer.1.batch_norm1.bias", "module.block2.nblockLayer.1.batch_norm1.running_mean", "module.block2.nblockLayer.1.batch_norm1.running_var", "module.block2.nblockLayer.1.batch_norm1.num_batches_tracked", "module.block2.nblockLayer.1.batch_norm2.weight", "module.block2.nblockLayer.1.batch_norm2.bias", "module.block2.nblockLayer.1.batch_norm2.running_mean", "module.block2.nblockLayer.1.batch_norm2.running_var", "module.block2.nblockLayer.1.batch_norm2.num_batches_tracked", "module.block2.nblockLayer.1.conv1.weight", "module.block2.nblockLayer.1.conv2.weight", "module.block2.nblockLayer.2.batch_norm1.weight", "module.block2.nblockLayer.2.batch_norm1.bias", "module.block2.nblockLayer.2.batch_norm1.running_mean", "module.block2.nblockLayer.2.batch_norm1.running_var", "module.block2.nblockLayer.2.batch_norm1.num_batches_tracked", "module.block2.nblockLayer.2.batch_norm2.weight", "module.block2.nblockLayer.2.batch_norm2.bias", "module.block2.nblockLayer.2.batch_norm2.running_mean", "module.block2.nblockLayer.2.batch_norm2.running_var", "module.block2.nblockLayer.2.batch_norm2.num_batches_tracked", "module.block2.nblockLayer.2.conv1.weight", "module.block2.nblockLayer.2.conv2.weight", "module.block2.nblockLayer.3.batch_norm1.weight", "module.block2.nblockLayer.3.batch_norm1.bias", "module.block2.nblockLayer.3.batch_norm1.running_mean", "module.block2.nblockLayer.3.batch_norm1.running_var", "module.block2.nblockLayer.3.batch_norm1.num_batches_tracked", "module.block2.nblockLayer.3.batch_norm2.weight", "module.block2.nblockLayer.3.batch_norm2.bias", "module.block2.nblockLayer.3.batch_norm2.running_mean", "module.block2.nblockLayer.3.batch_norm2.running_var", "module.block2.nblockLayer.3.batch_norm2.num_batches_tracked", "module.block2.nblockLayer.3.conv1.weight", "module.block2.nblockLayer.3.conv2.weight", "module.block3.nblockLayer.0.batch_norm1.weight", "module.block3.nblockLayer.0.batch_norm1.bias", "module.block3.nblockLayer.0.batch_norm1.running_mean", "module.block3.nblockLayer.0.batch_norm1.running_var", "module.block3.nblockLayer.0.batch_norm1.num_batches_tracked", "module.block3.nblockLayer.0.batch_norm2.weight", "module.block3.nblockLayer.0.batch_norm2.bias", "module.block3.nblockLayer.0.batch_norm2.running_mean", "module.block3.nblockLayer.0.batch_norm2.running_var", "module.block3.nblockLayer.0.batch_norm2.num_batches_tracked", "module.block3.nblockLayer.0.conv1.weight", "module.block3.nblockLayer.0.conv2.weight", "module.block3.nblockLayer.0.conv_inp.weight", "module.block3.nblockLayer.1.batch_norm1.weight", "module.block3.nblockLayer.1.batch_norm1.bias", "module.block3.nblockLayer.1.batch_norm1.running_mean", "module.block3.nblockLayer.1.batch_norm1.running_var", "module.block3.nblockLayer.1.batch_norm1.num_batches_tracked", "module.block3.nblockLayer.1.batch_norm2.weight", "module.block3.nblockLayer.1.batch_norm2.bias", "module.block3.nblockLayer.1.batch_norm2.running_mean", "module.block3.nblockLayer.1.batch_norm2.running_var", "module.block3.nblockLayer.1.batch_norm2.num_batches_tracked", "module.block3.nblockLayer.1.conv1.weight", "module.block3.nblockLayer.1.conv2.weight", "module.block3.nblockLayer.2.batch_norm1.weight", "module.block3.nblockLayer.2.batch_norm1.bias", "module.block3.nblockLayer.2.batch_norm1.running_mean", "module.block3.nblockLayer.2.batch_norm1.running_var", "module.block3.nblockLayer.2.batch_norm1.num_batches_tracked", "module.block3.nblockLayer.2.batch_norm2.weight", "module.block3.nblockLayer.2.batch_norm2.bias", "module.block3.nblockLayer.2.batch_norm2.running_mean", "module.block3.nblockLayer.2.batch_norm2.running_var", "module.block3.nblockLayer.2.batch_norm2.num_batches_tracked", "module.block3.nblockLayer.2.conv1.weight", "module.block3.nblockLayer.2.conv2.weight", "module.block3.nblockLayer.3.batch_norm1.weight", "module.block3.nblockLayer.3.batch_norm1.bias", "module.block3.nblockLayer.3.batch_norm1.running_mean", "module.block3.nblockLayer.3.batch_norm1.running_var", "module.block3.nblockLayer.3.batch_norm1.num_batches_tracked", "module.block3.nblockLayer.3.batch_norm2.weight", "module.block3.nblockLayer.3.batch_norm2.bias", "module.block3.nblockLayer.3.batch_norm2.running_mean", "module.block3.nblockLayer.3.batch_norm2.running_var", "module.block3.nblockLayer.3.batch_norm2.num_batches_tracked", "module.block3.nblockLayer.3.conv1.weight", "module.block3.nblockLayer.3.conv2.weight", "module.batch_norm.weight", "module.batch_norm.bias", "module.batch_norm.running_mean", "module.batch_norm.running_var", "module.batch_norm.num_batches_tracked", "module.fc.weight", "module.fc.bias". 
# Batch size 1000, Train accuracy 85
Namespace(alpha_l_1=1.0, alpha_l_2=0.01, alpha_l_inf=0.001, batch_size=500, combine_ratio=0.5, concat=0, concat_factor=1.0, config_file=None, data_path=None, dataset='CIFAR10', device='cuda:0', distance=None, dropRate=0.0, epochs=50, epsilon_l_1=12, epsilon_l_2=0.5, epsilon_l_inf=0.03137254901960784, experiment='3-var', feature_type='mingd', gap=0.001, gpu_id=0, imagenet_architecture='wrn', k=100, lr_max=0.1, lr_min=0.0, lr_mode=1, mode='teacher', model_dataset='CIFAR10', model_id='teacher_normalized', model_type='wrn-28-10', noise_sigma=0.05, normalize=1, num_iter=500, opt_type='SGD', path=None, pseudo_labels=0, randomize=0, regressor_embed=0, restarts=1, resume=0, resume_iter=-1, reverse_train_test=0, seed=0, smallest_adv=1, target_batch_size=1000, target_epoch=0, target_te_acc=0, target_tr_acc=85)
Model Directory: ./models/CIFAR10/model_teacher_normalized_1000
File Directory: ./files/CIFAR10_1000/model_teacher_normalized_tr_acc_85
cuda:0
22-10-07 18:00
No Transform
Files already downloaded and verified
Files already downloaded and verified
No Transform
Files already downloaded and verified
Files already downloaded and verified
Loading model from ./models/CIFAR10/model_teacher_normalized_1000/tr_acc_85.pt
Traceback (most recent call last):
  File "./src/generate_features.py", line 197, in feature_extractor
    student.load_state_dict(torch.load(location, map_location = args.device)) 
  File "/home/user/tingweijing/env/DIenv/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1223, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.block1.nblockLayer.4.batch_norm1.weight", "module.block1.nblockLayer.4.batch_norm1.bias", "module.block1.nblockLayer.4.batch_norm1.running_mean", "module.block1.nblockLayer.4.batch_norm1.running_var", "module.block1.nblockLayer.4.batch_norm2.weight", "module.block1.nblockLayer.4.batch_norm2.bias", "module.block1.nblockLayer.4.batch_norm2.running_mean", "module.block1.nblockLayer.4.batch_norm2.running_var", "module.block1.nblockLayer.4.conv1.weight", "module.block1.nblockLayer.4.conv2.weight", "module.block2.nblockLayer.4.batch_norm1.weight", "module.block2.nblockLayer.4.batch_norm1.bias", "module.block2.nblockLayer.4.batch_norm1.running_mean", "module.block2.nblockLayer.4.batch_norm1.running_var", "module.block2.nblockLayer.4.batch_norm2.weight", "module.block2.nblockLayer.4.batch_norm2.bias", "module.block2.nblockLayer.4.batch_norm2.running_mean", "module.block2.nblockLayer.4.batch_norm2.running_var", "module.block2.nblockLayer.4.conv1.weight", "module.block2.nblockLayer.4.conv2.weight", "module.block3.nblockLayer.4.batch_norm1.weight", "module.block3.nblockLayer.4.batch_norm1.bias", "module.block3.nblockLayer.4.batch_norm1.running_mean", "module.block3.nblockLayer.4.batch_norm1.running_var", "module.block3.nblockLayer.4.batch_norm2.weight", "module.block3.nblockLayer.4.batch_norm2.bias", "module.block3.nblockLayer.4.batch_norm2.running_mean", "module.block3.nblockLayer.4.batch_norm2.running_var", "module.block3.nblockLayer.4.conv1.weight", "module.block3.nblockLayer.4.conv2.weight". 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "./src/generate_features.py", line 405, in <module>
    feature_extractor(args)
  File "./src/generate_features.py", line 200, in feature_extractor
    student.load_state_dict(torch.load(location, map_location = args.device))   
  File "/home/user/tingweijing/env/DIenv/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1223, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.module.conv1.weight", "module.module.block1.nblockLayer.0.batch_norm1.weight", "module.module.block1.nblockLayer.0.batch_norm1.bias", "module.module.block1.nblockLayer.0.batch_norm1.running_mean", "module.module.block1.nblockLayer.0.batch_norm1.running_var", "module.module.block1.nblockLayer.0.batch_norm2.weight", "module.module.block1.nblockLayer.0.batch_norm2.bias", "module.module.block1.nblockLayer.0.batch_norm2.running_mean", "module.module.block1.nblockLayer.0.batch_norm2.running_var", "module.module.block1.nblockLayer.0.conv1.weight", "module.module.block1.nblockLayer.0.conv2.weight", "module.module.block1.nblockLayer.0.conv_inp.weight", "module.module.block1.nblockLayer.1.batch_norm1.weight", "module.module.block1.nblockLayer.1.batch_norm1.bias", "module.module.block1.nblockLayer.1.batch_norm1.running_mean", "module.module.block1.nblockLayer.1.batch_norm1.running_var", "module.module.block1.nblockLayer.1.batch_norm2.weight", "module.module.block1.nblockLayer.1.batch_norm2.bias", "module.module.block1.nblockLayer.1.batch_norm2.running_mean", "module.module.block1.nblockLayer.1.batch_norm2.running_var", "module.module.block1.nblockLayer.1.conv1.weight", "module.module.block1.nblockLayer.1.conv2.weight", "module.module.block1.nblockLayer.2.batch_norm1.weight", "module.module.block1.nblockLayer.2.batch_norm1.bias", "module.module.block1.nblockLayer.2.batch_norm1.running_mean", "module.module.block1.nblockLayer.2.batch_norm1.running_var", "module.module.block1.nblockLayer.2.batch_norm2.weight", "module.module.block1.nblockLayer.2.batch_norm2.bias", "module.module.block1.nblockLayer.2.batch_norm2.running_mean", "module.module.block1.nblockLayer.2.batch_norm2.running_var", "module.module.block1.nblockLayer.2.conv1.weight", "module.module.block1.nblockLayer.2.conv2.weight", "module.module.block1.nblockLayer.3.batch_norm1.weight", "module.module.block1.nblockLayer.3.batch_norm1.bias", "module.module.block1.nblockLayer.3.batch_norm1.running_mean", "module.module.block1.nblockLayer.3.batch_norm1.running_var", "module.module.block1.nblockLayer.3.batch_norm2.weight", "module.module.block1.nblockLayer.3.batch_norm2.bias", "module.module.block1.nblockLayer.3.batch_norm2.running_mean", "module.module.block1.nblockLayer.3.batch_norm2.running_var", "module.module.block1.nblockLayer.3.conv1.weight", "module.module.block1.nblockLayer.3.conv2.weight", "module.module.block1.nblockLayer.4.batch_norm1.weight", "module.module.block1.nblockLayer.4.batch_norm1.bias", "module.module.block1.nblockLayer.4.batch_norm1.running_mean", "module.module.block1.nblockLayer.4.batch_norm1.running_var", "module.module.block1.nblockLayer.4.batch_norm2.weight", "module.module.block1.nblockLayer.4.batch_norm2.bias", "module.module.block1.nblockLayer.4.batch_norm2.running_mean", "module.module.block1.nblockLayer.4.batch_norm2.running_var", "module.module.block1.nblockLayer.4.conv1.weight", "module.module.block1.nblockLayer.4.conv2.weight", "module.module.block2.nblockLayer.0.batch_norm1.weight", "module.module.block2.nblockLayer.0.batch_norm1.bias", "module.module.block2.nblockLayer.0.batch_norm1.running_mean", "module.module.block2.nblockLayer.0.batch_norm1.running_var", "module.module.block2.nblockLayer.0.batch_norm2.weight", "module.module.block2.nblockLayer.0.batch_norm2.bias", "module.module.block2.nblockLayer.0.batch_norm2.running_mean", "module.module.block2.nblockLayer.0.batch_norm2.running_var", "module.module.block2.nblockLayer.0.conv1.weight", "module.module.block2.nblockLayer.0.conv2.weight", "module.module.block2.nblockLayer.0.conv_inp.weight", "module.module.block2.nblockLayer.1.batch_norm1.weight", "module.module.block2.nblockLayer.1.batch_norm1.bias", "module.module.block2.nblockLayer.1.batch_norm1.running_mean", "module.module.block2.nblockLayer.1.batch_norm1.running_var", "module.module.block2.nblockLayer.1.batch_norm2.weight", "module.module.block2.nblockLayer.1.batch_norm2.bias", "module.module.block2.nblockLayer.1.batch_norm2.running_mean", "module.module.block2.nblockLayer.1.batch_norm2.running_var", "module.module.block2.nblockLayer.1.conv1.weight", "module.module.block2.nblockLayer.1.conv2.weight", "module.module.block2.nblockLayer.2.batch_norm1.weight", "module.module.block2.nblockLayer.2.batch_norm1.bias", "module.module.block2.nblockLayer.2.batch_norm1.running_mean", "module.module.block2.nblockLayer.2.batch_norm1.running_var", "module.module.block2.nblockLayer.2.batch_norm2.weight", "module.module.block2.nblockLayer.2.batch_norm2.bias", "module.module.block2.nblockLayer.2.batch_norm2.running_mean", "module.module.block2.nblockLayer.2.batch_norm2.running_var", "module.module.block2.nblockLayer.2.conv1.weight", "module.module.block2.nblockLayer.2.conv2.weight", "module.module.block2.nblockLayer.3.batch_norm1.weight", "module.module.block2.nblockLayer.3.batch_norm1.bias", "module.module.block2.nblockLayer.3.batch_norm1.running_mean", "module.module.block2.nblockLayer.3.batch_norm1.running_var", "module.module.block2.nblockLayer.3.batch_norm2.weight", "module.module.block2.nblockLayer.3.batch_norm2.bias", "module.module.block2.nblockLayer.3.batch_norm2.running_mean", "module.module.block2.nblockLayer.3.batch_norm2.running_var", "module.module.block2.nblockLayer.3.conv1.weight", "module.module.block2.nblockLayer.3.conv2.weight", "module.module.block2.nblockLayer.4.batch_norm1.weight", "module.module.block2.nblockLayer.4.batch_norm1.bias", "module.module.block2.nblockLayer.4.batch_norm1.running_mean", "module.module.block2.nblockLayer.4.batch_norm1.running_var", "module.module.block2.nblockLayer.4.batch_norm2.weight", "module.module.block2.nblockLayer.4.batch_norm2.bias", "module.module.block2.nblockLayer.4.batch_norm2.running_mean", "module.module.block2.nblockLayer.4.batch_norm2.running_var", "module.module.block2.nblockLayer.4.conv1.weight", "module.module.block2.nblockLayer.4.conv2.weight", "module.module.block3.nblockLayer.0.batch_norm1.weight", "module.module.block3.nblockLayer.0.batch_norm1.bias", "module.module.block3.nblockLayer.0.batch_norm1.running_mean", "module.module.block3.nblockLayer.0.batch_norm1.running_var", "module.module.block3.nblockLayer.0.batch_norm2.weight", "module.module.block3.nblockLayer.0.batch_norm2.bias", "module.module.block3.nblockLayer.0.batch_norm2.running_mean", "module.module.block3.nblockLayer.0.batch_norm2.running_var", "module.module.block3.nblockLayer.0.conv1.weight", "module.module.block3.nblockLayer.0.conv2.weight", "module.module.block3.nblockLayer.0.conv_inp.weight", "module.module.block3.nblockLayer.1.batch_norm1.weight", "module.module.block3.nblockLayer.1.batch_norm1.bias", "module.module.block3.nblockLayer.1.batch_norm1.running_mean", "module.module.block3.nblockLayer.1.batch_norm1.running_var", "module.module.block3.nblockLayer.1.batch_norm2.weight", "module.module.block3.nblockLayer.1.batch_norm2.bias", "module.module.block3.nblockLayer.1.batch_norm2.running_mean", "module.module.block3.nblockLayer.1.batch_norm2.running_var", "module.module.block3.nblockLayer.1.conv1.weight", "module.module.block3.nblockLayer.1.conv2.weight", "module.module.block3.nblockLayer.2.batch_norm1.weight", "module.module.block3.nblockLayer.2.batch_norm1.bias", "module.module.block3.nblockLayer.2.batch_norm1.running_mean", "module.module.block3.nblockLayer.2.batch_norm1.running_var", "module.module.block3.nblockLayer.2.batch_norm2.weight", "module.module.block3.nblockLayer.2.batch_norm2.bias", "module.module.block3.nblockLayer.2.batch_norm2.running_mean", "module.module.block3.nblockLayer.2.batch_norm2.running_var", "module.module.block3.nblockLayer.2.conv1.weight", "module.module.block3.nblockLayer.2.conv2.weight", "module.module.block3.nblockLayer.3.batch_norm1.weight", "module.module.block3.nblockLayer.3.batch_norm1.bias", "module.module.block3.nblockLayer.3.batch_norm1.running_mean", "module.module.block3.nblockLayer.3.batch_norm1.running_var", "module.module.block3.nblockLayer.3.batch_norm2.weight", "module.module.block3.nblockLayer.3.batch_norm2.bias", "module.module.block3.nblockLayer.3.batch_norm2.running_mean", "module.module.block3.nblockLayer.3.batch_norm2.running_var", "module.module.block3.nblockLayer.3.conv1.weight", "module.module.block3.nblockLayer.3.conv2.weight", "module.module.block3.nblockLayer.4.batch_norm1.weight", "module.module.block3.nblockLayer.4.batch_norm1.bias", "module.module.block3.nblockLayer.4.batch_norm1.running_mean", "module.module.block3.nblockLayer.4.batch_norm1.running_var", "module.module.block3.nblockLayer.4.batch_norm2.weight", "module.module.block3.nblockLayer.4.batch_norm2.bias", "module.module.block3.nblockLayer.4.batch_norm2.running_mean", "module.module.block3.nblockLayer.4.batch_norm2.running_var", "module.module.block3.nblockLayer.4.conv1.weight", "module.module.block3.nblockLayer.4.conv2.weight", "module.module.batch_norm.weight", "module.module.batch_norm.bias", "module.module.batch_norm.running_mean", "module.module.batch_norm.running_var", "module.module.fc.weight", "module.module.fc.bias". 
	Unexpected key(s) in state_dict: "module.conv1.weight", "module.block1.nblockLayer.0.batch_norm1.weight", "module.block1.nblockLayer.0.batch_norm1.bias", "module.block1.nblockLayer.0.batch_norm1.running_mean", "module.block1.nblockLayer.0.batch_norm1.running_var", "module.block1.nblockLayer.0.batch_norm1.num_batches_tracked", "module.block1.nblockLayer.0.batch_norm2.weight", "module.block1.nblockLayer.0.batch_norm2.bias", "module.block1.nblockLayer.0.batch_norm2.running_mean", "module.block1.nblockLayer.0.batch_norm2.running_var", "module.block1.nblockLayer.0.batch_norm2.num_batches_tracked", "module.block1.nblockLayer.0.conv1.weight", "module.block1.nblockLayer.0.conv2.weight", "module.block1.nblockLayer.0.conv_inp.weight", "module.block1.nblockLayer.1.batch_norm1.weight", "module.block1.nblockLayer.1.batch_norm1.bias", "module.block1.nblockLayer.1.batch_norm1.running_mean", "module.block1.nblockLayer.1.batch_norm1.running_var", "module.block1.nblockLayer.1.batch_norm1.num_batches_tracked", "module.block1.nblockLayer.1.batch_norm2.weight", "module.block1.nblockLayer.1.batch_norm2.bias", "module.block1.nblockLayer.1.batch_norm2.running_mean", "module.block1.nblockLayer.1.batch_norm2.running_var", "module.block1.nblockLayer.1.batch_norm2.num_batches_tracked", "module.block1.nblockLayer.1.conv1.weight", "module.block1.nblockLayer.1.conv2.weight", "module.block1.nblockLayer.2.batch_norm1.weight", "module.block1.nblockLayer.2.batch_norm1.bias", "module.block1.nblockLayer.2.batch_norm1.running_mean", "module.block1.nblockLayer.2.batch_norm1.running_var", "module.block1.nblockLayer.2.batch_norm1.num_batches_tracked", "module.block1.nblockLayer.2.batch_norm2.weight", "module.block1.nblockLayer.2.batch_norm2.bias", "module.block1.nblockLayer.2.batch_norm2.running_mean", "module.block1.nblockLayer.2.batch_norm2.running_var", "module.block1.nblockLayer.2.batch_norm2.num_batches_tracked", "module.block1.nblockLayer.2.conv1.weight", "module.block1.nblockLayer.2.conv2.weight", "module.block1.nblockLayer.3.batch_norm1.weight", "module.block1.nblockLayer.3.batch_norm1.bias", "module.block1.nblockLayer.3.batch_norm1.running_mean", "module.block1.nblockLayer.3.batch_norm1.running_var", "module.block1.nblockLayer.3.batch_norm1.num_batches_tracked", "module.block1.nblockLayer.3.batch_norm2.weight", "module.block1.nblockLayer.3.batch_norm2.bias", "module.block1.nblockLayer.3.batch_norm2.running_mean", "module.block1.nblockLayer.3.batch_norm2.running_var", "module.block1.nblockLayer.3.batch_norm2.num_batches_tracked", "module.block1.nblockLayer.3.conv1.weight", "module.block1.nblockLayer.3.conv2.weight", "module.block2.nblockLayer.0.batch_norm1.weight", "module.block2.nblockLayer.0.batch_norm1.bias", "module.block2.nblockLayer.0.batch_norm1.running_mean", "module.block2.nblockLayer.0.batch_norm1.running_var", "module.block2.nblockLayer.0.batch_norm1.num_batches_tracked", "module.block2.nblockLayer.0.batch_norm2.weight", "module.block2.nblockLayer.0.batch_norm2.bias", "module.block2.nblockLayer.0.batch_norm2.running_mean", "module.block2.nblockLayer.0.batch_norm2.running_var", "module.block2.nblockLayer.0.batch_norm2.num_batches_tracked", "module.block2.nblockLayer.0.conv1.weight", "module.block2.nblockLayer.0.conv2.weight", "module.block2.nblockLayer.0.conv_inp.weight", "module.block2.nblockLayer.1.batch_norm1.weight", "module.block2.nblockLayer.1.batch_norm1.bias", "module.block2.nblockLayer.1.batch_norm1.running_mean", "module.block2.nblockLayer.1.batch_norm1.running_var", "module.block2.nblockLayer.1.batch_norm1.num_batches_tracked", "module.block2.nblockLayer.1.batch_norm2.weight", "module.block2.nblockLayer.1.batch_norm2.bias", "module.block2.nblockLayer.1.batch_norm2.running_mean", "module.block2.nblockLayer.1.batch_norm2.running_var", "module.block2.nblockLayer.1.batch_norm2.num_batches_tracked", "module.block2.nblockLayer.1.conv1.weight", "module.block2.nblockLayer.1.conv2.weight", "module.block2.nblockLayer.2.batch_norm1.weight", "module.block2.nblockLayer.2.batch_norm1.bias", "module.block2.nblockLayer.2.batch_norm1.running_mean", "module.block2.nblockLayer.2.batch_norm1.running_var", "module.block2.nblockLayer.2.batch_norm1.num_batches_tracked", "module.block2.nblockLayer.2.batch_norm2.weight", "module.block2.nblockLayer.2.batch_norm2.bias", "module.block2.nblockLayer.2.batch_norm2.running_mean", "module.block2.nblockLayer.2.batch_norm2.running_var", "module.block2.nblockLayer.2.batch_norm2.num_batches_tracked", "module.block2.nblockLayer.2.conv1.weight", "module.block2.nblockLayer.2.conv2.weight", "module.block2.nblockLayer.3.batch_norm1.weight", "module.block2.nblockLayer.3.batch_norm1.bias", "module.block2.nblockLayer.3.batch_norm1.running_mean", "module.block2.nblockLayer.3.batch_norm1.running_var", "module.block2.nblockLayer.3.batch_norm1.num_batches_tracked", "module.block2.nblockLayer.3.batch_norm2.weight", "module.block2.nblockLayer.3.batch_norm2.bias", "module.block2.nblockLayer.3.batch_norm2.running_mean", "module.block2.nblockLayer.3.batch_norm2.running_var", "module.block2.nblockLayer.3.batch_norm2.num_batches_tracked", "module.block2.nblockLayer.3.conv1.weight", "module.block2.nblockLayer.3.conv2.weight", "module.block3.nblockLayer.0.batch_norm1.weight", "module.block3.nblockLayer.0.batch_norm1.bias", "module.block3.nblockLayer.0.batch_norm1.running_mean", "module.block3.nblockLayer.0.batch_norm1.running_var", "module.block3.nblockLayer.0.batch_norm1.num_batches_tracked", "module.block3.nblockLayer.0.batch_norm2.weight", "module.block3.nblockLayer.0.batch_norm2.bias", "module.block3.nblockLayer.0.batch_norm2.running_mean", "module.block3.nblockLayer.0.batch_norm2.running_var", "module.block3.nblockLayer.0.batch_norm2.num_batches_tracked", "module.block3.nblockLayer.0.conv1.weight", "module.block3.nblockLayer.0.conv2.weight", "module.block3.nblockLayer.0.conv_inp.weight", "module.block3.nblockLayer.1.batch_norm1.weight", "module.block3.nblockLayer.1.batch_norm1.bias", "module.block3.nblockLayer.1.batch_norm1.running_mean", "module.block3.nblockLayer.1.batch_norm1.running_var", "module.block3.nblockLayer.1.batch_norm1.num_batches_tracked", "module.block3.nblockLayer.1.batch_norm2.weight", "module.block3.nblockLayer.1.batch_norm2.bias", "module.block3.nblockLayer.1.batch_norm2.running_mean", "module.block3.nblockLayer.1.batch_norm2.running_var", "module.block3.nblockLayer.1.batch_norm2.num_batches_tracked", "module.block3.nblockLayer.1.conv1.weight", "module.block3.nblockLayer.1.conv2.weight", "module.block3.nblockLayer.2.batch_norm1.weight", "module.block3.nblockLayer.2.batch_norm1.bias", "module.block3.nblockLayer.2.batch_norm1.running_mean", "module.block3.nblockLayer.2.batch_norm1.running_var", "module.block3.nblockLayer.2.batch_norm1.num_batches_tracked", "module.block3.nblockLayer.2.batch_norm2.weight", "module.block3.nblockLayer.2.batch_norm2.bias", "module.block3.nblockLayer.2.batch_norm2.running_mean", "module.block3.nblockLayer.2.batch_norm2.running_var", "module.block3.nblockLayer.2.batch_norm2.num_batches_tracked", "module.block3.nblockLayer.2.conv1.weight", "module.block3.nblockLayer.2.conv2.weight", "module.block3.nblockLayer.3.batch_norm1.weight", "module.block3.nblockLayer.3.batch_norm1.bias", "module.block3.nblockLayer.3.batch_norm1.running_mean", "module.block3.nblockLayer.3.batch_norm1.running_var", "module.block3.nblockLayer.3.batch_norm1.num_batches_tracked", "module.block3.nblockLayer.3.batch_norm2.weight", "module.block3.nblockLayer.3.batch_norm2.bias", "module.block3.nblockLayer.3.batch_norm2.running_mean", "module.block3.nblockLayer.3.batch_norm2.running_var", "module.block3.nblockLayer.3.batch_norm2.num_batches_tracked", "module.block3.nblockLayer.3.conv1.weight", "module.block3.nblockLayer.3.conv2.weight", "module.batch_norm.weight", "module.batch_norm.bias", "module.batch_norm.running_mean", "module.batch_norm.running_var", "module.batch_norm.num_batches_tracked", "module.fc.weight", "module.fc.bias". 
# Batch size 1000, Train accuracy 90
Namespace(alpha_l_1=1.0, alpha_l_2=0.01, alpha_l_inf=0.001, batch_size=500, combine_ratio=0.5, concat=0, concat_factor=1.0, config_file=None, data_path=None, dataset='CIFAR10', device='cuda:0', distance=None, dropRate=0.0, epochs=50, epsilon_l_1=12, epsilon_l_2=0.5, epsilon_l_inf=0.03137254901960784, experiment='3-var', feature_type='mingd', gap=0.001, gpu_id=0, imagenet_architecture='wrn', k=100, lr_max=0.1, lr_min=0.0, lr_mode=1, mode='teacher', model_dataset='CIFAR10', model_id='teacher_normalized', model_type='wrn-28-10', noise_sigma=0.05, normalize=1, num_iter=500, opt_type='SGD', path=None, pseudo_labels=0, randomize=0, regressor_embed=0, restarts=1, resume=0, resume_iter=-1, reverse_train_test=0, seed=0, smallest_adv=1, target_batch_size=1000, target_epoch=0, target_te_acc=0, target_tr_acc=90)
Model Directory: ./models/CIFAR10/model_teacher_normalized_1000
File Directory: ./files/CIFAR10_1000/model_teacher_normalized_tr_acc_90
cuda:0
22-10-07 18:00
No Transform
Files already downloaded and verified
Files already downloaded and verified
No Transform
Files already downloaded and verified
Files already downloaded and verified
Loading model from ./models/CIFAR10/model_teacher_normalized_1000/tr_acc_90.pt
Traceback (most recent call last):
  File "./src/generate_features.py", line 197, in feature_extractor
    student.load_state_dict(torch.load(location, map_location = args.device)) 
  File "/home/user/tingweijing/env/DIenv/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1223, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.block1.nblockLayer.4.batch_norm1.weight", "module.block1.nblockLayer.4.batch_norm1.bias", "module.block1.nblockLayer.4.batch_norm1.running_mean", "module.block1.nblockLayer.4.batch_norm1.running_var", "module.block1.nblockLayer.4.batch_norm2.weight", "module.block1.nblockLayer.4.batch_norm2.bias", "module.block1.nblockLayer.4.batch_norm2.running_mean", "module.block1.nblockLayer.4.batch_norm2.running_var", "module.block1.nblockLayer.4.conv1.weight", "module.block1.nblockLayer.4.conv2.weight", "module.block2.nblockLayer.4.batch_norm1.weight", "module.block2.nblockLayer.4.batch_norm1.bias", "module.block2.nblockLayer.4.batch_norm1.running_mean", "module.block2.nblockLayer.4.batch_norm1.running_var", "module.block2.nblockLayer.4.batch_norm2.weight", "module.block2.nblockLayer.4.batch_norm2.bias", "module.block2.nblockLayer.4.batch_norm2.running_mean", "module.block2.nblockLayer.4.batch_norm2.running_var", "module.block2.nblockLayer.4.conv1.weight", "module.block2.nblockLayer.4.conv2.weight", "module.block3.nblockLayer.4.batch_norm1.weight", "module.block3.nblockLayer.4.batch_norm1.bias", "module.block3.nblockLayer.4.batch_norm1.running_mean", "module.block3.nblockLayer.4.batch_norm1.running_var", "module.block3.nblockLayer.4.batch_norm2.weight", "module.block3.nblockLayer.4.batch_norm2.bias", "module.block3.nblockLayer.4.batch_norm2.running_mean", "module.block3.nblockLayer.4.batch_norm2.running_var", "module.block3.nblockLayer.4.conv1.weight", "module.block3.nblockLayer.4.conv2.weight". 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "./src/generate_features.py", line 405, in <module>
    feature_extractor(args)
  File "./src/generate_features.py", line 200, in feature_extractor
    student.load_state_dict(torch.load(location, map_location = args.device))   
  File "/home/user/tingweijing/env/DIenv/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1223, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.module.conv1.weight", "module.module.block1.nblockLayer.0.batch_norm1.weight", "module.module.block1.nblockLayer.0.batch_norm1.bias", "module.module.block1.nblockLayer.0.batch_norm1.running_mean", "module.module.block1.nblockLayer.0.batch_norm1.running_var", "module.module.block1.nblockLayer.0.batch_norm2.weight", "module.module.block1.nblockLayer.0.batch_norm2.bias", "module.module.block1.nblockLayer.0.batch_norm2.running_mean", "module.module.block1.nblockLayer.0.batch_norm2.running_var", "module.module.block1.nblockLayer.0.conv1.weight", "module.module.block1.nblockLayer.0.conv2.weight", "module.module.block1.nblockLayer.0.conv_inp.weight", "module.module.block1.nblockLayer.1.batch_norm1.weight", "module.module.block1.nblockLayer.1.batch_norm1.bias", "module.module.block1.nblockLayer.1.batch_norm1.running_mean", "module.module.block1.nblockLayer.1.batch_norm1.running_var", "module.module.block1.nblockLayer.1.batch_norm2.weight", "module.module.block1.nblockLayer.1.batch_norm2.bias", "module.module.block1.nblockLayer.1.batch_norm2.running_mean", "module.module.block1.nblockLayer.1.batch_norm2.running_var", "module.module.block1.nblockLayer.1.conv1.weight", "module.module.block1.nblockLayer.1.conv2.weight", "module.module.block1.nblockLayer.2.batch_norm1.weight", "module.module.block1.nblockLayer.2.batch_norm1.bias", "module.module.block1.nblockLayer.2.batch_norm1.running_mean", "module.module.block1.nblockLayer.2.batch_norm1.running_var", "module.module.block1.nblockLayer.2.batch_norm2.weight", "module.module.block1.nblockLayer.2.batch_norm2.bias", "module.module.block1.nblockLayer.2.batch_norm2.running_mean", "module.module.block1.nblockLayer.2.batch_norm2.running_var", "module.module.block1.nblockLayer.2.conv1.weight", "module.module.block1.nblockLayer.2.conv2.weight", "module.module.block1.nblockLayer.3.batch_norm1.weight", "module.module.block1.nblockLayer.3.batch_norm1.bias", "module.module.block1.nblockLayer.3.batch_norm1.running_mean", "module.module.block1.nblockLayer.3.batch_norm1.running_var", "module.module.block1.nblockLayer.3.batch_norm2.weight", "module.module.block1.nblockLayer.3.batch_norm2.bias", "module.module.block1.nblockLayer.3.batch_norm2.running_mean", "module.module.block1.nblockLayer.3.batch_norm2.running_var", "module.module.block1.nblockLayer.3.conv1.weight", "module.module.block1.nblockLayer.3.conv2.weight", "module.module.block1.nblockLayer.4.batch_norm1.weight", "module.module.block1.nblockLayer.4.batch_norm1.bias", "module.module.block1.nblockLayer.4.batch_norm1.running_mean", "module.module.block1.nblockLayer.4.batch_norm1.running_var", "module.module.block1.nblockLayer.4.batch_norm2.weight", "module.module.block1.nblockLayer.4.batch_norm2.bias", "module.module.block1.nblockLayer.4.batch_norm2.running_mean", "module.module.block1.nblockLayer.4.batch_norm2.running_var", "module.module.block1.nblockLayer.4.conv1.weight", "module.module.block1.nblockLayer.4.conv2.weight", "module.module.block2.nblockLayer.0.batch_norm1.weight", "module.module.block2.nblockLayer.0.batch_norm1.bias", "module.module.block2.nblockLayer.0.batch_norm1.running_mean", "module.module.block2.nblockLayer.0.batch_norm1.running_var", "module.module.block2.nblockLayer.0.batch_norm2.weight", "module.module.block2.nblockLayer.0.batch_norm2.bias", "module.module.block2.nblockLayer.0.batch_norm2.running_mean", "module.module.block2.nblockLayer.0.batch_norm2.running_var", "module.module.block2.nblockLayer.0.conv1.weight", "module.module.block2.nblockLayer.0.conv2.weight", "module.module.block2.nblockLayer.0.conv_inp.weight", "module.module.block2.nblockLayer.1.batch_norm1.weight", "module.module.block2.nblockLayer.1.batch_norm1.bias", "module.module.block2.nblockLayer.1.batch_norm1.running_mean", "module.module.block2.nblockLayer.1.batch_norm1.running_var", "module.module.block2.nblockLayer.1.batch_norm2.weight", "module.module.block2.nblockLayer.1.batch_norm2.bias", "module.module.block2.nblockLayer.1.batch_norm2.running_mean", "module.module.block2.nblockLayer.1.batch_norm2.running_var", "module.module.block2.nblockLayer.1.conv1.weight", "module.module.block2.nblockLayer.1.conv2.weight", "module.module.block2.nblockLayer.2.batch_norm1.weight", "module.module.block2.nblockLayer.2.batch_norm1.bias", "module.module.block2.nblockLayer.2.batch_norm1.running_mean", "module.module.block2.nblockLayer.2.batch_norm1.running_var", "module.module.block2.nblockLayer.2.batch_norm2.weight", "module.module.block2.nblockLayer.2.batch_norm2.bias", "module.module.block2.nblockLayer.2.batch_norm2.running_mean", "module.module.block2.nblockLayer.2.batch_norm2.running_var", "module.module.block2.nblockLayer.2.conv1.weight", "module.module.block2.nblockLayer.2.conv2.weight", "module.module.block2.nblockLayer.3.batch_norm1.weight", "module.module.block2.nblockLayer.3.batch_norm1.bias", "module.module.block2.nblockLayer.3.batch_norm1.running_mean", "module.module.block2.nblockLayer.3.batch_norm1.running_var", "module.module.block2.nblockLayer.3.batch_norm2.weight", "module.module.block2.nblockLayer.3.batch_norm2.bias", "module.module.block2.nblockLayer.3.batch_norm2.running_mean", "module.module.block2.nblockLayer.3.batch_norm2.running_var", "module.module.block2.nblockLayer.3.conv1.weight", "module.module.block2.nblockLayer.3.conv2.weight", "module.module.block2.nblockLayer.4.batch_norm1.weight", "module.module.block2.nblockLayer.4.batch_norm1.bias", "module.module.block2.nblockLayer.4.batch_norm1.running_mean", "module.module.block2.nblockLayer.4.batch_norm1.running_var", "module.module.block2.nblockLayer.4.batch_norm2.weight", "module.module.block2.nblockLayer.4.batch_norm2.bias", "module.module.block2.nblockLayer.4.batch_norm2.running_mean", "module.module.block2.nblockLayer.4.batch_norm2.running_var", "module.module.block2.nblockLayer.4.conv1.weight", "module.module.block2.nblockLayer.4.conv2.weight", "module.module.block3.nblockLayer.0.batch_norm1.weight", "module.module.block3.nblockLayer.0.batch_norm1.bias", "module.module.block3.nblockLayer.0.batch_norm1.running_mean", "module.module.block3.nblockLayer.0.batch_norm1.running_var", "module.module.block3.nblockLayer.0.batch_norm2.weight", "module.module.block3.nblockLayer.0.batch_norm2.bias", "module.module.block3.nblockLayer.0.batch_norm2.running_mean", "module.module.block3.nblockLayer.0.batch_norm2.running_var", "module.module.block3.nblockLayer.0.conv1.weight", "module.module.block3.nblockLayer.0.conv2.weight", "module.module.block3.nblockLayer.0.conv_inp.weight", "module.module.block3.nblockLayer.1.batch_norm1.weight", "module.module.block3.nblockLayer.1.batch_norm1.bias", "module.module.block3.nblockLayer.1.batch_norm1.running_mean", "module.module.block3.nblockLayer.1.batch_norm1.running_var", "module.module.block3.nblockLayer.1.batch_norm2.weight", "module.module.block3.nblockLayer.1.batch_norm2.bias", "module.module.block3.nblockLayer.1.batch_norm2.running_mean", "module.module.block3.nblockLayer.1.batch_norm2.running_var", "module.module.block3.nblockLayer.1.conv1.weight", "module.module.block3.nblockLayer.1.conv2.weight", "module.module.block3.nblockLayer.2.batch_norm1.weight", "module.module.block3.nblockLayer.2.batch_norm1.bias", "module.module.block3.nblockLayer.2.batch_norm1.running_mean", "module.module.block3.nblockLayer.2.batch_norm1.running_var", "module.module.block3.nblockLayer.2.batch_norm2.weight", "module.module.block3.nblockLayer.2.batch_norm2.bias", "module.module.block3.nblockLayer.2.batch_norm2.running_mean", "module.module.block3.nblockLayer.2.batch_norm2.running_var", "module.module.block3.nblockLayer.2.conv1.weight", "module.module.block3.nblockLayer.2.conv2.weight", "module.module.block3.nblockLayer.3.batch_norm1.weight", "module.module.block3.nblockLayer.3.batch_norm1.bias", "module.module.block3.nblockLayer.3.batch_norm1.running_mean", "module.module.block3.nblockLayer.3.batch_norm1.running_var", "module.module.block3.nblockLayer.3.batch_norm2.weight", "module.module.block3.nblockLayer.3.batch_norm2.bias", "module.module.block3.nblockLayer.3.batch_norm2.running_mean", "module.module.block3.nblockLayer.3.batch_norm2.running_var", "module.module.block3.nblockLayer.3.conv1.weight", "module.module.block3.nblockLayer.3.conv2.weight", "module.module.block3.nblockLayer.4.batch_norm1.weight", "module.module.block3.nblockLayer.4.batch_norm1.bias", "module.module.block3.nblockLayer.4.batch_norm1.running_mean", "module.module.block3.nblockLayer.4.batch_norm1.running_var", "module.module.block3.nblockLayer.4.batch_norm2.weight", "module.module.block3.nblockLayer.4.batch_norm2.bias", "module.module.block3.nblockLayer.4.batch_norm2.running_mean", "module.module.block3.nblockLayer.4.batch_norm2.running_var", "module.module.block3.nblockLayer.4.conv1.weight", "module.module.block3.nblockLayer.4.conv2.weight", "module.module.batch_norm.weight", "module.module.batch_norm.bias", "module.module.batch_norm.running_mean", "module.module.batch_norm.running_var", "module.module.fc.weight", "module.module.fc.bias". 
	Unexpected key(s) in state_dict: "module.conv1.weight", "module.block1.nblockLayer.0.batch_norm1.weight", "module.block1.nblockLayer.0.batch_norm1.bias", "module.block1.nblockLayer.0.batch_norm1.running_mean", "module.block1.nblockLayer.0.batch_norm1.running_var", "module.block1.nblockLayer.0.batch_norm1.num_batches_tracked", "module.block1.nblockLayer.0.batch_norm2.weight", "module.block1.nblockLayer.0.batch_norm2.bias", "module.block1.nblockLayer.0.batch_norm2.running_mean", "module.block1.nblockLayer.0.batch_norm2.running_var", "module.block1.nblockLayer.0.batch_norm2.num_batches_tracked", "module.block1.nblockLayer.0.conv1.weight", "module.block1.nblockLayer.0.conv2.weight", "module.block1.nblockLayer.0.conv_inp.weight", "module.block1.nblockLayer.1.batch_norm1.weight", "module.block1.nblockLayer.1.batch_norm1.bias", "module.block1.nblockLayer.1.batch_norm1.running_mean", "module.block1.nblockLayer.1.batch_norm1.running_var", "module.block1.nblockLayer.1.batch_norm1.num_batches_tracked", "module.block1.nblockLayer.1.batch_norm2.weight", "module.block1.nblockLayer.1.batch_norm2.bias", "module.block1.nblockLayer.1.batch_norm2.running_mean", "module.block1.nblockLayer.1.batch_norm2.running_var", "module.block1.nblockLayer.1.batch_norm2.num_batches_tracked", "module.block1.nblockLayer.1.conv1.weight", "module.block1.nblockLayer.1.conv2.weight", "module.block1.nblockLayer.2.batch_norm1.weight", "module.block1.nblockLayer.2.batch_norm1.bias", "module.block1.nblockLayer.2.batch_norm1.running_mean", "module.block1.nblockLayer.2.batch_norm1.running_var", "module.block1.nblockLayer.2.batch_norm1.num_batches_tracked", "module.block1.nblockLayer.2.batch_norm2.weight", "module.block1.nblockLayer.2.batch_norm2.bias", "module.block1.nblockLayer.2.batch_norm2.running_mean", "module.block1.nblockLayer.2.batch_norm2.running_var", "module.block1.nblockLayer.2.batch_norm2.num_batches_tracked", "module.block1.nblockLayer.2.conv1.weight", "module.block1.nblockLayer.2.conv2.weight", "module.block1.nblockLayer.3.batch_norm1.weight", "module.block1.nblockLayer.3.batch_norm1.bias", "module.block1.nblockLayer.3.batch_norm1.running_mean", "module.block1.nblockLayer.3.batch_norm1.running_var", "module.block1.nblockLayer.3.batch_norm1.num_batches_tracked", "module.block1.nblockLayer.3.batch_norm2.weight", "module.block1.nblockLayer.3.batch_norm2.bias", "module.block1.nblockLayer.3.batch_norm2.running_mean", "module.block1.nblockLayer.3.batch_norm2.running_var", "module.block1.nblockLayer.3.batch_norm2.num_batches_tracked", "module.block1.nblockLayer.3.conv1.weight", "module.block1.nblockLayer.3.conv2.weight", "module.block2.nblockLayer.0.batch_norm1.weight", "module.block2.nblockLayer.0.batch_norm1.bias", "module.block2.nblockLayer.0.batch_norm1.running_mean", "module.block2.nblockLayer.0.batch_norm1.running_var", "module.block2.nblockLayer.0.batch_norm1.num_batches_tracked", "module.block2.nblockLayer.0.batch_norm2.weight", "module.block2.nblockLayer.0.batch_norm2.bias", "module.block2.nblockLayer.0.batch_norm2.running_mean", "module.block2.nblockLayer.0.batch_norm2.running_var", "module.block2.nblockLayer.0.batch_norm2.num_batches_tracked", "module.block2.nblockLayer.0.conv1.weight", "module.block2.nblockLayer.0.conv2.weight", "module.block2.nblockLayer.0.conv_inp.weight", "module.block2.nblockLayer.1.batch_norm1.weight", "module.block2.nblockLayer.1.batch_norm1.bias", "module.block2.nblockLayer.1.batch_norm1.running_mean", "module.block2.nblockLayer.1.batch_norm1.running_var", "module.block2.nblockLayer.1.batch_norm1.num_batches_tracked", "module.block2.nblockLayer.1.batch_norm2.weight", "module.block2.nblockLayer.1.batch_norm2.bias", "module.block2.nblockLayer.1.batch_norm2.running_mean", "module.block2.nblockLayer.1.batch_norm2.running_var", "module.block2.nblockLayer.1.batch_norm2.num_batches_tracked", "module.block2.nblockLayer.1.conv1.weight", "module.block2.nblockLayer.1.conv2.weight", "module.block2.nblockLayer.2.batch_norm1.weight", "module.block2.nblockLayer.2.batch_norm1.bias", "module.block2.nblockLayer.2.batch_norm1.running_mean", "module.block2.nblockLayer.2.batch_norm1.running_var", "module.block2.nblockLayer.2.batch_norm1.num_batches_tracked", "module.block2.nblockLayer.2.batch_norm2.weight", "module.block2.nblockLayer.2.batch_norm2.bias", "module.block2.nblockLayer.2.batch_norm2.running_mean", "module.block2.nblockLayer.2.batch_norm2.running_var", "module.block2.nblockLayer.2.batch_norm2.num_batches_tracked", "module.block2.nblockLayer.2.conv1.weight", "module.block2.nblockLayer.2.conv2.weight", "module.block2.nblockLayer.3.batch_norm1.weight", "module.block2.nblockLayer.3.batch_norm1.bias", "module.block2.nblockLayer.3.batch_norm1.running_mean", "module.block2.nblockLayer.3.batch_norm1.running_var", "module.block2.nblockLayer.3.batch_norm1.num_batches_tracked", "module.block2.nblockLayer.3.batch_norm2.weight", "module.block2.nblockLayer.3.batch_norm2.bias", "module.block2.nblockLayer.3.batch_norm2.running_mean", "module.block2.nblockLayer.3.batch_norm2.running_var", "module.block2.nblockLayer.3.batch_norm2.num_batches_tracked", "module.block2.nblockLayer.3.conv1.weight", "module.block2.nblockLayer.3.conv2.weight", "module.block3.nblockLayer.0.batch_norm1.weight", "module.block3.nblockLayer.0.batch_norm1.bias", "module.block3.nblockLayer.0.batch_norm1.running_mean", "module.block3.nblockLayer.0.batch_norm1.running_var", "module.block3.nblockLayer.0.batch_norm1.num_batches_tracked", "module.block3.nblockLayer.0.batch_norm2.weight", "module.block3.nblockLayer.0.batch_norm2.bias", "module.block3.nblockLayer.0.batch_norm2.running_mean", "module.block3.nblockLayer.0.batch_norm2.running_var", "module.block3.nblockLayer.0.batch_norm2.num_batches_tracked", "module.block3.nblockLayer.0.conv1.weight", "module.block3.nblockLayer.0.conv2.weight", "module.block3.nblockLayer.0.conv_inp.weight", "module.block3.nblockLayer.1.batch_norm1.weight", "module.block3.nblockLayer.1.batch_norm1.bias", "module.block3.nblockLayer.1.batch_norm1.running_mean", "module.block3.nblockLayer.1.batch_norm1.running_var", "module.block3.nblockLayer.1.batch_norm1.num_batches_tracked", "module.block3.nblockLayer.1.batch_norm2.weight", "module.block3.nblockLayer.1.batch_norm2.bias", "module.block3.nblockLayer.1.batch_norm2.running_mean", "module.block3.nblockLayer.1.batch_norm2.running_var", "module.block3.nblockLayer.1.batch_norm2.num_batches_tracked", "module.block3.nblockLayer.1.conv1.weight", "module.block3.nblockLayer.1.conv2.weight", "module.block3.nblockLayer.2.batch_norm1.weight", "module.block3.nblockLayer.2.batch_norm1.bias", "module.block3.nblockLayer.2.batch_norm1.running_mean", "module.block3.nblockLayer.2.batch_norm1.running_var", "module.block3.nblockLayer.2.batch_norm1.num_batches_tracked", "module.block3.nblockLayer.2.batch_norm2.weight", "module.block3.nblockLayer.2.batch_norm2.bias", "module.block3.nblockLayer.2.batch_norm2.running_mean", "module.block3.nblockLayer.2.batch_norm2.running_var", "module.block3.nblockLayer.2.batch_norm2.num_batches_tracked", "module.block3.nblockLayer.2.conv1.weight", "module.block3.nblockLayer.2.conv2.weight", "module.block3.nblockLayer.3.batch_norm1.weight", "module.block3.nblockLayer.3.batch_norm1.bias", "module.block3.nblockLayer.3.batch_norm1.running_mean", "module.block3.nblockLayer.3.batch_norm1.running_var", "module.block3.nblockLayer.3.batch_norm1.num_batches_tracked", "module.block3.nblockLayer.3.batch_norm2.weight", "module.block3.nblockLayer.3.batch_norm2.bias", "module.block3.nblockLayer.3.batch_norm2.running_mean", "module.block3.nblockLayer.3.batch_norm2.running_var", "module.block3.nblockLayer.3.batch_norm2.num_batches_tracked", "module.block3.nblockLayer.3.conv1.weight", "module.block3.nblockLayer.3.conv2.weight", "module.batch_norm.weight", "module.batch_norm.bias", "module.batch_norm.running_mean", "module.batch_norm.running_var", "module.batch_norm.num_batches_tracked", "module.fc.weight", "module.fc.bias". 
# Batch size 1000, Train accuracy 95
Namespace(alpha_l_1=1.0, alpha_l_2=0.01, alpha_l_inf=0.001, batch_size=500, combine_ratio=0.5, concat=0, concat_factor=1.0, config_file=None, data_path=None, dataset='CIFAR10', device='cuda:0', distance=None, dropRate=0.0, epochs=50, epsilon_l_1=12, epsilon_l_2=0.5, epsilon_l_inf=0.03137254901960784, experiment='3-var', feature_type='mingd', gap=0.001, gpu_id=0, imagenet_architecture='wrn', k=100, lr_max=0.1, lr_min=0.0, lr_mode=1, mode='teacher', model_dataset='CIFAR10', model_id='teacher_normalized', model_type='wrn-28-10', noise_sigma=0.05, normalize=1, num_iter=500, opt_type='SGD', path=None, pseudo_labels=0, randomize=0, regressor_embed=0, restarts=1, resume=0, resume_iter=-1, reverse_train_test=0, seed=0, smallest_adv=1, target_batch_size=1000, target_epoch=0, target_te_acc=0, target_tr_acc=95)
Model Directory: ./models/CIFAR10/model_teacher_normalized_1000
File Directory: ./files/CIFAR10_1000/model_teacher_normalized_tr_acc_95
cuda:0
22-10-07 18:00
No Transform
Files already downloaded and verified
Files already downloaded and verified
No Transform
Files already downloaded and verified
Files already downloaded and verified
Loading model from ./models/CIFAR10/model_teacher_normalized_1000/tr_acc_95.pt
Traceback (most recent call last):
  File "./src/generate_features.py", line 197, in feature_extractor
    student.load_state_dict(torch.load(location, map_location = args.device)) 
  File "/home/user/tingweijing/env/DIenv/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1223, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.block1.nblockLayer.4.batch_norm1.weight", "module.block1.nblockLayer.4.batch_norm1.bias", "module.block1.nblockLayer.4.batch_norm1.running_mean", "module.block1.nblockLayer.4.batch_norm1.running_var", "module.block1.nblockLayer.4.batch_norm2.weight", "module.block1.nblockLayer.4.batch_norm2.bias", "module.block1.nblockLayer.4.batch_norm2.running_mean", "module.block1.nblockLayer.4.batch_norm2.running_var", "module.block1.nblockLayer.4.conv1.weight", "module.block1.nblockLayer.4.conv2.weight", "module.block2.nblockLayer.4.batch_norm1.weight", "module.block2.nblockLayer.4.batch_norm1.bias", "module.block2.nblockLayer.4.batch_norm1.running_mean", "module.block2.nblockLayer.4.batch_norm1.running_var", "module.block2.nblockLayer.4.batch_norm2.weight", "module.block2.nblockLayer.4.batch_norm2.bias", "module.block2.nblockLayer.4.batch_norm2.running_mean", "module.block2.nblockLayer.4.batch_norm2.running_var", "module.block2.nblockLayer.4.conv1.weight", "module.block2.nblockLayer.4.conv2.weight", "module.block3.nblockLayer.4.batch_norm1.weight", "module.block3.nblockLayer.4.batch_norm1.bias", "module.block3.nblockLayer.4.batch_norm1.running_mean", "module.block3.nblockLayer.4.batch_norm1.running_var", "module.block3.nblockLayer.4.batch_norm2.weight", "module.block3.nblockLayer.4.batch_norm2.bias", "module.block3.nblockLayer.4.batch_norm2.running_mean", "module.block3.nblockLayer.4.batch_norm2.running_var", "module.block3.nblockLayer.4.conv1.weight", "module.block3.nblockLayer.4.conv2.weight". 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "./src/generate_features.py", line 405, in <module>
    feature_extractor(args)
  File "./src/generate_features.py", line 200, in feature_extractor
    student.load_state_dict(torch.load(location, map_location = args.device))   
  File "/home/user/tingweijing/env/DIenv/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1223, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.module.conv1.weight", "module.module.block1.nblockLayer.0.batch_norm1.weight", "module.module.block1.nblockLayer.0.batch_norm1.bias", "module.module.block1.nblockLayer.0.batch_norm1.running_mean", "module.module.block1.nblockLayer.0.batch_norm1.running_var", "module.module.block1.nblockLayer.0.batch_norm2.weight", "module.module.block1.nblockLayer.0.batch_norm2.bias", "module.module.block1.nblockLayer.0.batch_norm2.running_mean", "module.module.block1.nblockLayer.0.batch_norm2.running_var", "module.module.block1.nblockLayer.0.conv1.weight", "module.module.block1.nblockLayer.0.conv2.weight", "module.module.block1.nblockLayer.0.conv_inp.weight", "module.module.block1.nblockLayer.1.batch_norm1.weight", "module.module.block1.nblockLayer.1.batch_norm1.bias", "module.module.block1.nblockLayer.1.batch_norm1.running_mean", "module.module.block1.nblockLayer.1.batch_norm1.running_var", "module.module.block1.nblockLayer.1.batch_norm2.weight", "module.module.block1.nblockLayer.1.batch_norm2.bias", "module.module.block1.nblockLayer.1.batch_norm2.running_mean", "module.module.block1.nblockLayer.1.batch_norm2.running_var", "module.module.block1.nblockLayer.1.conv1.weight", "module.module.block1.nblockLayer.1.conv2.weight", "module.module.block1.nblockLayer.2.batch_norm1.weight", "module.module.block1.nblockLayer.2.batch_norm1.bias", "module.module.block1.nblockLayer.2.batch_norm1.running_mean", "module.module.block1.nblockLayer.2.batch_norm1.running_var", "module.module.block1.nblockLayer.2.batch_norm2.weight", "module.module.block1.nblockLayer.2.batch_norm2.bias", "module.module.block1.nblockLayer.2.batch_norm2.running_mean", "module.module.block1.nblockLayer.2.batch_norm2.running_var", "module.module.block1.nblockLayer.2.conv1.weight", "module.module.block1.nblockLayer.2.conv2.weight", "module.module.block1.nblockLayer.3.batch_norm1.weight", "module.module.block1.nblockLayer.3.batch_norm1.bias", "module.module.block1.nblockLayer.3.batch_norm1.running_mean", "module.module.block1.nblockLayer.3.batch_norm1.running_var", "module.module.block1.nblockLayer.3.batch_norm2.weight", "module.module.block1.nblockLayer.3.batch_norm2.bias", "module.module.block1.nblockLayer.3.batch_norm2.running_mean", "module.module.block1.nblockLayer.3.batch_norm2.running_var", "module.module.block1.nblockLayer.3.conv1.weight", "module.module.block1.nblockLayer.3.conv2.weight", "module.module.block1.nblockLayer.4.batch_norm1.weight", "module.module.block1.nblockLayer.4.batch_norm1.bias", "module.module.block1.nblockLayer.4.batch_norm1.running_mean", "module.module.block1.nblockLayer.4.batch_norm1.running_var", "module.module.block1.nblockLayer.4.batch_norm2.weight", "module.module.block1.nblockLayer.4.batch_norm2.bias", "module.module.block1.nblockLayer.4.batch_norm2.running_mean", "module.module.block1.nblockLayer.4.batch_norm2.running_var", "module.module.block1.nblockLayer.4.conv1.weight", "module.module.block1.nblockLayer.4.conv2.weight", "module.module.block2.nblockLayer.0.batch_norm1.weight", "module.module.block2.nblockLayer.0.batch_norm1.bias", "module.module.block2.nblockLayer.0.batch_norm1.running_mean", "module.module.block2.nblockLayer.0.batch_norm1.running_var", "module.module.block2.nblockLayer.0.batch_norm2.weight", "module.module.block2.nblockLayer.0.batch_norm2.bias", "module.module.block2.nblockLayer.0.batch_norm2.running_mean", "module.module.block2.nblockLayer.0.batch_norm2.running_var", "module.module.block2.nblockLayer.0.conv1.weight", "module.module.block2.nblockLayer.0.conv2.weight", "module.module.block2.nblockLayer.0.conv_inp.weight", "module.module.block2.nblockLayer.1.batch_norm1.weight", "module.module.block2.nblockLayer.1.batch_norm1.bias", "module.module.block2.nblockLayer.1.batch_norm1.running_mean", "module.module.block2.nblockLayer.1.batch_norm1.running_var", "module.module.block2.nblockLayer.1.batch_norm2.weight", "module.module.block2.nblockLayer.1.batch_norm2.bias", "module.module.block2.nblockLayer.1.batch_norm2.running_mean", "module.module.block2.nblockLayer.1.batch_norm2.running_var", "module.module.block2.nblockLayer.1.conv1.weight", "module.module.block2.nblockLayer.1.conv2.weight", "module.module.block2.nblockLayer.2.batch_norm1.weight", "module.module.block2.nblockLayer.2.batch_norm1.bias", "module.module.block2.nblockLayer.2.batch_norm1.running_mean", "module.module.block2.nblockLayer.2.batch_norm1.running_var", "module.module.block2.nblockLayer.2.batch_norm2.weight", "module.module.block2.nblockLayer.2.batch_norm2.bias", "module.module.block2.nblockLayer.2.batch_norm2.running_mean", "module.module.block2.nblockLayer.2.batch_norm2.running_var", "module.module.block2.nblockLayer.2.conv1.weight", "module.module.block2.nblockLayer.2.conv2.weight", "module.module.block2.nblockLayer.3.batch_norm1.weight", "module.module.block2.nblockLayer.3.batch_norm1.bias", "module.module.block2.nblockLayer.3.batch_norm1.running_mean", "module.module.block2.nblockLayer.3.batch_norm1.running_var", "module.module.block2.nblockLayer.3.batch_norm2.weight", "module.module.block2.nblockLayer.3.batch_norm2.bias", "module.module.block2.nblockLayer.3.batch_norm2.running_mean", "module.module.block2.nblockLayer.3.batch_norm2.running_var", "module.module.block2.nblockLayer.3.conv1.weight", "module.module.block2.nblockLayer.3.conv2.weight", "module.module.block2.nblockLayer.4.batch_norm1.weight", "module.module.block2.nblockLayer.4.batch_norm1.bias", "module.module.block2.nblockLayer.4.batch_norm1.running_mean", "module.module.block2.nblockLayer.4.batch_norm1.running_var", "module.module.block2.nblockLayer.4.batch_norm2.weight", "module.module.block2.nblockLayer.4.batch_norm2.bias", "module.module.block2.nblockLayer.4.batch_norm2.running_mean", "module.module.block2.nblockLayer.4.batch_norm2.running_var", "module.module.block2.nblockLayer.4.conv1.weight", "module.module.block2.nblockLayer.4.conv2.weight", "module.module.block3.nblockLayer.0.batch_norm1.weight", "module.module.block3.nblockLayer.0.batch_norm1.bias", "module.module.block3.nblockLayer.0.batch_norm1.running_mean", "module.module.block3.nblockLayer.0.batch_norm1.running_var", "module.module.block3.nblockLayer.0.batch_norm2.weight", "module.module.block3.nblockLayer.0.batch_norm2.bias", "module.module.block3.nblockLayer.0.batch_norm2.running_mean", "module.module.block3.nblockLayer.0.batch_norm2.running_var", "module.module.block3.nblockLayer.0.conv1.weight", "module.module.block3.nblockLayer.0.conv2.weight", "module.module.block3.nblockLayer.0.conv_inp.weight", "module.module.block3.nblockLayer.1.batch_norm1.weight", "module.module.block3.nblockLayer.1.batch_norm1.bias", "module.module.block3.nblockLayer.1.batch_norm1.running_mean", "module.module.block3.nblockLayer.1.batch_norm1.running_var", "module.module.block3.nblockLayer.1.batch_norm2.weight", "module.module.block3.nblockLayer.1.batch_norm2.bias", "module.module.block3.nblockLayer.1.batch_norm2.running_mean", "module.module.block3.nblockLayer.1.batch_norm2.running_var", "module.module.block3.nblockLayer.1.conv1.weight", "module.module.block3.nblockLayer.1.conv2.weight", "module.module.block3.nblockLayer.2.batch_norm1.weight", "module.module.block3.nblockLayer.2.batch_norm1.bias", "module.module.block3.nblockLayer.2.batch_norm1.running_mean", "module.module.block3.nblockLayer.2.batch_norm1.running_var", "module.module.block3.nblockLayer.2.batch_norm2.weight", "module.module.block3.nblockLayer.2.batch_norm2.bias", "module.module.block3.nblockLayer.2.batch_norm2.running_mean", "module.module.block3.nblockLayer.2.batch_norm2.running_var", "module.module.block3.nblockLayer.2.conv1.weight", "module.module.block3.nblockLayer.2.conv2.weight", "module.module.block3.nblockLayer.3.batch_norm1.weight", "module.module.block3.nblockLayer.3.batch_norm1.bias", "module.module.block3.nblockLayer.3.batch_norm1.running_mean", "module.module.block3.nblockLayer.3.batch_norm1.running_var", "module.module.block3.nblockLayer.3.batch_norm2.weight", "module.module.block3.nblockLayer.3.batch_norm2.bias", "module.module.block3.nblockLayer.3.batch_norm2.running_mean", "module.module.block3.nblockLayer.3.batch_norm2.running_var", "module.module.block3.nblockLayer.3.conv1.weight", "module.module.block3.nblockLayer.3.conv2.weight", "module.module.block3.nblockLayer.4.batch_norm1.weight", "module.module.block3.nblockLayer.4.batch_norm1.bias", "module.module.block3.nblockLayer.4.batch_norm1.running_mean", "module.module.block3.nblockLayer.4.batch_norm1.running_var", "module.module.block3.nblockLayer.4.batch_norm2.weight", "module.module.block3.nblockLayer.4.batch_norm2.bias", "module.module.block3.nblockLayer.4.batch_norm2.running_mean", "module.module.block3.nblockLayer.4.batch_norm2.running_var", "module.module.block3.nblockLayer.4.conv1.weight", "module.module.block3.nblockLayer.4.conv2.weight", "module.module.batch_norm.weight", "module.module.batch_norm.bias", "module.module.batch_norm.running_mean", "module.module.batch_norm.running_var", "module.module.fc.weight", "module.module.fc.bias". 
	Unexpected key(s) in state_dict: "module.conv1.weight", "module.block1.nblockLayer.0.batch_norm1.weight", "module.block1.nblockLayer.0.batch_norm1.bias", "module.block1.nblockLayer.0.batch_norm1.running_mean", "module.block1.nblockLayer.0.batch_norm1.running_var", "module.block1.nblockLayer.0.batch_norm1.num_batches_tracked", "module.block1.nblockLayer.0.batch_norm2.weight", "module.block1.nblockLayer.0.batch_norm2.bias", "module.block1.nblockLayer.0.batch_norm2.running_mean", "module.block1.nblockLayer.0.batch_norm2.running_var", "module.block1.nblockLayer.0.batch_norm2.num_batches_tracked", "module.block1.nblockLayer.0.conv1.weight", "module.block1.nblockLayer.0.conv2.weight", "module.block1.nblockLayer.0.conv_inp.weight", "module.block1.nblockLayer.1.batch_norm1.weight", "module.block1.nblockLayer.1.batch_norm1.bias", "module.block1.nblockLayer.1.batch_norm1.running_mean", "module.block1.nblockLayer.1.batch_norm1.running_var", "module.block1.nblockLayer.1.batch_norm1.num_batches_tracked", "module.block1.nblockLayer.1.batch_norm2.weight", "module.block1.nblockLayer.1.batch_norm2.bias", "module.block1.nblockLayer.1.batch_norm2.running_mean", "module.block1.nblockLayer.1.batch_norm2.running_var", "module.block1.nblockLayer.1.batch_norm2.num_batches_tracked", "module.block1.nblockLayer.1.conv1.weight", "module.block1.nblockLayer.1.conv2.weight", "module.block1.nblockLayer.2.batch_norm1.weight", "module.block1.nblockLayer.2.batch_norm1.bias", "module.block1.nblockLayer.2.batch_norm1.running_mean", "module.block1.nblockLayer.2.batch_norm1.running_var", "module.block1.nblockLayer.2.batch_norm1.num_batches_tracked", "module.block1.nblockLayer.2.batch_norm2.weight", "module.block1.nblockLayer.2.batch_norm2.bias", "module.block1.nblockLayer.2.batch_norm2.running_mean", "module.block1.nblockLayer.2.batch_norm2.running_var", "module.block1.nblockLayer.2.batch_norm2.num_batches_tracked", "module.block1.nblockLayer.2.conv1.weight", "module.block1.nblockLayer.2.conv2.weight", "module.block1.nblockLayer.3.batch_norm1.weight", "module.block1.nblockLayer.3.batch_norm1.bias", "module.block1.nblockLayer.3.batch_norm1.running_mean", "module.block1.nblockLayer.3.batch_norm1.running_var", "module.block1.nblockLayer.3.batch_norm1.num_batches_tracked", "module.block1.nblockLayer.3.batch_norm2.weight", "module.block1.nblockLayer.3.batch_norm2.bias", "module.block1.nblockLayer.3.batch_norm2.running_mean", "module.block1.nblockLayer.3.batch_norm2.running_var", "module.block1.nblockLayer.3.batch_norm2.num_batches_tracked", "module.block1.nblockLayer.3.conv1.weight", "module.block1.nblockLayer.3.conv2.weight", "module.block2.nblockLayer.0.batch_norm1.weight", "module.block2.nblockLayer.0.batch_norm1.bias", "module.block2.nblockLayer.0.batch_norm1.running_mean", "module.block2.nblockLayer.0.batch_norm1.running_var", "module.block2.nblockLayer.0.batch_norm1.num_batches_tracked", "module.block2.nblockLayer.0.batch_norm2.weight", "module.block2.nblockLayer.0.batch_norm2.bias", "module.block2.nblockLayer.0.batch_norm2.running_mean", "module.block2.nblockLayer.0.batch_norm2.running_var", "module.block2.nblockLayer.0.batch_norm2.num_batches_tracked", "module.block2.nblockLayer.0.conv1.weight", "module.block2.nblockLayer.0.conv2.weight", "module.block2.nblockLayer.0.conv_inp.weight", "module.block2.nblockLayer.1.batch_norm1.weight", "module.block2.nblockLayer.1.batch_norm1.bias", "module.block2.nblockLayer.1.batch_norm1.running_mean", "module.block2.nblockLayer.1.batch_norm1.running_var", "module.block2.nblockLayer.1.batch_norm1.num_batches_tracked", "module.block2.nblockLayer.1.batch_norm2.weight", "module.block2.nblockLayer.1.batch_norm2.bias", "module.block2.nblockLayer.1.batch_norm2.running_mean", "module.block2.nblockLayer.1.batch_norm2.running_var", "module.block2.nblockLayer.1.batch_norm2.num_batches_tracked", "module.block2.nblockLayer.1.conv1.weight", "module.block2.nblockLayer.1.conv2.weight", "module.block2.nblockLayer.2.batch_norm1.weight", "module.block2.nblockLayer.2.batch_norm1.bias", "module.block2.nblockLayer.2.batch_norm1.running_mean", "module.block2.nblockLayer.2.batch_norm1.running_var", "module.block2.nblockLayer.2.batch_norm1.num_batches_tracked", "module.block2.nblockLayer.2.batch_norm2.weight", "module.block2.nblockLayer.2.batch_norm2.bias", "module.block2.nblockLayer.2.batch_norm2.running_mean", "module.block2.nblockLayer.2.batch_norm2.running_var", "module.block2.nblockLayer.2.batch_norm2.num_batches_tracked", "module.block2.nblockLayer.2.conv1.weight", "module.block2.nblockLayer.2.conv2.weight", "module.block2.nblockLayer.3.batch_norm1.weight", "module.block2.nblockLayer.3.batch_norm1.bias", "module.block2.nblockLayer.3.batch_norm1.running_mean", "module.block2.nblockLayer.3.batch_norm1.running_var", "module.block2.nblockLayer.3.batch_norm1.num_batches_tracked", "module.block2.nblockLayer.3.batch_norm2.weight", "module.block2.nblockLayer.3.batch_norm2.bias", "module.block2.nblockLayer.3.batch_norm2.running_mean", "module.block2.nblockLayer.3.batch_norm2.running_var", "module.block2.nblockLayer.3.batch_norm2.num_batches_tracked", "module.block2.nblockLayer.3.conv1.weight", "module.block2.nblockLayer.3.conv2.weight", "module.block3.nblockLayer.0.batch_norm1.weight", "module.block3.nblockLayer.0.batch_norm1.bias", "module.block3.nblockLayer.0.batch_norm1.running_mean", "module.block3.nblockLayer.0.batch_norm1.running_var", "module.block3.nblockLayer.0.batch_norm1.num_batches_tracked", "module.block3.nblockLayer.0.batch_norm2.weight", "module.block3.nblockLayer.0.batch_norm2.bias", "module.block3.nblockLayer.0.batch_norm2.running_mean", "module.block3.nblockLayer.0.batch_norm2.running_var", "module.block3.nblockLayer.0.batch_norm2.num_batches_tracked", "module.block3.nblockLayer.0.conv1.weight", "module.block3.nblockLayer.0.conv2.weight", "module.block3.nblockLayer.0.conv_inp.weight", "module.block3.nblockLayer.1.batch_norm1.weight", "module.block3.nblockLayer.1.batch_norm1.bias", "module.block3.nblockLayer.1.batch_norm1.running_mean", "module.block3.nblockLayer.1.batch_norm1.running_var", "module.block3.nblockLayer.1.batch_norm1.num_batches_tracked", "module.block3.nblockLayer.1.batch_norm2.weight", "module.block3.nblockLayer.1.batch_norm2.bias", "module.block3.nblockLayer.1.batch_norm2.running_mean", "module.block3.nblockLayer.1.batch_norm2.running_var", "module.block3.nblockLayer.1.batch_norm2.num_batches_tracked", "module.block3.nblockLayer.1.conv1.weight", "module.block3.nblockLayer.1.conv2.weight", "module.block3.nblockLayer.2.batch_norm1.weight", "module.block3.nblockLayer.2.batch_norm1.bias", "module.block3.nblockLayer.2.batch_norm1.running_mean", "module.block3.nblockLayer.2.batch_norm1.running_var", "module.block3.nblockLayer.2.batch_norm1.num_batches_tracked", "module.block3.nblockLayer.2.batch_norm2.weight", "module.block3.nblockLayer.2.batch_norm2.bias", "module.block3.nblockLayer.2.batch_norm2.running_mean", "module.block3.nblockLayer.2.batch_norm2.running_var", "module.block3.nblockLayer.2.batch_norm2.num_batches_tracked", "module.block3.nblockLayer.2.conv1.weight", "module.block3.nblockLayer.2.conv2.weight", "module.block3.nblockLayer.3.batch_norm1.weight", "module.block3.nblockLayer.3.batch_norm1.bias", "module.block3.nblockLayer.3.batch_norm1.running_mean", "module.block3.nblockLayer.3.batch_norm1.running_var", "module.block3.nblockLayer.3.batch_norm1.num_batches_tracked", "module.block3.nblockLayer.3.batch_norm2.weight", "module.block3.nblockLayer.3.batch_norm2.bias", "module.block3.nblockLayer.3.batch_norm2.running_mean", "module.block3.nblockLayer.3.batch_norm2.running_var", "module.block3.nblockLayer.3.batch_norm2.num_batches_tracked", "module.block3.nblockLayer.3.conv1.weight", "module.block3.nblockLayer.3.conv2.weight", "module.batch_norm.weight", "module.batch_norm.bias", "module.batch_norm.running_mean", "module.batch_norm.running_var", "module.batch_norm.num_batches_tracked", "module.fc.weight", "module.fc.bias". 
# Batch size 1000, Train accuracy 98
Namespace(alpha_l_1=1.0, alpha_l_2=0.01, alpha_l_inf=0.001, batch_size=500, combine_ratio=0.5, concat=0, concat_factor=1.0, config_file=None, data_path=None, dataset='CIFAR10', device='cuda:0', distance=None, dropRate=0.0, epochs=50, epsilon_l_1=12, epsilon_l_2=0.5, epsilon_l_inf=0.03137254901960784, experiment='3-var', feature_type='mingd', gap=0.001, gpu_id=0, imagenet_architecture='wrn', k=100, lr_max=0.1, lr_min=0.0, lr_mode=1, mode='teacher', model_dataset='CIFAR10', model_id='teacher_normalized', model_type='wrn-28-10', noise_sigma=0.05, normalize=1, num_iter=500, opt_type='SGD', path=None, pseudo_labels=0, randomize=0, regressor_embed=0, restarts=1, resume=0, resume_iter=-1, reverse_train_test=0, seed=0, smallest_adv=1, target_batch_size=1000, target_epoch=0, target_te_acc=0, target_tr_acc=98)
Model Directory: ./models/CIFAR10/model_teacher_normalized_1000
File Directory: ./files/CIFAR10_1000/model_teacher_normalized_tr_acc_98
cuda:0
22-10-07 18:00
No Transform
Files already downloaded and verified
Files already downloaded and verified
No Transform
Files already downloaded and verified
Files already downloaded and verified
Loading model from ./models/CIFAR10/model_teacher_normalized_1000/tr_acc_98.pt
Traceback (most recent call last):
  File "./src/generate_features.py", line 197, in feature_extractor
    student.load_state_dict(torch.load(location, map_location = args.device)) 
  File "/home/user/tingweijing/env/DIenv/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1223, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.block1.nblockLayer.4.batch_norm1.weight", "module.block1.nblockLayer.4.batch_norm1.bias", "module.block1.nblockLayer.4.batch_norm1.running_mean", "module.block1.nblockLayer.4.batch_norm1.running_var", "module.block1.nblockLayer.4.batch_norm2.weight", "module.block1.nblockLayer.4.batch_norm2.bias", "module.block1.nblockLayer.4.batch_norm2.running_mean", "module.block1.nblockLayer.4.batch_norm2.running_var", "module.block1.nblockLayer.4.conv1.weight", "module.block1.nblockLayer.4.conv2.weight", "module.block2.nblockLayer.4.batch_norm1.weight", "module.block2.nblockLayer.4.batch_norm1.bias", "module.block2.nblockLayer.4.batch_norm1.running_mean", "module.block2.nblockLayer.4.batch_norm1.running_var", "module.block2.nblockLayer.4.batch_norm2.weight", "module.block2.nblockLayer.4.batch_norm2.bias", "module.block2.nblockLayer.4.batch_norm2.running_mean", "module.block2.nblockLayer.4.batch_norm2.running_var", "module.block2.nblockLayer.4.conv1.weight", "module.block2.nblockLayer.4.conv2.weight", "module.block3.nblockLayer.4.batch_norm1.weight", "module.block3.nblockLayer.4.batch_norm1.bias", "module.block3.nblockLayer.4.batch_norm1.running_mean", "module.block3.nblockLayer.4.batch_norm1.running_var", "module.block3.nblockLayer.4.batch_norm2.weight", "module.block3.nblockLayer.4.batch_norm2.bias", "module.block3.nblockLayer.4.batch_norm2.running_mean", "module.block3.nblockLayer.4.batch_norm2.running_var", "module.block3.nblockLayer.4.conv1.weight", "module.block3.nblockLayer.4.conv2.weight". 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "./src/generate_features.py", line 405, in <module>
    feature_extractor(args)
  File "./src/generate_features.py", line 200, in feature_extractor
    student.load_state_dict(torch.load(location, map_location = args.device))   
  File "/home/user/tingweijing/env/DIenv/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1223, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.module.conv1.weight", "module.module.block1.nblockLayer.0.batch_norm1.weight", "module.module.block1.nblockLayer.0.batch_norm1.bias", "module.module.block1.nblockLayer.0.batch_norm1.running_mean", "module.module.block1.nblockLayer.0.batch_norm1.running_var", "module.module.block1.nblockLayer.0.batch_norm2.weight", "module.module.block1.nblockLayer.0.batch_norm2.bias", "module.module.block1.nblockLayer.0.batch_norm2.running_mean", "module.module.block1.nblockLayer.0.batch_norm2.running_var", "module.module.block1.nblockLayer.0.conv1.weight", "module.module.block1.nblockLayer.0.conv2.weight", "module.module.block1.nblockLayer.0.conv_inp.weight", "module.module.block1.nblockLayer.1.batch_norm1.weight", "module.module.block1.nblockLayer.1.batch_norm1.bias", "module.module.block1.nblockLayer.1.batch_norm1.running_mean", "module.module.block1.nblockLayer.1.batch_norm1.running_var", "module.module.block1.nblockLayer.1.batch_norm2.weight", "module.module.block1.nblockLayer.1.batch_norm2.bias", "module.module.block1.nblockLayer.1.batch_norm2.running_mean", "module.module.block1.nblockLayer.1.batch_norm2.running_var", "module.module.block1.nblockLayer.1.conv1.weight", "module.module.block1.nblockLayer.1.conv2.weight", "module.module.block1.nblockLayer.2.batch_norm1.weight", "module.module.block1.nblockLayer.2.batch_norm1.bias", "module.module.block1.nblockLayer.2.batch_norm1.running_mean", "module.module.block1.nblockLayer.2.batch_norm1.running_var", "module.module.block1.nblockLayer.2.batch_norm2.weight", "module.module.block1.nblockLayer.2.batch_norm2.bias", "module.module.block1.nblockLayer.2.batch_norm2.running_mean", "module.module.block1.nblockLayer.2.batch_norm2.running_var", "module.module.block1.nblockLayer.2.conv1.weight", "module.module.block1.nblockLayer.2.conv2.weight", "module.module.block1.nblockLayer.3.batch_norm1.weight", "module.module.block1.nblockLayer.3.batch_norm1.bias", "module.module.block1.nblockLayer.3.batch_norm1.running_mean", "module.module.block1.nblockLayer.3.batch_norm1.running_var", "module.module.block1.nblockLayer.3.batch_norm2.weight", "module.module.block1.nblockLayer.3.batch_norm2.bias", "module.module.block1.nblockLayer.3.batch_norm2.running_mean", "module.module.block1.nblockLayer.3.batch_norm2.running_var", "module.module.block1.nblockLayer.3.conv1.weight", "module.module.block1.nblockLayer.3.conv2.weight", "module.module.block1.nblockLayer.4.batch_norm1.weight", "module.module.block1.nblockLayer.4.batch_norm1.bias", "module.module.block1.nblockLayer.4.batch_norm1.running_mean", "module.module.block1.nblockLayer.4.batch_norm1.running_var", "module.module.block1.nblockLayer.4.batch_norm2.weight", "module.module.block1.nblockLayer.4.batch_norm2.bias", "module.module.block1.nblockLayer.4.batch_norm2.running_mean", "module.module.block1.nblockLayer.4.batch_norm2.running_var", "module.module.block1.nblockLayer.4.conv1.weight", "module.module.block1.nblockLayer.4.conv2.weight", "module.module.block2.nblockLayer.0.batch_norm1.weight", "module.module.block2.nblockLayer.0.batch_norm1.bias", "module.module.block2.nblockLayer.0.batch_norm1.running_mean", "module.module.block2.nblockLayer.0.batch_norm1.running_var", "module.module.block2.nblockLayer.0.batch_norm2.weight", "module.module.block2.nblockLayer.0.batch_norm2.bias", "module.module.block2.nblockLayer.0.batch_norm2.running_mean", "module.module.block2.nblockLayer.0.batch_norm2.running_var", "module.module.block2.nblockLayer.0.conv1.weight", "module.module.block2.nblockLayer.0.conv2.weight", "module.module.block2.nblockLayer.0.conv_inp.weight", "module.module.block2.nblockLayer.1.batch_norm1.weight", "module.module.block2.nblockLayer.1.batch_norm1.bias", "module.module.block2.nblockLayer.1.batch_norm1.running_mean", "module.module.block2.nblockLayer.1.batch_norm1.running_var", "module.module.block2.nblockLayer.1.batch_norm2.weight", "module.module.block2.nblockLayer.1.batch_norm2.bias", "module.module.block2.nblockLayer.1.batch_norm2.running_mean", "module.module.block2.nblockLayer.1.batch_norm2.running_var", "module.module.block2.nblockLayer.1.conv1.weight", "module.module.block2.nblockLayer.1.conv2.weight", "module.module.block2.nblockLayer.2.batch_norm1.weight", "module.module.block2.nblockLayer.2.batch_norm1.bias", "module.module.block2.nblockLayer.2.batch_norm1.running_mean", "module.module.block2.nblockLayer.2.batch_norm1.running_var", "module.module.block2.nblockLayer.2.batch_norm2.weight", "module.module.block2.nblockLayer.2.batch_norm2.bias", "module.module.block2.nblockLayer.2.batch_norm2.running_mean", "module.module.block2.nblockLayer.2.batch_norm2.running_var", "module.module.block2.nblockLayer.2.conv1.weight", "module.module.block2.nblockLayer.2.conv2.weight", "module.module.block2.nblockLayer.3.batch_norm1.weight", "module.module.block2.nblockLayer.3.batch_norm1.bias", "module.module.block2.nblockLayer.3.batch_norm1.running_mean", "module.module.block2.nblockLayer.3.batch_norm1.running_var", "module.module.block2.nblockLayer.3.batch_norm2.weight", "module.module.block2.nblockLayer.3.batch_norm2.bias", "module.module.block2.nblockLayer.3.batch_norm2.running_mean", "module.module.block2.nblockLayer.3.batch_norm2.running_var", "module.module.block2.nblockLayer.3.conv1.weight", "module.module.block2.nblockLayer.3.conv2.weight", "module.module.block2.nblockLayer.4.batch_norm1.weight", "module.module.block2.nblockLayer.4.batch_norm1.bias", "module.module.block2.nblockLayer.4.batch_norm1.running_mean", "module.module.block2.nblockLayer.4.batch_norm1.running_var", "module.module.block2.nblockLayer.4.batch_norm2.weight", "module.module.block2.nblockLayer.4.batch_norm2.bias", "module.module.block2.nblockLayer.4.batch_norm2.running_mean", "module.module.block2.nblockLayer.4.batch_norm2.running_var", "module.module.block2.nblockLayer.4.conv1.weight", "module.module.block2.nblockLayer.4.conv2.weight", "module.module.block3.nblockLayer.0.batch_norm1.weight", "module.module.block3.nblockLayer.0.batch_norm1.bias", "module.module.block3.nblockLayer.0.batch_norm1.running_mean", "module.module.block3.nblockLayer.0.batch_norm1.running_var", "module.module.block3.nblockLayer.0.batch_norm2.weight", "module.module.block3.nblockLayer.0.batch_norm2.bias", "module.module.block3.nblockLayer.0.batch_norm2.running_mean", "module.module.block3.nblockLayer.0.batch_norm2.running_var", "module.module.block3.nblockLayer.0.conv1.weight", "module.module.block3.nblockLayer.0.conv2.weight", "module.module.block3.nblockLayer.0.conv_inp.weight", "module.module.block3.nblockLayer.1.batch_norm1.weight", "module.module.block3.nblockLayer.1.batch_norm1.bias", "module.module.block3.nblockLayer.1.batch_norm1.running_mean", "module.module.block3.nblockLayer.1.batch_norm1.running_var", "module.module.block3.nblockLayer.1.batch_norm2.weight", "module.module.block3.nblockLayer.1.batch_norm2.bias", "module.module.block3.nblockLayer.1.batch_norm2.running_mean", "module.module.block3.nblockLayer.1.batch_norm2.running_var", "module.module.block3.nblockLayer.1.conv1.weight", "module.module.block3.nblockLayer.1.conv2.weight", "module.module.block3.nblockLayer.2.batch_norm1.weight", "module.module.block3.nblockLayer.2.batch_norm1.bias", "module.module.block3.nblockLayer.2.batch_norm1.running_mean", "module.module.block3.nblockLayer.2.batch_norm1.running_var", "module.module.block3.nblockLayer.2.batch_norm2.weight", "module.module.block3.nblockLayer.2.batch_norm2.bias", "module.module.block3.nblockLayer.2.batch_norm2.running_mean", "module.module.block3.nblockLayer.2.batch_norm2.running_var", "module.module.block3.nblockLayer.2.conv1.weight", "module.module.block3.nblockLayer.2.conv2.weight", "module.module.block3.nblockLayer.3.batch_norm1.weight", "module.module.block3.nblockLayer.3.batch_norm1.bias", "module.module.block3.nblockLayer.3.batch_norm1.running_mean", "module.module.block3.nblockLayer.3.batch_norm1.running_var", "module.module.block3.nblockLayer.3.batch_norm2.weight", "module.module.block3.nblockLayer.3.batch_norm2.bias", "module.module.block3.nblockLayer.3.batch_norm2.running_mean", "module.module.block3.nblockLayer.3.batch_norm2.running_var", "module.module.block3.nblockLayer.3.conv1.weight", "module.module.block3.nblockLayer.3.conv2.weight", "module.module.block3.nblockLayer.4.batch_norm1.weight", "module.module.block3.nblockLayer.4.batch_norm1.bias", "module.module.block3.nblockLayer.4.batch_norm1.running_mean", "module.module.block3.nblockLayer.4.batch_norm1.running_var", "module.module.block3.nblockLayer.4.batch_norm2.weight", "module.module.block3.nblockLayer.4.batch_norm2.bias", "module.module.block3.nblockLayer.4.batch_norm2.running_mean", "module.module.block3.nblockLayer.4.batch_norm2.running_var", "module.module.block3.nblockLayer.4.conv1.weight", "module.module.block3.nblockLayer.4.conv2.weight", "module.module.batch_norm.weight", "module.module.batch_norm.bias", "module.module.batch_norm.running_mean", "module.module.batch_norm.running_var", "module.module.fc.weight", "module.module.fc.bias". 
	Unexpected key(s) in state_dict: "module.conv1.weight", "module.block1.nblockLayer.0.batch_norm1.weight", "module.block1.nblockLayer.0.batch_norm1.bias", "module.block1.nblockLayer.0.batch_norm1.running_mean", "module.block1.nblockLayer.0.batch_norm1.running_var", "module.block1.nblockLayer.0.batch_norm1.num_batches_tracked", "module.block1.nblockLayer.0.batch_norm2.weight", "module.block1.nblockLayer.0.batch_norm2.bias", "module.block1.nblockLayer.0.batch_norm2.running_mean", "module.block1.nblockLayer.0.batch_norm2.running_var", "module.block1.nblockLayer.0.batch_norm2.num_batches_tracked", "module.block1.nblockLayer.0.conv1.weight", "module.block1.nblockLayer.0.conv2.weight", "module.block1.nblockLayer.0.conv_inp.weight", "module.block1.nblockLayer.1.batch_norm1.weight", "module.block1.nblockLayer.1.batch_norm1.bias", "module.block1.nblockLayer.1.batch_norm1.running_mean", "module.block1.nblockLayer.1.batch_norm1.running_var", "module.block1.nblockLayer.1.batch_norm1.num_batches_tracked", "module.block1.nblockLayer.1.batch_norm2.weight", "module.block1.nblockLayer.1.batch_norm2.bias", "module.block1.nblockLayer.1.batch_norm2.running_mean", "module.block1.nblockLayer.1.batch_norm2.running_var", "module.block1.nblockLayer.1.batch_norm2.num_batches_tracked", "module.block1.nblockLayer.1.conv1.weight", "module.block1.nblockLayer.1.conv2.weight", "module.block1.nblockLayer.2.batch_norm1.weight", "module.block1.nblockLayer.2.batch_norm1.bias", "module.block1.nblockLayer.2.batch_norm1.running_mean", "module.block1.nblockLayer.2.batch_norm1.running_var", "module.block1.nblockLayer.2.batch_norm1.num_batches_tracked", "module.block1.nblockLayer.2.batch_norm2.weight", "module.block1.nblockLayer.2.batch_norm2.bias", "module.block1.nblockLayer.2.batch_norm2.running_mean", "module.block1.nblockLayer.2.batch_norm2.running_var", "module.block1.nblockLayer.2.batch_norm2.num_batches_tracked", "module.block1.nblockLayer.2.conv1.weight", "module.block1.nblockLayer.2.conv2.weight", "module.block1.nblockLayer.3.batch_norm1.weight", "module.block1.nblockLayer.3.batch_norm1.bias", "module.block1.nblockLayer.3.batch_norm1.running_mean", "module.block1.nblockLayer.3.batch_norm1.running_var", "module.block1.nblockLayer.3.batch_norm1.num_batches_tracked", "module.block1.nblockLayer.3.batch_norm2.weight", "module.block1.nblockLayer.3.batch_norm2.bias", "module.block1.nblockLayer.3.batch_norm2.running_mean", "module.block1.nblockLayer.3.batch_norm2.running_var", "module.block1.nblockLayer.3.batch_norm2.num_batches_tracked", "module.block1.nblockLayer.3.conv1.weight", "module.block1.nblockLayer.3.conv2.weight", "module.block2.nblockLayer.0.batch_norm1.weight", "module.block2.nblockLayer.0.batch_norm1.bias", "module.block2.nblockLayer.0.batch_norm1.running_mean", "module.block2.nblockLayer.0.batch_norm1.running_var", "module.block2.nblockLayer.0.batch_norm1.num_batches_tracked", "module.block2.nblockLayer.0.batch_norm2.weight", "module.block2.nblockLayer.0.batch_norm2.bias", "module.block2.nblockLayer.0.batch_norm2.running_mean", "module.block2.nblockLayer.0.batch_norm2.running_var", "module.block2.nblockLayer.0.batch_norm2.num_batches_tracked", "module.block2.nblockLayer.0.conv1.weight", "module.block2.nblockLayer.0.conv2.weight", "module.block2.nblockLayer.0.conv_inp.weight", "module.block2.nblockLayer.1.batch_norm1.weight", "module.block2.nblockLayer.1.batch_norm1.bias", "module.block2.nblockLayer.1.batch_norm1.running_mean", "module.block2.nblockLayer.1.batch_norm1.running_var", "module.block2.nblockLayer.1.batch_norm1.num_batches_tracked", "module.block2.nblockLayer.1.batch_norm2.weight", "module.block2.nblockLayer.1.batch_norm2.bias", "module.block2.nblockLayer.1.batch_norm2.running_mean", "module.block2.nblockLayer.1.batch_norm2.running_var", "module.block2.nblockLayer.1.batch_norm2.num_batches_tracked", "module.block2.nblockLayer.1.conv1.weight", "module.block2.nblockLayer.1.conv2.weight", "module.block2.nblockLayer.2.batch_norm1.weight", "module.block2.nblockLayer.2.batch_norm1.bias", "module.block2.nblockLayer.2.batch_norm1.running_mean", "module.block2.nblockLayer.2.batch_norm1.running_var", "module.block2.nblockLayer.2.batch_norm1.num_batches_tracked", "module.block2.nblockLayer.2.batch_norm2.weight", "module.block2.nblockLayer.2.batch_norm2.bias", "module.block2.nblockLayer.2.batch_norm2.running_mean", "module.block2.nblockLayer.2.batch_norm2.running_var", "module.block2.nblockLayer.2.batch_norm2.num_batches_tracked", "module.block2.nblockLayer.2.conv1.weight", "module.block2.nblockLayer.2.conv2.weight", "module.block2.nblockLayer.3.batch_norm1.weight", "module.block2.nblockLayer.3.batch_norm1.bias", "module.block2.nblockLayer.3.batch_norm1.running_mean", "module.block2.nblockLayer.3.batch_norm1.running_var", "module.block2.nblockLayer.3.batch_norm1.num_batches_tracked", "module.block2.nblockLayer.3.batch_norm2.weight", "module.block2.nblockLayer.3.batch_norm2.bias", "module.block2.nblockLayer.3.batch_norm2.running_mean", "module.block2.nblockLayer.3.batch_norm2.running_var", "module.block2.nblockLayer.3.batch_norm2.num_batches_tracked", "module.block2.nblockLayer.3.conv1.weight", "module.block2.nblockLayer.3.conv2.weight", "module.block3.nblockLayer.0.batch_norm1.weight", "module.block3.nblockLayer.0.batch_norm1.bias", "module.block3.nblockLayer.0.batch_norm1.running_mean", "module.block3.nblockLayer.0.batch_norm1.running_var", "module.block3.nblockLayer.0.batch_norm1.num_batches_tracked", "module.block3.nblockLayer.0.batch_norm2.weight", "module.block3.nblockLayer.0.batch_norm2.bias", "module.block3.nblockLayer.0.batch_norm2.running_mean", "module.block3.nblockLayer.0.batch_norm2.running_var", "module.block3.nblockLayer.0.batch_norm2.num_batches_tracked", "module.block3.nblockLayer.0.conv1.weight", "module.block3.nblockLayer.0.conv2.weight", "module.block3.nblockLayer.0.conv_inp.weight", "module.block3.nblockLayer.1.batch_norm1.weight", "module.block3.nblockLayer.1.batch_norm1.bias", "module.block3.nblockLayer.1.batch_norm1.running_mean", "module.block3.nblockLayer.1.batch_norm1.running_var", "module.block3.nblockLayer.1.batch_norm1.num_batches_tracked", "module.block3.nblockLayer.1.batch_norm2.weight", "module.block3.nblockLayer.1.batch_norm2.bias", "module.block3.nblockLayer.1.batch_norm2.running_mean", "module.block3.nblockLayer.1.batch_norm2.running_var", "module.block3.nblockLayer.1.batch_norm2.num_batches_tracked", "module.block3.nblockLayer.1.conv1.weight", "module.block3.nblockLayer.1.conv2.weight", "module.block3.nblockLayer.2.batch_norm1.weight", "module.block3.nblockLayer.2.batch_norm1.bias", "module.block3.nblockLayer.2.batch_norm1.running_mean", "module.block3.nblockLayer.2.batch_norm1.running_var", "module.block3.nblockLayer.2.batch_norm1.num_batches_tracked", "module.block3.nblockLayer.2.batch_norm2.weight", "module.block3.nblockLayer.2.batch_norm2.bias", "module.block3.nblockLayer.2.batch_norm2.running_mean", "module.block3.nblockLayer.2.batch_norm2.running_var", "module.block3.nblockLayer.2.batch_norm2.num_batches_tracked", "module.block3.nblockLayer.2.conv1.weight", "module.block3.nblockLayer.2.conv2.weight", "module.block3.nblockLayer.3.batch_norm1.weight", "module.block3.nblockLayer.3.batch_norm1.bias", "module.block3.nblockLayer.3.batch_norm1.running_mean", "module.block3.nblockLayer.3.batch_norm1.running_var", "module.block3.nblockLayer.3.batch_norm1.num_batches_tracked", "module.block3.nblockLayer.3.batch_norm2.weight", "module.block3.nblockLayer.3.batch_norm2.bias", "module.block3.nblockLayer.3.batch_norm2.running_mean", "module.block3.nblockLayer.3.batch_norm2.running_var", "module.block3.nblockLayer.3.batch_norm2.num_batches_tracked", "module.block3.nblockLayer.3.conv1.weight", "module.block3.nblockLayer.3.conv2.weight", "module.batch_norm.weight", "module.batch_norm.bias", "module.batch_norm.running_mean", "module.batch_norm.running_var", "module.batch_norm.num_batches_tracked", "module.fc.weight", "module.fc.bias". 
# Batch size 1000, Train accuracy 99
Namespace(alpha_l_1=1.0, alpha_l_2=0.01, alpha_l_inf=0.001, batch_size=500, combine_ratio=0.5, concat=0, concat_factor=1.0, config_file=None, data_path=None, dataset='CIFAR10', device='cuda:0', distance=None, dropRate=0.0, epochs=50, epsilon_l_1=12, epsilon_l_2=0.5, epsilon_l_inf=0.03137254901960784, experiment='3-var', feature_type='mingd', gap=0.001, gpu_id=0, imagenet_architecture='wrn', k=100, lr_max=0.1, lr_min=0.0, lr_mode=1, mode='teacher', model_dataset='CIFAR10', model_id='teacher_normalized', model_type='wrn-28-10', noise_sigma=0.05, normalize=1, num_iter=500, opt_type='SGD', path=None, pseudo_labels=0, randomize=0, regressor_embed=0, restarts=1, resume=0, resume_iter=-1, reverse_train_test=0, seed=0, smallest_adv=1, target_batch_size=1000, target_epoch=0, target_te_acc=0, target_tr_acc=99)
Model Directory: ./models/CIFAR10/model_teacher_normalized_1000
File Directory: ./files/CIFAR10_1000/model_teacher_normalized_tr_acc_99
cuda:0
22-10-07 18:00
No Transform
Files already downloaded and verified
Files already downloaded and verified
No Transform
Files already downloaded and verified
Files already downloaded and verified
Loading model from ./models/CIFAR10/model_teacher_normalized_1000/tr_acc_99.pt
Traceback (most recent call last):
  File "./src/generate_features.py", line 197, in feature_extractor
    student.load_state_dict(torch.load(location, map_location = args.device)) 
  File "/home/user/tingweijing/env/DIenv/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1223, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.block1.nblockLayer.4.batch_norm1.weight", "module.block1.nblockLayer.4.batch_norm1.bias", "module.block1.nblockLayer.4.batch_norm1.running_mean", "module.block1.nblockLayer.4.batch_norm1.running_var", "module.block1.nblockLayer.4.batch_norm2.weight", "module.block1.nblockLayer.4.batch_norm2.bias", "module.block1.nblockLayer.4.batch_norm2.running_mean", "module.block1.nblockLayer.4.batch_norm2.running_var", "module.block1.nblockLayer.4.conv1.weight", "module.block1.nblockLayer.4.conv2.weight", "module.block2.nblockLayer.4.batch_norm1.weight", "module.block2.nblockLayer.4.batch_norm1.bias", "module.block2.nblockLayer.4.batch_norm1.running_mean", "module.block2.nblockLayer.4.batch_norm1.running_var", "module.block2.nblockLayer.4.batch_norm2.weight", "module.block2.nblockLayer.4.batch_norm2.bias", "module.block2.nblockLayer.4.batch_norm2.running_mean", "module.block2.nblockLayer.4.batch_norm2.running_var", "module.block2.nblockLayer.4.conv1.weight", "module.block2.nblockLayer.4.conv2.weight", "module.block3.nblockLayer.4.batch_norm1.weight", "module.block3.nblockLayer.4.batch_norm1.bias", "module.block3.nblockLayer.4.batch_norm1.running_mean", "module.block3.nblockLayer.4.batch_norm1.running_var", "module.block3.nblockLayer.4.batch_norm2.weight", "module.block3.nblockLayer.4.batch_norm2.bias", "module.block3.nblockLayer.4.batch_norm2.running_mean", "module.block3.nblockLayer.4.batch_norm2.running_var", "module.block3.nblockLayer.4.conv1.weight", "module.block3.nblockLayer.4.conv2.weight". 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "./src/generate_features.py", line 405, in <module>
    feature_extractor(args)
  File "./src/generate_features.py", line 200, in feature_extractor
    student.load_state_dict(torch.load(location, map_location = args.device))   
  File "/home/user/tingweijing/env/DIenv/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1223, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.module.conv1.weight", "module.module.block1.nblockLayer.0.batch_norm1.weight", "module.module.block1.nblockLayer.0.batch_norm1.bias", "module.module.block1.nblockLayer.0.batch_norm1.running_mean", "module.module.block1.nblockLayer.0.batch_norm1.running_var", "module.module.block1.nblockLayer.0.batch_norm2.weight", "module.module.block1.nblockLayer.0.batch_norm2.bias", "module.module.block1.nblockLayer.0.batch_norm2.running_mean", "module.module.block1.nblockLayer.0.batch_norm2.running_var", "module.module.block1.nblockLayer.0.conv1.weight", "module.module.block1.nblockLayer.0.conv2.weight", "module.module.block1.nblockLayer.0.conv_inp.weight", "module.module.block1.nblockLayer.1.batch_norm1.weight", "module.module.block1.nblockLayer.1.batch_norm1.bias", "module.module.block1.nblockLayer.1.batch_norm1.running_mean", "module.module.block1.nblockLayer.1.batch_norm1.running_var", "module.module.block1.nblockLayer.1.batch_norm2.weight", "module.module.block1.nblockLayer.1.batch_norm2.bias", "module.module.block1.nblockLayer.1.batch_norm2.running_mean", "module.module.block1.nblockLayer.1.batch_norm2.running_var", "module.module.block1.nblockLayer.1.conv1.weight", "module.module.block1.nblockLayer.1.conv2.weight", "module.module.block1.nblockLayer.2.batch_norm1.weight", "module.module.block1.nblockLayer.2.batch_norm1.bias", "module.module.block1.nblockLayer.2.batch_norm1.running_mean", "module.module.block1.nblockLayer.2.batch_norm1.running_var", "module.module.block1.nblockLayer.2.batch_norm2.weight", "module.module.block1.nblockLayer.2.batch_norm2.bias", "module.module.block1.nblockLayer.2.batch_norm2.running_mean", "module.module.block1.nblockLayer.2.batch_norm2.running_var", "module.module.block1.nblockLayer.2.conv1.weight", "module.module.block1.nblockLayer.2.conv2.weight", "module.module.block1.nblockLayer.3.batch_norm1.weight", "module.module.block1.nblockLayer.3.batch_norm1.bias", "module.module.block1.nblockLayer.3.batch_norm1.running_mean", "module.module.block1.nblockLayer.3.batch_norm1.running_var", "module.module.block1.nblockLayer.3.batch_norm2.weight", "module.module.block1.nblockLayer.3.batch_norm2.bias", "module.module.block1.nblockLayer.3.batch_norm2.running_mean", "module.module.block1.nblockLayer.3.batch_norm2.running_var", "module.module.block1.nblockLayer.3.conv1.weight", "module.module.block1.nblockLayer.3.conv2.weight", "module.module.block1.nblockLayer.4.batch_norm1.weight", "module.module.block1.nblockLayer.4.batch_norm1.bias", "module.module.block1.nblockLayer.4.batch_norm1.running_mean", "module.module.block1.nblockLayer.4.batch_norm1.running_var", "module.module.block1.nblockLayer.4.batch_norm2.weight", "module.module.block1.nblockLayer.4.batch_norm2.bias", "module.module.block1.nblockLayer.4.batch_norm2.running_mean", "module.module.block1.nblockLayer.4.batch_norm2.running_var", "module.module.block1.nblockLayer.4.conv1.weight", "module.module.block1.nblockLayer.4.conv2.weight", "module.module.block2.nblockLayer.0.batch_norm1.weight", "module.module.block2.nblockLayer.0.batch_norm1.bias", "module.module.block2.nblockLayer.0.batch_norm1.running_mean", "module.module.block2.nblockLayer.0.batch_norm1.running_var", "module.module.block2.nblockLayer.0.batch_norm2.weight", "module.module.block2.nblockLayer.0.batch_norm2.bias", "module.module.block2.nblockLayer.0.batch_norm2.running_mean", "module.module.block2.nblockLayer.0.batch_norm2.running_var", "module.module.block2.nblockLayer.0.conv1.weight", "module.module.block2.nblockLayer.0.conv2.weight", "module.module.block2.nblockLayer.0.conv_inp.weight", "module.module.block2.nblockLayer.1.batch_norm1.weight", "module.module.block2.nblockLayer.1.batch_norm1.bias", "module.module.block2.nblockLayer.1.batch_norm1.running_mean", "module.module.block2.nblockLayer.1.batch_norm1.running_var", "module.module.block2.nblockLayer.1.batch_norm2.weight", "module.module.block2.nblockLayer.1.batch_norm2.bias", "module.module.block2.nblockLayer.1.batch_norm2.running_mean", "module.module.block2.nblockLayer.1.batch_norm2.running_var", "module.module.block2.nblockLayer.1.conv1.weight", "module.module.block2.nblockLayer.1.conv2.weight", "module.module.block2.nblockLayer.2.batch_norm1.weight", "module.module.block2.nblockLayer.2.batch_norm1.bias", "module.module.block2.nblockLayer.2.batch_norm1.running_mean", "module.module.block2.nblockLayer.2.batch_norm1.running_var", "module.module.block2.nblockLayer.2.batch_norm2.weight", "module.module.block2.nblockLayer.2.batch_norm2.bias", "module.module.block2.nblockLayer.2.batch_norm2.running_mean", "module.module.block2.nblockLayer.2.batch_norm2.running_var", "module.module.block2.nblockLayer.2.conv1.weight", "module.module.block2.nblockLayer.2.conv2.weight", "module.module.block2.nblockLayer.3.batch_norm1.weight", "module.module.block2.nblockLayer.3.batch_norm1.bias", "module.module.block2.nblockLayer.3.batch_norm1.running_mean", "module.module.block2.nblockLayer.3.batch_norm1.running_var", "module.module.block2.nblockLayer.3.batch_norm2.weight", "module.module.block2.nblockLayer.3.batch_norm2.bias", "module.module.block2.nblockLayer.3.batch_norm2.running_mean", "module.module.block2.nblockLayer.3.batch_norm2.running_var", "module.module.block2.nblockLayer.3.conv1.weight", "module.module.block2.nblockLayer.3.conv2.weight", "module.module.block2.nblockLayer.4.batch_norm1.weight", "module.module.block2.nblockLayer.4.batch_norm1.bias", "module.module.block2.nblockLayer.4.batch_norm1.running_mean", "module.module.block2.nblockLayer.4.batch_norm1.running_var", "module.module.block2.nblockLayer.4.batch_norm2.weight", "module.module.block2.nblockLayer.4.batch_norm2.bias", "module.module.block2.nblockLayer.4.batch_norm2.running_mean", "module.module.block2.nblockLayer.4.batch_norm2.running_var", "module.module.block2.nblockLayer.4.conv1.weight", "module.module.block2.nblockLayer.4.conv2.weight", "module.module.block3.nblockLayer.0.batch_norm1.weight", "module.module.block3.nblockLayer.0.batch_norm1.bias", "module.module.block3.nblockLayer.0.batch_norm1.running_mean", "module.module.block3.nblockLayer.0.batch_norm1.running_var", "module.module.block3.nblockLayer.0.batch_norm2.weight", "module.module.block3.nblockLayer.0.batch_norm2.bias", "module.module.block3.nblockLayer.0.batch_norm2.running_mean", "module.module.block3.nblockLayer.0.batch_norm2.running_var", "module.module.block3.nblockLayer.0.conv1.weight", "module.module.block3.nblockLayer.0.conv2.weight", "module.module.block3.nblockLayer.0.conv_inp.weight", "module.module.block3.nblockLayer.1.batch_norm1.weight", "module.module.block3.nblockLayer.1.batch_norm1.bias", "module.module.block3.nblockLayer.1.batch_norm1.running_mean", "module.module.block3.nblockLayer.1.batch_norm1.running_var", "module.module.block3.nblockLayer.1.batch_norm2.weight", "module.module.block3.nblockLayer.1.batch_norm2.bias", "module.module.block3.nblockLayer.1.batch_norm2.running_mean", "module.module.block3.nblockLayer.1.batch_norm2.running_var", "module.module.block3.nblockLayer.1.conv1.weight", "module.module.block3.nblockLayer.1.conv2.weight", "module.module.block3.nblockLayer.2.batch_norm1.weight", "module.module.block3.nblockLayer.2.batch_norm1.bias", "module.module.block3.nblockLayer.2.batch_norm1.running_mean", "module.module.block3.nblockLayer.2.batch_norm1.running_var", "module.module.block3.nblockLayer.2.batch_norm2.weight", "module.module.block3.nblockLayer.2.batch_norm2.bias", "module.module.block3.nblockLayer.2.batch_norm2.running_mean", "module.module.block3.nblockLayer.2.batch_norm2.running_var", "module.module.block3.nblockLayer.2.conv1.weight", "module.module.block3.nblockLayer.2.conv2.weight", "module.module.block3.nblockLayer.3.batch_norm1.weight", "module.module.block3.nblockLayer.3.batch_norm1.bias", "module.module.block3.nblockLayer.3.batch_norm1.running_mean", "module.module.block3.nblockLayer.3.batch_norm1.running_var", "module.module.block3.nblockLayer.3.batch_norm2.weight", "module.module.block3.nblockLayer.3.batch_norm2.bias", "module.module.block3.nblockLayer.3.batch_norm2.running_mean", "module.module.block3.nblockLayer.3.batch_norm2.running_var", "module.module.block3.nblockLayer.3.conv1.weight", "module.module.block3.nblockLayer.3.conv2.weight", "module.module.block3.nblockLayer.4.batch_norm1.weight", "module.module.block3.nblockLayer.4.batch_norm1.bias", "module.module.block3.nblockLayer.4.batch_norm1.running_mean", "module.module.block3.nblockLayer.4.batch_norm1.running_var", "module.module.block3.nblockLayer.4.batch_norm2.weight", "module.module.block3.nblockLayer.4.batch_norm2.bias", "module.module.block3.nblockLayer.4.batch_norm2.running_mean", "module.module.block3.nblockLayer.4.batch_norm2.running_var", "module.module.block3.nblockLayer.4.conv1.weight", "module.module.block3.nblockLayer.4.conv2.weight", "module.module.batch_norm.weight", "module.module.batch_norm.bias", "module.module.batch_norm.running_mean", "module.module.batch_norm.running_var", "module.module.fc.weight", "module.module.fc.bias". 
	Unexpected key(s) in state_dict: "module.conv1.weight", "module.block1.nblockLayer.0.batch_norm1.weight", "module.block1.nblockLayer.0.batch_norm1.bias", "module.block1.nblockLayer.0.batch_norm1.running_mean", "module.block1.nblockLayer.0.batch_norm1.running_var", "module.block1.nblockLayer.0.batch_norm1.num_batches_tracked", "module.block1.nblockLayer.0.batch_norm2.weight", "module.block1.nblockLayer.0.batch_norm2.bias", "module.block1.nblockLayer.0.batch_norm2.running_mean", "module.block1.nblockLayer.0.batch_norm2.running_var", "module.block1.nblockLayer.0.batch_norm2.num_batches_tracked", "module.block1.nblockLayer.0.conv1.weight", "module.block1.nblockLayer.0.conv2.weight", "module.block1.nblockLayer.0.conv_inp.weight", "module.block1.nblockLayer.1.batch_norm1.weight", "module.block1.nblockLayer.1.batch_norm1.bias", "module.block1.nblockLayer.1.batch_norm1.running_mean", "module.block1.nblockLayer.1.batch_norm1.running_var", "module.block1.nblockLayer.1.batch_norm1.num_batches_tracked", "module.block1.nblockLayer.1.batch_norm2.weight", "module.block1.nblockLayer.1.batch_norm2.bias", "module.block1.nblockLayer.1.batch_norm2.running_mean", "module.block1.nblockLayer.1.batch_norm2.running_var", "module.block1.nblockLayer.1.batch_norm2.num_batches_tracked", "module.block1.nblockLayer.1.conv1.weight", "module.block1.nblockLayer.1.conv2.weight", "module.block1.nblockLayer.2.batch_norm1.weight", "module.block1.nblockLayer.2.batch_norm1.bias", "module.block1.nblockLayer.2.batch_norm1.running_mean", "module.block1.nblockLayer.2.batch_norm1.running_var", "module.block1.nblockLayer.2.batch_norm1.num_batches_tracked", "module.block1.nblockLayer.2.batch_norm2.weight", "module.block1.nblockLayer.2.batch_norm2.bias", "module.block1.nblockLayer.2.batch_norm2.running_mean", "module.block1.nblockLayer.2.batch_norm2.running_var", "module.block1.nblockLayer.2.batch_norm2.num_batches_tracked", "module.block1.nblockLayer.2.conv1.weight", "module.block1.nblockLayer.2.conv2.weight", "module.block1.nblockLayer.3.batch_norm1.weight", "module.block1.nblockLayer.3.batch_norm1.bias", "module.block1.nblockLayer.3.batch_norm1.running_mean", "module.block1.nblockLayer.3.batch_norm1.running_var", "module.block1.nblockLayer.3.batch_norm1.num_batches_tracked", "module.block1.nblockLayer.3.batch_norm2.weight", "module.block1.nblockLayer.3.batch_norm2.bias", "module.block1.nblockLayer.3.batch_norm2.running_mean", "module.block1.nblockLayer.3.batch_norm2.running_var", "module.block1.nblockLayer.3.batch_norm2.num_batches_tracked", "module.block1.nblockLayer.3.conv1.weight", "module.block1.nblockLayer.3.conv2.weight", "module.block2.nblockLayer.0.batch_norm1.weight", "module.block2.nblockLayer.0.batch_norm1.bias", "module.block2.nblockLayer.0.batch_norm1.running_mean", "module.block2.nblockLayer.0.batch_norm1.running_var", "module.block2.nblockLayer.0.batch_norm1.num_batches_tracked", "module.block2.nblockLayer.0.batch_norm2.weight", "module.block2.nblockLayer.0.batch_norm2.bias", "module.block2.nblockLayer.0.batch_norm2.running_mean", "module.block2.nblockLayer.0.batch_norm2.running_var", "module.block2.nblockLayer.0.batch_norm2.num_batches_tracked", "module.block2.nblockLayer.0.conv1.weight", "module.block2.nblockLayer.0.conv2.weight", "module.block2.nblockLayer.0.conv_inp.weight", "module.block2.nblockLayer.1.batch_norm1.weight", "module.block2.nblockLayer.1.batch_norm1.bias", "module.block2.nblockLayer.1.batch_norm1.running_mean", "module.block2.nblockLayer.1.batch_norm1.running_var", "module.block2.nblockLayer.1.batch_norm1.num_batches_tracked", "module.block2.nblockLayer.1.batch_norm2.weight", "module.block2.nblockLayer.1.batch_norm2.bias", "module.block2.nblockLayer.1.batch_norm2.running_mean", "module.block2.nblockLayer.1.batch_norm2.running_var", "module.block2.nblockLayer.1.batch_norm2.num_batches_tracked", "module.block2.nblockLayer.1.conv1.weight", "module.block2.nblockLayer.1.conv2.weight", "module.block2.nblockLayer.2.batch_norm1.weight", "module.block2.nblockLayer.2.batch_norm1.bias", "module.block2.nblockLayer.2.batch_norm1.running_mean", "module.block2.nblockLayer.2.batch_norm1.running_var", "module.block2.nblockLayer.2.batch_norm1.num_batches_tracked", "module.block2.nblockLayer.2.batch_norm2.weight", "module.block2.nblockLayer.2.batch_norm2.bias", "module.block2.nblockLayer.2.batch_norm2.running_mean", "module.block2.nblockLayer.2.batch_norm2.running_var", "module.block2.nblockLayer.2.batch_norm2.num_batches_tracked", "module.block2.nblockLayer.2.conv1.weight", "module.block2.nblockLayer.2.conv2.weight", "module.block2.nblockLayer.3.batch_norm1.weight", "module.block2.nblockLayer.3.batch_norm1.bias", "module.block2.nblockLayer.3.batch_norm1.running_mean", "module.block2.nblockLayer.3.batch_norm1.running_var", "module.block2.nblockLayer.3.batch_norm1.num_batches_tracked", "module.block2.nblockLayer.3.batch_norm2.weight", "module.block2.nblockLayer.3.batch_norm2.bias", "module.block2.nblockLayer.3.batch_norm2.running_mean", "module.block2.nblockLayer.3.batch_norm2.running_var", "module.block2.nblockLayer.3.batch_norm2.num_batches_tracked", "module.block2.nblockLayer.3.conv1.weight", "module.block2.nblockLayer.3.conv2.weight", "module.block3.nblockLayer.0.batch_norm1.weight", "module.block3.nblockLayer.0.batch_norm1.bias", "module.block3.nblockLayer.0.batch_norm1.running_mean", "module.block3.nblockLayer.0.batch_norm1.running_var", "module.block3.nblockLayer.0.batch_norm1.num_batches_tracked", "module.block3.nblockLayer.0.batch_norm2.weight", "module.block3.nblockLayer.0.batch_norm2.bias", "module.block3.nblockLayer.0.batch_norm2.running_mean", "module.block3.nblockLayer.0.batch_norm2.running_var", "module.block3.nblockLayer.0.batch_norm2.num_batches_tracked", "module.block3.nblockLayer.0.conv1.weight", "module.block3.nblockLayer.0.conv2.weight", "module.block3.nblockLayer.0.conv_inp.weight", "module.block3.nblockLayer.1.batch_norm1.weight", "module.block3.nblockLayer.1.batch_norm1.bias", "module.block3.nblockLayer.1.batch_norm1.running_mean", "module.block3.nblockLayer.1.batch_norm1.running_var", "module.block3.nblockLayer.1.batch_norm1.num_batches_tracked", "module.block3.nblockLayer.1.batch_norm2.weight", "module.block3.nblockLayer.1.batch_norm2.bias", "module.block3.nblockLayer.1.batch_norm2.running_mean", "module.block3.nblockLayer.1.batch_norm2.running_var", "module.block3.nblockLayer.1.batch_norm2.num_batches_tracked", "module.block3.nblockLayer.1.conv1.weight", "module.block3.nblockLayer.1.conv2.weight", "module.block3.nblockLayer.2.batch_norm1.weight", "module.block3.nblockLayer.2.batch_norm1.bias", "module.block3.nblockLayer.2.batch_norm1.running_mean", "module.block3.nblockLayer.2.batch_norm1.running_var", "module.block3.nblockLayer.2.batch_norm1.num_batches_tracked", "module.block3.nblockLayer.2.batch_norm2.weight", "module.block3.nblockLayer.2.batch_norm2.bias", "module.block3.nblockLayer.2.batch_norm2.running_mean", "module.block3.nblockLayer.2.batch_norm2.running_var", "module.block3.nblockLayer.2.batch_norm2.num_batches_tracked", "module.block3.nblockLayer.2.conv1.weight", "module.block3.nblockLayer.2.conv2.weight", "module.block3.nblockLayer.3.batch_norm1.weight", "module.block3.nblockLayer.3.batch_norm1.bias", "module.block3.nblockLayer.3.batch_norm1.running_mean", "module.block3.nblockLayer.3.batch_norm1.running_var", "module.block3.nblockLayer.3.batch_norm1.num_batches_tracked", "module.block3.nblockLayer.3.batch_norm2.weight", "module.block3.nblockLayer.3.batch_norm2.bias", "module.block3.nblockLayer.3.batch_norm2.running_mean", "module.block3.nblockLayer.3.batch_norm2.running_var", "module.block3.nblockLayer.3.batch_norm2.num_batches_tracked", "module.block3.nblockLayer.3.conv1.weight", "module.block3.nblockLayer.3.conv2.weight", "module.batch_norm.weight", "module.batch_norm.bias", "module.batch_norm.running_mean", "module.batch_norm.running_var", "module.batch_norm.num_batches_tracked", "module.fc.weight", "module.fc.bias". 
# RAND
# Batch size 1000, Train accuracy 60
Namespace(alpha_l_1=1.0, alpha_l_2=0.01, alpha_l_inf=0.001, batch_size=500, combine_ratio=0.5, concat=0, concat_factor=1.0, config_file=None, data_path=None, dataset='CIFAR10', device='cuda:0', distance=None, dropRate=0.0, epochs=50, epsilon_l_1=12, epsilon_l_2=0.5, epsilon_l_inf=0.03137254901960784, experiment='3-var', feature_type='rand', gap=0.001, gpu_id=0, imagenet_architecture='wrn', k=100, lr_max=0.1, lr_min=0.0, lr_mode=1, mode='teacher', model_dataset='CIFAR10', model_id='teacher_normalized', model_type='wrn-28-10', noise_sigma=0.05, normalize=1, num_iter=500, opt_type='SGD', path=None, pseudo_labels=0, randomize=0, regressor_embed=0, restarts=1, resume=0, resume_iter=-1, reverse_train_test=0, seed=0, smallest_adv=1, target_batch_size=1000, target_epoch=0, target_te_acc=0, target_tr_acc=60)
Model Directory: ./models/CIFAR10/model_teacher_normalized_1000
File Directory: ./files/CIFAR10_1000/model_teacher_normalized_tr_acc_60
cuda:0
22-10-07 18:01
No Transform
Files already downloaded and verified
Files already downloaded and verified
No Transform
Files already downloaded and verified
Files already downloaded and verified
Loading model from ./models/CIFAR10/model_teacher_normalized_1000/tr_acc_60.pt
Traceback (most recent call last):
  File "./src/generate_features.py", line 197, in feature_extractor
    student.load_state_dict(torch.load(location, map_location = args.device)) 
  File "/home/user/tingweijing/env/DIenv/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1223, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.block1.nblockLayer.4.batch_norm1.weight", "module.block1.nblockLayer.4.batch_norm1.bias", "module.block1.nblockLayer.4.batch_norm1.running_mean", "module.block1.nblockLayer.4.batch_norm1.running_var", "module.block1.nblockLayer.4.batch_norm2.weight", "module.block1.nblockLayer.4.batch_norm2.bias", "module.block1.nblockLayer.4.batch_norm2.running_mean", "module.block1.nblockLayer.4.batch_norm2.running_var", "module.block1.nblockLayer.4.conv1.weight", "module.block1.nblockLayer.4.conv2.weight", "module.block2.nblockLayer.4.batch_norm1.weight", "module.block2.nblockLayer.4.batch_norm1.bias", "module.block2.nblockLayer.4.batch_norm1.running_mean", "module.block2.nblockLayer.4.batch_norm1.running_var", "module.block2.nblockLayer.4.batch_norm2.weight", "module.block2.nblockLayer.4.batch_norm2.bias", "module.block2.nblockLayer.4.batch_norm2.running_mean", "module.block2.nblockLayer.4.batch_norm2.running_var", "module.block2.nblockLayer.4.conv1.weight", "module.block2.nblockLayer.4.conv2.weight", "module.block3.nblockLayer.4.batch_norm1.weight", "module.block3.nblockLayer.4.batch_norm1.bias", "module.block3.nblockLayer.4.batch_norm1.running_mean", "module.block3.nblockLayer.4.batch_norm1.running_var", "module.block3.nblockLayer.4.batch_norm2.weight", "module.block3.nblockLayer.4.batch_norm2.bias", "module.block3.nblockLayer.4.batch_norm2.running_mean", "module.block3.nblockLayer.4.batch_norm2.running_var", "module.block3.nblockLayer.4.conv1.weight", "module.block3.nblockLayer.4.conv2.weight". 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "./src/generate_features.py", line 405, in <module>
    feature_extractor(args)
  File "./src/generate_features.py", line 200, in feature_extractor
    student.load_state_dict(torch.load(location, map_location = args.device))   
  File "/home/user/tingweijing/env/DIenv/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1223, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.module.conv1.weight", "module.module.block1.nblockLayer.0.batch_norm1.weight", "module.module.block1.nblockLayer.0.batch_norm1.bias", "module.module.block1.nblockLayer.0.batch_norm1.running_mean", "module.module.block1.nblockLayer.0.batch_norm1.running_var", "module.module.block1.nblockLayer.0.batch_norm2.weight", "module.module.block1.nblockLayer.0.batch_norm2.bias", "module.module.block1.nblockLayer.0.batch_norm2.running_mean", "module.module.block1.nblockLayer.0.batch_norm2.running_var", "module.module.block1.nblockLayer.0.conv1.weight", "module.module.block1.nblockLayer.0.conv2.weight", "module.module.block1.nblockLayer.0.conv_inp.weight", "module.module.block1.nblockLayer.1.batch_norm1.weight", "module.module.block1.nblockLayer.1.batch_norm1.bias", "module.module.block1.nblockLayer.1.batch_norm1.running_mean", "module.module.block1.nblockLayer.1.batch_norm1.running_var", "module.module.block1.nblockLayer.1.batch_norm2.weight", "module.module.block1.nblockLayer.1.batch_norm2.bias", "module.module.block1.nblockLayer.1.batch_norm2.running_mean", "module.module.block1.nblockLayer.1.batch_norm2.running_var", "module.module.block1.nblockLayer.1.conv1.weight", "module.module.block1.nblockLayer.1.conv2.weight", "module.module.block1.nblockLayer.2.batch_norm1.weight", "module.module.block1.nblockLayer.2.batch_norm1.bias", "module.module.block1.nblockLayer.2.batch_norm1.running_mean", "module.module.block1.nblockLayer.2.batch_norm1.running_var", "module.module.block1.nblockLayer.2.batch_norm2.weight", "module.module.block1.nblockLayer.2.batch_norm2.bias", "module.module.block1.nblockLayer.2.batch_norm2.running_mean", "module.module.block1.nblockLayer.2.batch_norm2.running_var", "module.module.block1.nblockLayer.2.conv1.weight", "module.module.block1.nblockLayer.2.conv2.weight", "module.module.block1.nblockLayer.3.batch_norm1.weight", "module.module.block1.nblockLayer.3.batch_norm1.bias", "module.module.block1.nblockLayer.3.batch_norm1.running_mean", "module.module.block1.nblockLayer.3.batch_norm1.running_var", "module.module.block1.nblockLayer.3.batch_norm2.weight", "module.module.block1.nblockLayer.3.batch_norm2.bias", "module.module.block1.nblockLayer.3.batch_norm2.running_mean", "module.module.block1.nblockLayer.3.batch_norm2.running_var", "module.module.block1.nblockLayer.3.conv1.weight", "module.module.block1.nblockLayer.3.conv2.weight", "module.module.block1.nblockLayer.4.batch_norm1.weight", "module.module.block1.nblockLayer.4.batch_norm1.bias", "module.module.block1.nblockLayer.4.batch_norm1.running_mean", "module.module.block1.nblockLayer.4.batch_norm1.running_var", "module.module.block1.nblockLayer.4.batch_norm2.weight", "module.module.block1.nblockLayer.4.batch_norm2.bias", "module.module.block1.nblockLayer.4.batch_norm2.running_mean", "module.module.block1.nblockLayer.4.batch_norm2.running_var", "module.module.block1.nblockLayer.4.conv1.weight", "module.module.block1.nblockLayer.4.conv2.weight", "module.module.block2.nblockLayer.0.batch_norm1.weight", "module.module.block2.nblockLayer.0.batch_norm1.bias", "module.module.block2.nblockLayer.0.batch_norm1.running_mean", "module.module.block2.nblockLayer.0.batch_norm1.running_var", "module.module.block2.nblockLayer.0.batch_norm2.weight", "module.module.block2.nblockLayer.0.batch_norm2.bias", "module.module.block2.nblockLayer.0.batch_norm2.running_mean", "module.module.block2.nblockLayer.0.batch_norm2.running_var", "module.module.block2.nblockLayer.0.conv1.weight", "module.module.block2.nblockLayer.0.conv2.weight", "module.module.block2.nblockLayer.0.conv_inp.weight", "module.module.block2.nblockLayer.1.batch_norm1.weight", "module.module.block2.nblockLayer.1.batch_norm1.bias", "module.module.block2.nblockLayer.1.batch_norm1.running_mean", "module.module.block2.nblockLayer.1.batch_norm1.running_var", "module.module.block2.nblockLayer.1.batch_norm2.weight", "module.module.block2.nblockLayer.1.batch_norm2.bias", "module.module.block2.nblockLayer.1.batch_norm2.running_mean", "module.module.block2.nblockLayer.1.batch_norm2.running_var", "module.module.block2.nblockLayer.1.conv1.weight", "module.module.block2.nblockLayer.1.conv2.weight", "module.module.block2.nblockLayer.2.batch_norm1.weight", "module.module.block2.nblockLayer.2.batch_norm1.bias", "module.module.block2.nblockLayer.2.batch_norm1.running_mean", "module.module.block2.nblockLayer.2.batch_norm1.running_var", "module.module.block2.nblockLayer.2.batch_norm2.weight", "module.module.block2.nblockLayer.2.batch_norm2.bias", "module.module.block2.nblockLayer.2.batch_norm2.running_mean", "module.module.block2.nblockLayer.2.batch_norm2.running_var", "module.module.block2.nblockLayer.2.conv1.weight", "module.module.block2.nblockLayer.2.conv2.weight", "module.module.block2.nblockLayer.3.batch_norm1.weight", "module.module.block2.nblockLayer.3.batch_norm1.bias", "module.module.block2.nblockLayer.3.batch_norm1.running_mean", "module.module.block2.nblockLayer.3.batch_norm1.running_var", "module.module.block2.nblockLayer.3.batch_norm2.weight", "module.module.block2.nblockLayer.3.batch_norm2.bias", "module.module.block2.nblockLayer.3.batch_norm2.running_mean", "module.module.block2.nblockLayer.3.batch_norm2.running_var", "module.module.block2.nblockLayer.3.conv1.weight", "module.module.block2.nblockLayer.3.conv2.weight", "module.module.block2.nblockLayer.4.batch_norm1.weight", "module.module.block2.nblockLayer.4.batch_norm1.bias", "module.module.block2.nblockLayer.4.batch_norm1.running_mean", "module.module.block2.nblockLayer.4.batch_norm1.running_var", "module.module.block2.nblockLayer.4.batch_norm2.weight", "module.module.block2.nblockLayer.4.batch_norm2.bias", "module.module.block2.nblockLayer.4.batch_norm2.running_mean", "module.module.block2.nblockLayer.4.batch_norm2.running_var", "module.module.block2.nblockLayer.4.conv1.weight", "module.module.block2.nblockLayer.4.conv2.weight", "module.module.block3.nblockLayer.0.batch_norm1.weight", "module.module.block3.nblockLayer.0.batch_norm1.bias", "module.module.block3.nblockLayer.0.batch_norm1.running_mean", "module.module.block3.nblockLayer.0.batch_norm1.running_var", "module.module.block3.nblockLayer.0.batch_norm2.weight", "module.module.block3.nblockLayer.0.batch_norm2.bias", "module.module.block3.nblockLayer.0.batch_norm2.running_mean", "module.module.block3.nblockLayer.0.batch_norm2.running_var", "module.module.block3.nblockLayer.0.conv1.weight", "module.module.block3.nblockLayer.0.conv2.weight", "module.module.block3.nblockLayer.0.conv_inp.weight", "module.module.block3.nblockLayer.1.batch_norm1.weight", "module.module.block3.nblockLayer.1.batch_norm1.bias", "module.module.block3.nblockLayer.1.batch_norm1.running_mean", "module.module.block3.nblockLayer.1.batch_norm1.running_var", "module.module.block3.nblockLayer.1.batch_norm2.weight", "module.module.block3.nblockLayer.1.batch_norm2.bias", "module.module.block3.nblockLayer.1.batch_norm2.running_mean", "module.module.block3.nblockLayer.1.batch_norm2.running_var", "module.module.block3.nblockLayer.1.conv1.weight", "module.module.block3.nblockLayer.1.conv2.weight", "module.module.block3.nblockLayer.2.batch_norm1.weight", "module.module.block3.nblockLayer.2.batch_norm1.bias", "module.module.block3.nblockLayer.2.batch_norm1.running_mean", "module.module.block3.nblockLayer.2.batch_norm1.running_var", "module.module.block3.nblockLayer.2.batch_norm2.weight", "module.module.block3.nblockLayer.2.batch_norm2.bias", "module.module.block3.nblockLayer.2.batch_norm2.running_mean", "module.module.block3.nblockLayer.2.batch_norm2.running_var", "module.module.block3.nblockLayer.2.conv1.weight", "module.module.block3.nblockLayer.2.conv2.weight", "module.module.block3.nblockLayer.3.batch_norm1.weight", "module.module.block3.nblockLayer.3.batch_norm1.bias", "module.module.block3.nblockLayer.3.batch_norm1.running_mean", "module.module.block3.nblockLayer.3.batch_norm1.running_var", "module.module.block3.nblockLayer.3.batch_norm2.weight", "module.module.block3.nblockLayer.3.batch_norm2.bias", "module.module.block3.nblockLayer.3.batch_norm2.running_mean", "module.module.block3.nblockLayer.3.batch_norm2.running_var", "module.module.block3.nblockLayer.3.conv1.weight", "module.module.block3.nblockLayer.3.conv2.weight", "module.module.block3.nblockLayer.4.batch_norm1.weight", "module.module.block3.nblockLayer.4.batch_norm1.bias", "module.module.block3.nblockLayer.4.batch_norm1.running_mean", "module.module.block3.nblockLayer.4.batch_norm1.running_var", "module.module.block3.nblockLayer.4.batch_norm2.weight", "module.module.block3.nblockLayer.4.batch_norm2.bias", "module.module.block3.nblockLayer.4.batch_norm2.running_mean", "module.module.block3.nblockLayer.4.batch_norm2.running_var", "module.module.block3.nblockLayer.4.conv1.weight", "module.module.block3.nblockLayer.4.conv2.weight", "module.module.batch_norm.weight", "module.module.batch_norm.bias", "module.module.batch_norm.running_mean", "module.module.batch_norm.running_var", "module.module.fc.weight", "module.module.fc.bias". 
	Unexpected key(s) in state_dict: "module.conv1.weight", "module.block1.nblockLayer.0.batch_norm1.weight", "module.block1.nblockLayer.0.batch_norm1.bias", "module.block1.nblockLayer.0.batch_norm1.running_mean", "module.block1.nblockLayer.0.batch_norm1.running_var", "module.block1.nblockLayer.0.batch_norm1.num_batches_tracked", "module.block1.nblockLayer.0.batch_norm2.weight", "module.block1.nblockLayer.0.batch_norm2.bias", "module.block1.nblockLayer.0.batch_norm2.running_mean", "module.block1.nblockLayer.0.batch_norm2.running_var", "module.block1.nblockLayer.0.batch_norm2.num_batches_tracked", "module.block1.nblockLayer.0.conv1.weight", "module.block1.nblockLayer.0.conv2.weight", "module.block1.nblockLayer.0.conv_inp.weight", "module.block1.nblockLayer.1.batch_norm1.weight", "module.block1.nblockLayer.1.batch_norm1.bias", "module.block1.nblockLayer.1.batch_norm1.running_mean", "module.block1.nblockLayer.1.batch_norm1.running_var", "module.block1.nblockLayer.1.batch_norm1.num_batches_tracked", "module.block1.nblockLayer.1.batch_norm2.weight", "module.block1.nblockLayer.1.batch_norm2.bias", "module.block1.nblockLayer.1.batch_norm2.running_mean", "module.block1.nblockLayer.1.batch_norm2.running_var", "module.block1.nblockLayer.1.batch_norm2.num_batches_tracked", "module.block1.nblockLayer.1.conv1.weight", "module.block1.nblockLayer.1.conv2.weight", "module.block1.nblockLayer.2.batch_norm1.weight", "module.block1.nblockLayer.2.batch_norm1.bias", "module.block1.nblockLayer.2.batch_norm1.running_mean", "module.block1.nblockLayer.2.batch_norm1.running_var", "module.block1.nblockLayer.2.batch_norm1.num_batches_tracked", "module.block1.nblockLayer.2.batch_norm2.weight", "module.block1.nblockLayer.2.batch_norm2.bias", "module.block1.nblockLayer.2.batch_norm2.running_mean", "module.block1.nblockLayer.2.batch_norm2.running_var", "module.block1.nblockLayer.2.batch_norm2.num_batches_tracked", "module.block1.nblockLayer.2.conv1.weight", "module.block1.nblockLayer.2.conv2.weight", "module.block1.nblockLayer.3.batch_norm1.weight", "module.block1.nblockLayer.3.batch_norm1.bias", "module.block1.nblockLayer.3.batch_norm1.running_mean", "module.block1.nblockLayer.3.batch_norm1.running_var", "module.block1.nblockLayer.3.batch_norm1.num_batches_tracked", "module.block1.nblockLayer.3.batch_norm2.weight", "module.block1.nblockLayer.3.batch_norm2.bias", "module.block1.nblockLayer.3.batch_norm2.running_mean", "module.block1.nblockLayer.3.batch_norm2.running_var", "module.block1.nblockLayer.3.batch_norm2.num_batches_tracked", "module.block1.nblockLayer.3.conv1.weight", "module.block1.nblockLayer.3.conv2.weight", "module.block2.nblockLayer.0.batch_norm1.weight", "module.block2.nblockLayer.0.batch_norm1.bias", "module.block2.nblockLayer.0.batch_norm1.running_mean", "module.block2.nblockLayer.0.batch_norm1.running_var", "module.block2.nblockLayer.0.batch_norm1.num_batches_tracked", "module.block2.nblockLayer.0.batch_norm2.weight", "module.block2.nblockLayer.0.batch_norm2.bias", "module.block2.nblockLayer.0.batch_norm2.running_mean", "module.block2.nblockLayer.0.batch_norm2.running_var", "module.block2.nblockLayer.0.batch_norm2.num_batches_tracked", "module.block2.nblockLayer.0.conv1.weight", "module.block2.nblockLayer.0.conv2.weight", "module.block2.nblockLayer.0.conv_inp.weight", "module.block2.nblockLayer.1.batch_norm1.weight", "module.block2.nblockLayer.1.batch_norm1.bias", "module.block2.nblockLayer.1.batch_norm1.running_mean", "module.block2.nblockLayer.1.batch_norm1.running_var", "module.block2.nblockLayer.1.batch_norm1.num_batches_tracked", "module.block2.nblockLayer.1.batch_norm2.weight", "module.block2.nblockLayer.1.batch_norm2.bias", "module.block2.nblockLayer.1.batch_norm2.running_mean", "module.block2.nblockLayer.1.batch_norm2.running_var", "module.block2.nblockLayer.1.batch_norm2.num_batches_tracked", "module.block2.nblockLayer.1.conv1.weight", "module.block2.nblockLayer.1.conv2.weight", "module.block2.nblockLayer.2.batch_norm1.weight", "module.block2.nblockLayer.2.batch_norm1.bias", "module.block2.nblockLayer.2.batch_norm1.running_mean", "module.block2.nblockLayer.2.batch_norm1.running_var", "module.block2.nblockLayer.2.batch_norm1.num_batches_tracked", "module.block2.nblockLayer.2.batch_norm2.weight", "module.block2.nblockLayer.2.batch_norm2.bias", "module.block2.nblockLayer.2.batch_norm2.running_mean", "module.block2.nblockLayer.2.batch_norm2.running_var", "module.block2.nblockLayer.2.batch_norm2.num_batches_tracked", "module.block2.nblockLayer.2.conv1.weight", "module.block2.nblockLayer.2.conv2.weight", "module.block2.nblockLayer.3.batch_norm1.weight", "module.block2.nblockLayer.3.batch_norm1.bias", "module.block2.nblockLayer.3.batch_norm1.running_mean", "module.block2.nblockLayer.3.batch_norm1.running_var", "module.block2.nblockLayer.3.batch_norm1.num_batches_tracked", "module.block2.nblockLayer.3.batch_norm2.weight", "module.block2.nblockLayer.3.batch_norm2.bias", "module.block2.nblockLayer.3.batch_norm2.running_mean", "module.block2.nblockLayer.3.batch_norm2.running_var", "module.block2.nblockLayer.3.batch_norm2.num_batches_tracked", "module.block2.nblockLayer.3.conv1.weight", "module.block2.nblockLayer.3.conv2.weight", "module.block3.nblockLayer.0.batch_norm1.weight", "module.block3.nblockLayer.0.batch_norm1.bias", "module.block3.nblockLayer.0.batch_norm1.running_mean", "module.block3.nblockLayer.0.batch_norm1.running_var", "module.block3.nblockLayer.0.batch_norm1.num_batches_tracked", "module.block3.nblockLayer.0.batch_norm2.weight", "module.block3.nblockLayer.0.batch_norm2.bias", "module.block3.nblockLayer.0.batch_norm2.running_mean", "module.block3.nblockLayer.0.batch_norm2.running_var", "module.block3.nblockLayer.0.batch_norm2.num_batches_tracked", "module.block3.nblockLayer.0.conv1.weight", "module.block3.nblockLayer.0.conv2.weight", "module.block3.nblockLayer.0.conv_inp.weight", "module.block3.nblockLayer.1.batch_norm1.weight", "module.block3.nblockLayer.1.batch_norm1.bias", "module.block3.nblockLayer.1.batch_norm1.running_mean", "module.block3.nblockLayer.1.batch_norm1.running_var", "module.block3.nblockLayer.1.batch_norm1.num_batches_tracked", "module.block3.nblockLayer.1.batch_norm2.weight", "module.block3.nblockLayer.1.batch_norm2.bias", "module.block3.nblockLayer.1.batch_norm2.running_mean", "module.block3.nblockLayer.1.batch_norm2.running_var", "module.block3.nblockLayer.1.batch_norm2.num_batches_tracked", "module.block3.nblockLayer.1.conv1.weight", "module.block3.nblockLayer.1.conv2.weight", "module.block3.nblockLayer.2.batch_norm1.weight", "module.block3.nblockLayer.2.batch_norm1.bias", "module.block3.nblockLayer.2.batch_norm1.running_mean", "module.block3.nblockLayer.2.batch_norm1.running_var", "module.block3.nblockLayer.2.batch_norm1.num_batches_tracked", "module.block3.nblockLayer.2.batch_norm2.weight", "module.block3.nblockLayer.2.batch_norm2.bias", "module.block3.nblockLayer.2.batch_norm2.running_mean", "module.block3.nblockLayer.2.batch_norm2.running_var", "module.block3.nblockLayer.2.batch_norm2.num_batches_tracked", "module.block3.nblockLayer.2.conv1.weight", "module.block3.nblockLayer.2.conv2.weight", "module.block3.nblockLayer.3.batch_norm1.weight", "module.block3.nblockLayer.3.batch_norm1.bias", "module.block3.nblockLayer.3.batch_norm1.running_mean", "module.block3.nblockLayer.3.batch_norm1.running_var", "module.block3.nblockLayer.3.batch_norm1.num_batches_tracked", "module.block3.nblockLayer.3.batch_norm2.weight", "module.block3.nblockLayer.3.batch_norm2.bias", "module.block3.nblockLayer.3.batch_norm2.running_mean", "module.block3.nblockLayer.3.batch_norm2.running_var", "module.block3.nblockLayer.3.batch_norm2.num_batches_tracked", "module.block3.nblockLayer.3.conv1.weight", "module.block3.nblockLayer.3.conv2.weight", "module.batch_norm.weight", "module.batch_norm.bias", "module.batch_norm.running_mean", "module.batch_norm.running_var", "module.batch_norm.num_batches_tracked", "module.fc.weight", "module.fc.bias". 
# Batch size 1000, Train accuracy 70
Namespace(alpha_l_1=1.0, alpha_l_2=0.01, alpha_l_inf=0.001, batch_size=500, combine_ratio=0.5, concat=0, concat_factor=1.0, config_file=None, data_path=None, dataset='CIFAR10', device='cuda:0', distance=None, dropRate=0.0, epochs=50, epsilon_l_1=12, epsilon_l_2=0.5, epsilon_l_inf=0.03137254901960784, experiment='3-var', feature_type='rand', gap=0.001, gpu_id=0, imagenet_architecture='wrn', k=100, lr_max=0.1, lr_min=0.0, lr_mode=1, mode='teacher', model_dataset='CIFAR10', model_id='teacher_normalized', model_type='wrn-28-10', noise_sigma=0.05, normalize=1, num_iter=500, opt_type='SGD', path=None, pseudo_labels=0, randomize=0, regressor_embed=0, restarts=1, resume=0, resume_iter=-1, reverse_train_test=0, seed=0, smallest_adv=1, target_batch_size=1000, target_epoch=0, target_te_acc=0, target_tr_acc=70)
Model Directory: ./models/CIFAR10/model_teacher_normalized_1000
File Directory: ./files/CIFAR10_1000/model_teacher_normalized_tr_acc_70
cuda:0
22-10-07 18:01
No Transform
Files already downloaded and verified
Files already downloaded and verified
No Transform
Files already downloaded and verified
Files already downloaded and verified
Loading model from ./models/CIFAR10/model_teacher_normalized_1000/tr_acc_70.pt
Traceback (most recent call last):
  File "./src/generate_features.py", line 197, in feature_extractor
    student.load_state_dict(torch.load(location, map_location = args.device)) 
  File "/home/user/tingweijing/env/DIenv/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1223, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.block1.nblockLayer.4.batch_norm1.weight", "module.block1.nblockLayer.4.batch_norm1.bias", "module.block1.nblockLayer.4.batch_norm1.running_mean", "module.block1.nblockLayer.4.batch_norm1.running_var", "module.block1.nblockLayer.4.batch_norm2.weight", "module.block1.nblockLayer.4.batch_norm2.bias", "module.block1.nblockLayer.4.batch_norm2.running_mean", "module.block1.nblockLayer.4.batch_norm2.running_var", "module.block1.nblockLayer.4.conv1.weight", "module.block1.nblockLayer.4.conv2.weight", "module.block2.nblockLayer.4.batch_norm1.weight", "module.block2.nblockLayer.4.batch_norm1.bias", "module.block2.nblockLayer.4.batch_norm1.running_mean", "module.block2.nblockLayer.4.batch_norm1.running_var", "module.block2.nblockLayer.4.batch_norm2.weight", "module.block2.nblockLayer.4.batch_norm2.bias", "module.block2.nblockLayer.4.batch_norm2.running_mean", "module.block2.nblockLayer.4.batch_norm2.running_var", "module.block2.nblockLayer.4.conv1.weight", "module.block2.nblockLayer.4.conv2.weight", "module.block3.nblockLayer.4.batch_norm1.weight", "module.block3.nblockLayer.4.batch_norm1.bias", "module.block3.nblockLayer.4.batch_norm1.running_mean", "module.block3.nblockLayer.4.batch_norm1.running_var", "module.block3.nblockLayer.4.batch_norm2.weight", "module.block3.nblockLayer.4.batch_norm2.bias", "module.block3.nblockLayer.4.batch_norm2.running_mean", "module.block3.nblockLayer.4.batch_norm2.running_var", "module.block3.nblockLayer.4.conv1.weight", "module.block3.nblockLayer.4.conv2.weight". 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "./src/generate_features.py", line 405, in <module>
    feature_extractor(args)
  File "./src/generate_features.py", line 200, in feature_extractor
    student.load_state_dict(torch.load(location, map_location = args.device))   
  File "/home/user/tingweijing/env/DIenv/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1223, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.module.conv1.weight", "module.module.block1.nblockLayer.0.batch_norm1.weight", "module.module.block1.nblockLayer.0.batch_norm1.bias", "module.module.block1.nblockLayer.0.batch_norm1.running_mean", "module.module.block1.nblockLayer.0.batch_norm1.running_var", "module.module.block1.nblockLayer.0.batch_norm2.weight", "module.module.block1.nblockLayer.0.batch_norm2.bias", "module.module.block1.nblockLayer.0.batch_norm2.running_mean", "module.module.block1.nblockLayer.0.batch_norm2.running_var", "module.module.block1.nblockLayer.0.conv1.weight", "module.module.block1.nblockLayer.0.conv2.weight", "module.module.block1.nblockLayer.0.conv_inp.weight", "module.module.block1.nblockLayer.1.batch_norm1.weight", "module.module.block1.nblockLayer.1.batch_norm1.bias", "module.module.block1.nblockLayer.1.batch_norm1.running_mean", "module.module.block1.nblockLayer.1.batch_norm1.running_var", "module.module.block1.nblockLayer.1.batch_norm2.weight", "module.module.block1.nblockLayer.1.batch_norm2.bias", "module.module.block1.nblockLayer.1.batch_norm2.running_mean", "module.module.block1.nblockLayer.1.batch_norm2.running_var", "module.module.block1.nblockLayer.1.conv1.weight", "module.module.block1.nblockLayer.1.conv2.weight", "module.module.block1.nblockLayer.2.batch_norm1.weight", "module.module.block1.nblockLayer.2.batch_norm1.bias", "module.module.block1.nblockLayer.2.batch_norm1.running_mean", "module.module.block1.nblockLayer.2.batch_norm1.running_var", "module.module.block1.nblockLayer.2.batch_norm2.weight", "module.module.block1.nblockLayer.2.batch_norm2.bias", "module.module.block1.nblockLayer.2.batch_norm2.running_mean", "module.module.block1.nblockLayer.2.batch_norm2.running_var", "module.module.block1.nblockLayer.2.conv1.weight", "module.module.block1.nblockLayer.2.conv2.weight", "module.module.block1.nblockLayer.3.batch_norm1.weight", "module.module.block1.nblockLayer.3.batch_norm1.bias", "module.module.block1.nblockLayer.3.batch_norm1.running_mean", "module.module.block1.nblockLayer.3.batch_norm1.running_var", "module.module.block1.nblockLayer.3.batch_norm2.weight", "module.module.block1.nblockLayer.3.batch_norm2.bias", "module.module.block1.nblockLayer.3.batch_norm2.running_mean", "module.module.block1.nblockLayer.3.batch_norm2.running_var", "module.module.block1.nblockLayer.3.conv1.weight", "module.module.block1.nblockLayer.3.conv2.weight", "module.module.block1.nblockLayer.4.batch_norm1.weight", "module.module.block1.nblockLayer.4.batch_norm1.bias", "module.module.block1.nblockLayer.4.batch_norm1.running_mean", "module.module.block1.nblockLayer.4.batch_norm1.running_var", "module.module.block1.nblockLayer.4.batch_norm2.weight", "module.module.block1.nblockLayer.4.batch_norm2.bias", "module.module.block1.nblockLayer.4.batch_norm2.running_mean", "module.module.block1.nblockLayer.4.batch_norm2.running_var", "module.module.block1.nblockLayer.4.conv1.weight", "module.module.block1.nblockLayer.4.conv2.weight", "module.module.block2.nblockLayer.0.batch_norm1.weight", "module.module.block2.nblockLayer.0.batch_norm1.bias", "module.module.block2.nblockLayer.0.batch_norm1.running_mean", "module.module.block2.nblockLayer.0.batch_norm1.running_var", "module.module.block2.nblockLayer.0.batch_norm2.weight", "module.module.block2.nblockLayer.0.batch_norm2.bias", "module.module.block2.nblockLayer.0.batch_norm2.running_mean", "module.module.block2.nblockLayer.0.batch_norm2.running_var", "module.module.block2.nblockLayer.0.conv1.weight", "module.module.block2.nblockLayer.0.conv2.weight", "module.module.block2.nblockLayer.0.conv_inp.weight", "module.module.block2.nblockLayer.1.batch_norm1.weight", "module.module.block2.nblockLayer.1.batch_norm1.bias", "module.module.block2.nblockLayer.1.batch_norm1.running_mean", "module.module.block2.nblockLayer.1.batch_norm1.running_var", "module.module.block2.nblockLayer.1.batch_norm2.weight", "module.module.block2.nblockLayer.1.batch_norm2.bias", "module.module.block2.nblockLayer.1.batch_norm2.running_mean", "module.module.block2.nblockLayer.1.batch_norm2.running_var", "module.module.block2.nblockLayer.1.conv1.weight", "module.module.block2.nblockLayer.1.conv2.weight", "module.module.block2.nblockLayer.2.batch_norm1.weight", "module.module.block2.nblockLayer.2.batch_norm1.bias", "module.module.block2.nblockLayer.2.batch_norm1.running_mean", "module.module.block2.nblockLayer.2.batch_norm1.running_var", "module.module.block2.nblockLayer.2.batch_norm2.weight", "module.module.block2.nblockLayer.2.batch_norm2.bias", "module.module.block2.nblockLayer.2.batch_norm2.running_mean", "module.module.block2.nblockLayer.2.batch_norm2.running_var", "module.module.block2.nblockLayer.2.conv1.weight", "module.module.block2.nblockLayer.2.conv2.weight", "module.module.block2.nblockLayer.3.batch_norm1.weight", "module.module.block2.nblockLayer.3.batch_norm1.bias", "module.module.block2.nblockLayer.3.batch_norm1.running_mean", "module.module.block2.nblockLayer.3.batch_norm1.running_var", "module.module.block2.nblockLayer.3.batch_norm2.weight", "module.module.block2.nblockLayer.3.batch_norm2.bias", "module.module.block2.nblockLayer.3.batch_norm2.running_mean", "module.module.block2.nblockLayer.3.batch_norm2.running_var", "module.module.block2.nblockLayer.3.conv1.weight", "module.module.block2.nblockLayer.3.conv2.weight", "module.module.block2.nblockLayer.4.batch_norm1.weight", "module.module.block2.nblockLayer.4.batch_norm1.bias", "module.module.block2.nblockLayer.4.batch_norm1.running_mean", "module.module.block2.nblockLayer.4.batch_norm1.running_var", "module.module.block2.nblockLayer.4.batch_norm2.weight", "module.module.block2.nblockLayer.4.batch_norm2.bias", "module.module.block2.nblockLayer.4.batch_norm2.running_mean", "module.module.block2.nblockLayer.4.batch_norm2.running_var", "module.module.block2.nblockLayer.4.conv1.weight", "module.module.block2.nblockLayer.4.conv2.weight", "module.module.block3.nblockLayer.0.batch_norm1.weight", "module.module.block3.nblockLayer.0.batch_norm1.bias", "module.module.block3.nblockLayer.0.batch_norm1.running_mean", "module.module.block3.nblockLayer.0.batch_norm1.running_var", "module.module.block3.nblockLayer.0.batch_norm2.weight", "module.module.block3.nblockLayer.0.batch_norm2.bias", "module.module.block3.nblockLayer.0.batch_norm2.running_mean", "module.module.block3.nblockLayer.0.batch_norm2.running_var", "module.module.block3.nblockLayer.0.conv1.weight", "module.module.block3.nblockLayer.0.conv2.weight", "module.module.block3.nblockLayer.0.conv_inp.weight", "module.module.block3.nblockLayer.1.batch_norm1.weight", "module.module.block3.nblockLayer.1.batch_norm1.bias", "module.module.block3.nblockLayer.1.batch_norm1.running_mean", "module.module.block3.nblockLayer.1.batch_norm1.running_var", "module.module.block3.nblockLayer.1.batch_norm2.weight", "module.module.block3.nblockLayer.1.batch_norm2.bias", "module.module.block3.nblockLayer.1.batch_norm2.running_mean", "module.module.block3.nblockLayer.1.batch_norm2.running_var", "module.module.block3.nblockLayer.1.conv1.weight", "module.module.block3.nblockLayer.1.conv2.weight", "module.module.block3.nblockLayer.2.batch_norm1.weight", "module.module.block3.nblockLayer.2.batch_norm1.bias", "module.module.block3.nblockLayer.2.batch_norm1.running_mean", "module.module.block3.nblockLayer.2.batch_norm1.running_var", "module.module.block3.nblockLayer.2.batch_norm2.weight", "module.module.block3.nblockLayer.2.batch_norm2.bias", "module.module.block3.nblockLayer.2.batch_norm2.running_mean", "module.module.block3.nblockLayer.2.batch_norm2.running_var", "module.module.block3.nblockLayer.2.conv1.weight", "module.module.block3.nblockLayer.2.conv2.weight", "module.module.block3.nblockLayer.3.batch_norm1.weight", "module.module.block3.nblockLayer.3.batch_norm1.bias", "module.module.block3.nblockLayer.3.batch_norm1.running_mean", "module.module.block3.nblockLayer.3.batch_norm1.running_var", "module.module.block3.nblockLayer.3.batch_norm2.weight", "module.module.block3.nblockLayer.3.batch_norm2.bias", "module.module.block3.nblockLayer.3.batch_norm2.running_mean", "module.module.block3.nblockLayer.3.batch_norm2.running_var", "module.module.block3.nblockLayer.3.conv1.weight", "module.module.block3.nblockLayer.3.conv2.weight", "module.module.block3.nblockLayer.4.batch_norm1.weight", "module.module.block3.nblockLayer.4.batch_norm1.bias", "module.module.block3.nblockLayer.4.batch_norm1.running_mean", "module.module.block3.nblockLayer.4.batch_norm1.running_var", "module.module.block3.nblockLayer.4.batch_norm2.weight", "module.module.block3.nblockLayer.4.batch_norm2.bias", "module.module.block3.nblockLayer.4.batch_norm2.running_mean", "module.module.block3.nblockLayer.4.batch_norm2.running_var", "module.module.block3.nblockLayer.4.conv1.weight", "module.module.block3.nblockLayer.4.conv2.weight", "module.module.batch_norm.weight", "module.module.batch_norm.bias", "module.module.batch_norm.running_mean", "module.module.batch_norm.running_var", "module.module.fc.weight", "module.module.fc.bias". 
	Unexpected key(s) in state_dict: "module.conv1.weight", "module.block1.nblockLayer.0.batch_norm1.weight", "module.block1.nblockLayer.0.batch_norm1.bias", "module.block1.nblockLayer.0.batch_norm1.running_mean", "module.block1.nblockLayer.0.batch_norm1.running_var", "module.block1.nblockLayer.0.batch_norm1.num_batches_tracked", "module.block1.nblockLayer.0.batch_norm2.weight", "module.block1.nblockLayer.0.batch_norm2.bias", "module.block1.nblockLayer.0.batch_norm2.running_mean", "module.block1.nblockLayer.0.batch_norm2.running_var", "module.block1.nblockLayer.0.batch_norm2.num_batches_tracked", "module.block1.nblockLayer.0.conv1.weight", "module.block1.nblockLayer.0.conv2.weight", "module.block1.nblockLayer.0.conv_inp.weight", "module.block1.nblockLayer.1.batch_norm1.weight", "module.block1.nblockLayer.1.batch_norm1.bias", "module.block1.nblockLayer.1.batch_norm1.running_mean", "module.block1.nblockLayer.1.batch_norm1.running_var", "module.block1.nblockLayer.1.batch_norm1.num_batches_tracked", "module.block1.nblockLayer.1.batch_norm2.weight", "module.block1.nblockLayer.1.batch_norm2.bias", "module.block1.nblockLayer.1.batch_norm2.running_mean", "module.block1.nblockLayer.1.batch_norm2.running_var", "module.block1.nblockLayer.1.batch_norm2.num_batches_tracked", "module.block1.nblockLayer.1.conv1.weight", "module.block1.nblockLayer.1.conv2.weight", "module.block1.nblockLayer.2.batch_norm1.weight", "module.block1.nblockLayer.2.batch_norm1.bias", "module.block1.nblockLayer.2.batch_norm1.running_mean", "module.block1.nblockLayer.2.batch_norm1.running_var", "module.block1.nblockLayer.2.batch_norm1.num_batches_tracked", "module.block1.nblockLayer.2.batch_norm2.weight", "module.block1.nblockLayer.2.batch_norm2.bias", "module.block1.nblockLayer.2.batch_norm2.running_mean", "module.block1.nblockLayer.2.batch_norm2.running_var", "module.block1.nblockLayer.2.batch_norm2.num_batches_tracked", "module.block1.nblockLayer.2.conv1.weight", "module.block1.nblockLayer.2.conv2.weight", "module.block1.nblockLayer.3.batch_norm1.weight", "module.block1.nblockLayer.3.batch_norm1.bias", "module.block1.nblockLayer.3.batch_norm1.running_mean", "module.block1.nblockLayer.3.batch_norm1.running_var", "module.block1.nblockLayer.3.batch_norm1.num_batches_tracked", "module.block1.nblockLayer.3.batch_norm2.weight", "module.block1.nblockLayer.3.batch_norm2.bias", "module.block1.nblockLayer.3.batch_norm2.running_mean", "module.block1.nblockLayer.3.batch_norm2.running_var", "module.block1.nblockLayer.3.batch_norm2.num_batches_tracked", "module.block1.nblockLayer.3.conv1.weight", "module.block1.nblockLayer.3.conv2.weight", "module.block2.nblockLayer.0.batch_norm1.weight", "module.block2.nblockLayer.0.batch_norm1.bias", "module.block2.nblockLayer.0.batch_norm1.running_mean", "module.block2.nblockLayer.0.batch_norm1.running_var", "module.block2.nblockLayer.0.batch_norm1.num_batches_tracked", "module.block2.nblockLayer.0.batch_norm2.weight", "module.block2.nblockLayer.0.batch_norm2.bias", "module.block2.nblockLayer.0.batch_norm2.running_mean", "module.block2.nblockLayer.0.batch_norm2.running_var", "module.block2.nblockLayer.0.batch_norm2.num_batches_tracked", "module.block2.nblockLayer.0.conv1.weight", "module.block2.nblockLayer.0.conv2.weight", "module.block2.nblockLayer.0.conv_inp.weight", "module.block2.nblockLayer.1.batch_norm1.weight", "module.block2.nblockLayer.1.batch_norm1.bias", "module.block2.nblockLayer.1.batch_norm1.running_mean", "module.block2.nblockLayer.1.batch_norm1.running_var", "module.block2.nblockLayer.1.batch_norm1.num_batches_tracked", "module.block2.nblockLayer.1.batch_norm2.weight", "module.block2.nblockLayer.1.batch_norm2.bias", "module.block2.nblockLayer.1.batch_norm2.running_mean", "module.block2.nblockLayer.1.batch_norm2.running_var", "module.block2.nblockLayer.1.batch_norm2.num_batches_tracked", "module.block2.nblockLayer.1.conv1.weight", "module.block2.nblockLayer.1.conv2.weight", "module.block2.nblockLayer.2.batch_norm1.weight", "module.block2.nblockLayer.2.batch_norm1.bias", "module.block2.nblockLayer.2.batch_norm1.running_mean", "module.block2.nblockLayer.2.batch_norm1.running_var", "module.block2.nblockLayer.2.batch_norm1.num_batches_tracked", "module.block2.nblockLayer.2.batch_norm2.weight", "module.block2.nblockLayer.2.batch_norm2.bias", "module.block2.nblockLayer.2.batch_norm2.running_mean", "module.block2.nblockLayer.2.batch_norm2.running_var", "module.block2.nblockLayer.2.batch_norm2.num_batches_tracked", "module.block2.nblockLayer.2.conv1.weight", "module.block2.nblockLayer.2.conv2.weight", "module.block2.nblockLayer.3.batch_norm1.weight", "module.block2.nblockLayer.3.batch_norm1.bias", "module.block2.nblockLayer.3.batch_norm1.running_mean", "module.block2.nblockLayer.3.batch_norm1.running_var", "module.block2.nblockLayer.3.batch_norm1.num_batches_tracked", "module.block2.nblockLayer.3.batch_norm2.weight", "module.block2.nblockLayer.3.batch_norm2.bias", "module.block2.nblockLayer.3.batch_norm2.running_mean", "module.block2.nblockLayer.3.batch_norm2.running_var", "module.block2.nblockLayer.3.batch_norm2.num_batches_tracked", "module.block2.nblockLayer.3.conv1.weight", "module.block2.nblockLayer.3.conv2.weight", "module.block3.nblockLayer.0.batch_norm1.weight", "module.block3.nblockLayer.0.batch_norm1.bias", "module.block3.nblockLayer.0.batch_norm1.running_mean", "module.block3.nblockLayer.0.batch_norm1.running_var", "module.block3.nblockLayer.0.batch_norm1.num_batches_tracked", "module.block3.nblockLayer.0.batch_norm2.weight", "module.block3.nblockLayer.0.batch_norm2.bias", "module.block3.nblockLayer.0.batch_norm2.running_mean", "module.block3.nblockLayer.0.batch_norm2.running_var", "module.block3.nblockLayer.0.batch_norm2.num_batches_tracked", "module.block3.nblockLayer.0.conv1.weight", "module.block3.nblockLayer.0.conv2.weight", "module.block3.nblockLayer.0.conv_inp.weight", "module.block3.nblockLayer.1.batch_norm1.weight", "module.block3.nblockLayer.1.batch_norm1.bias", "module.block3.nblockLayer.1.batch_norm1.running_mean", "module.block3.nblockLayer.1.batch_norm1.running_var", "module.block3.nblockLayer.1.batch_norm1.num_batches_tracked", "module.block3.nblockLayer.1.batch_norm2.weight", "module.block3.nblockLayer.1.batch_norm2.bias", "module.block3.nblockLayer.1.batch_norm2.running_mean", "module.block3.nblockLayer.1.batch_norm2.running_var", "module.block3.nblockLayer.1.batch_norm2.num_batches_tracked", "module.block3.nblockLayer.1.conv1.weight", "module.block3.nblockLayer.1.conv2.weight", "module.block3.nblockLayer.2.batch_norm1.weight", "module.block3.nblockLayer.2.batch_norm1.bias", "module.block3.nblockLayer.2.batch_norm1.running_mean", "module.block3.nblockLayer.2.batch_norm1.running_var", "module.block3.nblockLayer.2.batch_norm1.num_batches_tracked", "module.block3.nblockLayer.2.batch_norm2.weight", "module.block3.nblockLayer.2.batch_norm2.bias", "module.block3.nblockLayer.2.batch_norm2.running_mean", "module.block3.nblockLayer.2.batch_norm2.running_var", "module.block3.nblockLayer.2.batch_norm2.num_batches_tracked", "module.block3.nblockLayer.2.conv1.weight", "module.block3.nblockLayer.2.conv2.weight", "module.block3.nblockLayer.3.batch_norm1.weight", "module.block3.nblockLayer.3.batch_norm1.bias", "module.block3.nblockLayer.3.batch_norm1.running_mean", "module.block3.nblockLayer.3.batch_norm1.running_var", "module.block3.nblockLayer.3.batch_norm1.num_batches_tracked", "module.block3.nblockLayer.3.batch_norm2.weight", "module.block3.nblockLayer.3.batch_norm2.bias", "module.block3.nblockLayer.3.batch_norm2.running_mean", "module.block3.nblockLayer.3.batch_norm2.running_var", "module.block3.nblockLayer.3.batch_norm2.num_batches_tracked", "module.block3.nblockLayer.3.conv1.weight", "module.block3.nblockLayer.3.conv2.weight", "module.batch_norm.weight", "module.batch_norm.bias", "module.batch_norm.running_mean", "module.batch_norm.running_var", "module.batch_norm.num_batches_tracked", "module.fc.weight", "module.fc.bias". 
# Batch size 1000, Train accuracy 75
Namespace(alpha_l_1=1.0, alpha_l_2=0.01, alpha_l_inf=0.001, batch_size=500, combine_ratio=0.5, concat=0, concat_factor=1.0, config_file=None, data_path=None, dataset='CIFAR10', device='cuda:0', distance=None, dropRate=0.0, epochs=50, epsilon_l_1=12, epsilon_l_2=0.5, epsilon_l_inf=0.03137254901960784, experiment='3-var', feature_type='rand', gap=0.001, gpu_id=0, imagenet_architecture='wrn', k=100, lr_max=0.1, lr_min=0.0, lr_mode=1, mode='teacher', model_dataset='CIFAR10', model_id='teacher_normalized', model_type='wrn-28-10', noise_sigma=0.05, normalize=1, num_iter=500, opt_type='SGD', path=None, pseudo_labels=0, randomize=0, regressor_embed=0, restarts=1, resume=0, resume_iter=-1, reverse_train_test=0, seed=0, smallest_adv=1, target_batch_size=1000, target_epoch=0, target_te_acc=0, target_tr_acc=75)
Model Directory: ./models/CIFAR10/model_teacher_normalized_1000
File Directory: ./files/CIFAR10_1000/model_teacher_normalized_tr_acc_75
cuda:0
22-10-07 18:01
No Transform
Files already downloaded and verified
Files already downloaded and verified
No Transform
Files already downloaded and verified
Files already downloaded and verified
Loading model from ./models/CIFAR10/model_teacher_normalized_1000/tr_acc_75.pt
Traceback (most recent call last):
  File "./src/generate_features.py", line 197, in feature_extractor
    student.load_state_dict(torch.load(location, map_location = args.device)) 
  File "/home/user/tingweijing/env/DIenv/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1223, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.block1.nblockLayer.4.batch_norm1.weight", "module.block1.nblockLayer.4.batch_norm1.bias", "module.block1.nblockLayer.4.batch_norm1.running_mean", "module.block1.nblockLayer.4.batch_norm1.running_var", "module.block1.nblockLayer.4.batch_norm2.weight", "module.block1.nblockLayer.4.batch_norm2.bias", "module.block1.nblockLayer.4.batch_norm2.running_mean", "module.block1.nblockLayer.4.batch_norm2.running_var", "module.block1.nblockLayer.4.conv1.weight", "module.block1.nblockLayer.4.conv2.weight", "module.block2.nblockLayer.4.batch_norm1.weight", "module.block2.nblockLayer.4.batch_norm1.bias", "module.block2.nblockLayer.4.batch_norm1.running_mean", "module.block2.nblockLayer.4.batch_norm1.running_var", "module.block2.nblockLayer.4.batch_norm2.weight", "module.block2.nblockLayer.4.batch_norm2.bias", "module.block2.nblockLayer.4.batch_norm2.running_mean", "module.block2.nblockLayer.4.batch_norm2.running_var", "module.block2.nblockLayer.4.conv1.weight", "module.block2.nblockLayer.4.conv2.weight", "module.block3.nblockLayer.4.batch_norm1.weight", "module.block3.nblockLayer.4.batch_norm1.bias", "module.block3.nblockLayer.4.batch_norm1.running_mean", "module.block3.nblockLayer.4.batch_norm1.running_var", "module.block3.nblockLayer.4.batch_norm2.weight", "module.block3.nblockLayer.4.batch_norm2.bias", "module.block3.nblockLayer.4.batch_norm2.running_mean", "module.block3.nblockLayer.4.batch_norm2.running_var", "module.block3.nblockLayer.4.conv1.weight", "module.block3.nblockLayer.4.conv2.weight". 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "./src/generate_features.py", line 405, in <module>
    feature_extractor(args)
  File "./src/generate_features.py", line 200, in feature_extractor
    student.load_state_dict(torch.load(location, map_location = args.device))   
  File "/home/user/tingweijing/env/DIenv/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1223, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.module.conv1.weight", "module.module.block1.nblockLayer.0.batch_norm1.weight", "module.module.block1.nblockLayer.0.batch_norm1.bias", "module.module.block1.nblockLayer.0.batch_norm1.running_mean", "module.module.block1.nblockLayer.0.batch_norm1.running_var", "module.module.block1.nblockLayer.0.batch_norm2.weight", "module.module.block1.nblockLayer.0.batch_norm2.bias", "module.module.block1.nblockLayer.0.batch_norm2.running_mean", "module.module.block1.nblockLayer.0.batch_norm2.running_var", "module.module.block1.nblockLayer.0.conv1.weight", "module.module.block1.nblockLayer.0.conv2.weight", "module.module.block1.nblockLayer.0.conv_inp.weight", "module.module.block1.nblockLayer.1.batch_norm1.weight", "module.module.block1.nblockLayer.1.batch_norm1.bias", "module.module.block1.nblockLayer.1.batch_norm1.running_mean", "module.module.block1.nblockLayer.1.batch_norm1.running_var", "module.module.block1.nblockLayer.1.batch_norm2.weight", "module.module.block1.nblockLayer.1.batch_norm2.bias", "module.module.block1.nblockLayer.1.batch_norm2.running_mean", "module.module.block1.nblockLayer.1.batch_norm2.running_var", "module.module.block1.nblockLayer.1.conv1.weight", "module.module.block1.nblockLayer.1.conv2.weight", "module.module.block1.nblockLayer.2.batch_norm1.weight", "module.module.block1.nblockLayer.2.batch_norm1.bias", "module.module.block1.nblockLayer.2.batch_norm1.running_mean", "module.module.block1.nblockLayer.2.batch_norm1.running_var", "module.module.block1.nblockLayer.2.batch_norm2.weight", "module.module.block1.nblockLayer.2.batch_norm2.bias", "module.module.block1.nblockLayer.2.batch_norm2.running_mean", "module.module.block1.nblockLayer.2.batch_norm2.running_var", "module.module.block1.nblockLayer.2.conv1.weight", "module.module.block1.nblockLayer.2.conv2.weight", "module.module.block1.nblockLayer.3.batch_norm1.weight", "module.module.block1.nblockLayer.3.batch_norm1.bias", "module.module.block1.nblockLayer.3.batch_norm1.running_mean", "module.module.block1.nblockLayer.3.batch_norm1.running_var", "module.module.block1.nblockLayer.3.batch_norm2.weight", "module.module.block1.nblockLayer.3.batch_norm2.bias", "module.module.block1.nblockLayer.3.batch_norm2.running_mean", "module.module.block1.nblockLayer.3.batch_norm2.running_var", "module.module.block1.nblockLayer.3.conv1.weight", "module.module.block1.nblockLayer.3.conv2.weight", "module.module.block1.nblockLayer.4.batch_norm1.weight", "module.module.block1.nblockLayer.4.batch_norm1.bias", "module.module.block1.nblockLayer.4.batch_norm1.running_mean", "module.module.block1.nblockLayer.4.batch_norm1.running_var", "module.module.block1.nblockLayer.4.batch_norm2.weight", "module.module.block1.nblockLayer.4.batch_norm2.bias", "module.module.block1.nblockLayer.4.batch_norm2.running_mean", "module.module.block1.nblockLayer.4.batch_norm2.running_var", "module.module.block1.nblockLayer.4.conv1.weight", "module.module.block1.nblockLayer.4.conv2.weight", "module.module.block2.nblockLayer.0.batch_norm1.weight", "module.module.block2.nblockLayer.0.batch_norm1.bias", "module.module.block2.nblockLayer.0.batch_norm1.running_mean", "module.module.block2.nblockLayer.0.batch_norm1.running_var", "module.module.block2.nblockLayer.0.batch_norm2.weight", "module.module.block2.nblockLayer.0.batch_norm2.bias", "module.module.block2.nblockLayer.0.batch_norm2.running_mean", "module.module.block2.nblockLayer.0.batch_norm2.running_var", "module.module.block2.nblockLayer.0.conv1.weight", "module.module.block2.nblockLayer.0.conv2.weight", "module.module.block2.nblockLayer.0.conv_inp.weight", "module.module.block2.nblockLayer.1.batch_norm1.weight", "module.module.block2.nblockLayer.1.batch_norm1.bias", "module.module.block2.nblockLayer.1.batch_norm1.running_mean", "module.module.block2.nblockLayer.1.batch_norm1.running_var", "module.module.block2.nblockLayer.1.batch_norm2.weight", "module.module.block2.nblockLayer.1.batch_norm2.bias", "module.module.block2.nblockLayer.1.batch_norm2.running_mean", "module.module.block2.nblockLayer.1.batch_norm2.running_var", "module.module.block2.nblockLayer.1.conv1.weight", "module.module.block2.nblockLayer.1.conv2.weight", "module.module.block2.nblockLayer.2.batch_norm1.weight", "module.module.block2.nblockLayer.2.batch_norm1.bias", "module.module.block2.nblockLayer.2.batch_norm1.running_mean", "module.module.block2.nblockLayer.2.batch_norm1.running_var", "module.module.block2.nblockLayer.2.batch_norm2.weight", "module.module.block2.nblockLayer.2.batch_norm2.bias", "module.module.block2.nblockLayer.2.batch_norm2.running_mean", "module.module.block2.nblockLayer.2.batch_norm2.running_var", "module.module.block2.nblockLayer.2.conv1.weight", "module.module.block2.nblockLayer.2.conv2.weight", "module.module.block2.nblockLayer.3.batch_norm1.weight", "module.module.block2.nblockLayer.3.batch_norm1.bias", "module.module.block2.nblockLayer.3.batch_norm1.running_mean", "module.module.block2.nblockLayer.3.batch_norm1.running_var", "module.module.block2.nblockLayer.3.batch_norm2.weight", "module.module.block2.nblockLayer.3.batch_norm2.bias", "module.module.block2.nblockLayer.3.batch_norm2.running_mean", "module.module.block2.nblockLayer.3.batch_norm2.running_var", "module.module.block2.nblockLayer.3.conv1.weight", "module.module.block2.nblockLayer.3.conv2.weight", "module.module.block2.nblockLayer.4.batch_norm1.weight", "module.module.block2.nblockLayer.4.batch_norm1.bias", "module.module.block2.nblockLayer.4.batch_norm1.running_mean", "module.module.block2.nblockLayer.4.batch_norm1.running_var", "module.module.block2.nblockLayer.4.batch_norm2.weight", "module.module.block2.nblockLayer.4.batch_norm2.bias", "module.module.block2.nblockLayer.4.batch_norm2.running_mean", "module.module.block2.nblockLayer.4.batch_norm2.running_var", "module.module.block2.nblockLayer.4.conv1.weight", "module.module.block2.nblockLayer.4.conv2.weight", "module.module.block3.nblockLayer.0.batch_norm1.weight", "module.module.block3.nblockLayer.0.batch_norm1.bias", "module.module.block3.nblockLayer.0.batch_norm1.running_mean", "module.module.block3.nblockLayer.0.batch_norm1.running_var", "module.module.block3.nblockLayer.0.batch_norm2.weight", "module.module.block3.nblockLayer.0.batch_norm2.bias", "module.module.block3.nblockLayer.0.batch_norm2.running_mean", "module.module.block3.nblockLayer.0.batch_norm2.running_var", "module.module.block3.nblockLayer.0.conv1.weight", "module.module.block3.nblockLayer.0.conv2.weight", "module.module.block3.nblockLayer.0.conv_inp.weight", "module.module.block3.nblockLayer.1.batch_norm1.weight", "module.module.block3.nblockLayer.1.batch_norm1.bias", "module.module.block3.nblockLayer.1.batch_norm1.running_mean", "module.module.block3.nblockLayer.1.batch_norm1.running_var", "module.module.block3.nblockLayer.1.batch_norm2.weight", "module.module.block3.nblockLayer.1.batch_norm2.bias", "module.module.block3.nblockLayer.1.batch_norm2.running_mean", "module.module.block3.nblockLayer.1.batch_norm2.running_var", "module.module.block3.nblockLayer.1.conv1.weight", "module.module.block3.nblockLayer.1.conv2.weight", "module.module.block3.nblockLayer.2.batch_norm1.weight", "module.module.block3.nblockLayer.2.batch_norm1.bias", "module.module.block3.nblockLayer.2.batch_norm1.running_mean", "module.module.block3.nblockLayer.2.batch_norm1.running_var", "module.module.block3.nblockLayer.2.batch_norm2.weight", "module.module.block3.nblockLayer.2.batch_norm2.bias", "module.module.block3.nblockLayer.2.batch_norm2.running_mean", "module.module.block3.nblockLayer.2.batch_norm2.running_var", "module.module.block3.nblockLayer.2.conv1.weight", "module.module.block3.nblockLayer.2.conv2.weight", "module.module.block3.nblockLayer.3.batch_norm1.weight", "module.module.block3.nblockLayer.3.batch_norm1.bias", "module.module.block3.nblockLayer.3.batch_norm1.running_mean", "module.module.block3.nblockLayer.3.batch_norm1.running_var", "module.module.block3.nblockLayer.3.batch_norm2.weight", "module.module.block3.nblockLayer.3.batch_norm2.bias", "module.module.block3.nblockLayer.3.batch_norm2.running_mean", "module.module.block3.nblockLayer.3.batch_norm2.running_var", "module.module.block3.nblockLayer.3.conv1.weight", "module.module.block3.nblockLayer.3.conv2.weight", "module.module.block3.nblockLayer.4.batch_norm1.weight", "module.module.block3.nblockLayer.4.batch_norm1.bias", "module.module.block3.nblockLayer.4.batch_norm1.running_mean", "module.module.block3.nblockLayer.4.batch_norm1.running_var", "module.module.block3.nblockLayer.4.batch_norm2.weight", "module.module.block3.nblockLayer.4.batch_norm2.bias", "module.module.block3.nblockLayer.4.batch_norm2.running_mean", "module.module.block3.nblockLayer.4.batch_norm2.running_var", "module.module.block3.nblockLayer.4.conv1.weight", "module.module.block3.nblockLayer.4.conv2.weight", "module.module.batch_norm.weight", "module.module.batch_norm.bias", "module.module.batch_norm.running_mean", "module.module.batch_norm.running_var", "module.module.fc.weight", "module.module.fc.bias". 
	Unexpected key(s) in state_dict: "module.conv1.weight", "module.block1.nblockLayer.0.batch_norm1.weight", "module.block1.nblockLayer.0.batch_norm1.bias", "module.block1.nblockLayer.0.batch_norm1.running_mean", "module.block1.nblockLayer.0.batch_norm1.running_var", "module.block1.nblockLayer.0.batch_norm1.num_batches_tracked", "module.block1.nblockLayer.0.batch_norm2.weight", "module.block1.nblockLayer.0.batch_norm2.bias", "module.block1.nblockLayer.0.batch_norm2.running_mean", "module.block1.nblockLayer.0.batch_norm2.running_var", "module.block1.nblockLayer.0.batch_norm2.num_batches_tracked", "module.block1.nblockLayer.0.conv1.weight", "module.block1.nblockLayer.0.conv2.weight", "module.block1.nblockLayer.0.conv_inp.weight", "module.block1.nblockLayer.1.batch_norm1.weight", "module.block1.nblockLayer.1.batch_norm1.bias", "module.block1.nblockLayer.1.batch_norm1.running_mean", "module.block1.nblockLayer.1.batch_norm1.running_var", "module.block1.nblockLayer.1.batch_norm1.num_batches_tracked", "module.block1.nblockLayer.1.batch_norm2.weight", "module.block1.nblockLayer.1.batch_norm2.bias", "module.block1.nblockLayer.1.batch_norm2.running_mean", "module.block1.nblockLayer.1.batch_norm2.running_var", "module.block1.nblockLayer.1.batch_norm2.num_batches_tracked", "module.block1.nblockLayer.1.conv1.weight", "module.block1.nblockLayer.1.conv2.weight", "module.block1.nblockLayer.2.batch_norm1.weight", "module.block1.nblockLayer.2.batch_norm1.bias", "module.block1.nblockLayer.2.batch_norm1.running_mean", "module.block1.nblockLayer.2.batch_norm1.running_var", "module.block1.nblockLayer.2.batch_norm1.num_batches_tracked", "module.block1.nblockLayer.2.batch_norm2.weight", "module.block1.nblockLayer.2.batch_norm2.bias", "module.block1.nblockLayer.2.batch_norm2.running_mean", "module.block1.nblockLayer.2.batch_norm2.running_var", "module.block1.nblockLayer.2.batch_norm2.num_batches_tracked", "module.block1.nblockLayer.2.conv1.weight", "module.block1.nblockLayer.2.conv2.weight", "module.block1.nblockLayer.3.batch_norm1.weight", "module.block1.nblockLayer.3.batch_norm1.bias", "module.block1.nblockLayer.3.batch_norm1.running_mean", "module.block1.nblockLayer.3.batch_norm1.running_var", "module.block1.nblockLayer.3.batch_norm1.num_batches_tracked", "module.block1.nblockLayer.3.batch_norm2.weight", "module.block1.nblockLayer.3.batch_norm2.bias", "module.block1.nblockLayer.3.batch_norm2.running_mean", "module.block1.nblockLayer.3.batch_norm2.running_var", "module.block1.nblockLayer.3.batch_norm2.num_batches_tracked", "module.block1.nblockLayer.3.conv1.weight", "module.block1.nblockLayer.3.conv2.weight", "module.block2.nblockLayer.0.batch_norm1.weight", "module.block2.nblockLayer.0.batch_norm1.bias", "module.block2.nblockLayer.0.batch_norm1.running_mean", "module.block2.nblockLayer.0.batch_norm1.running_var", "module.block2.nblockLayer.0.batch_norm1.num_batches_tracked", "module.block2.nblockLayer.0.batch_norm2.weight", "module.block2.nblockLayer.0.batch_norm2.bias", "module.block2.nblockLayer.0.batch_norm2.running_mean", "module.block2.nblockLayer.0.batch_norm2.running_var", "module.block2.nblockLayer.0.batch_norm2.num_batches_tracked", "module.block2.nblockLayer.0.conv1.weight", "module.block2.nblockLayer.0.conv2.weight", "module.block2.nblockLayer.0.conv_inp.weight", "module.block2.nblockLayer.1.batch_norm1.weight", "module.block2.nblockLayer.1.batch_norm1.bias", "module.block2.nblockLayer.1.batch_norm1.running_mean", "module.block2.nblockLayer.1.batch_norm1.running_var", "module.block2.nblockLayer.1.batch_norm1.num_batches_tracked", "module.block2.nblockLayer.1.batch_norm2.weight", "module.block2.nblockLayer.1.batch_norm2.bias", "module.block2.nblockLayer.1.batch_norm2.running_mean", "module.block2.nblockLayer.1.batch_norm2.running_var", "module.block2.nblockLayer.1.batch_norm2.num_batches_tracked", "module.block2.nblockLayer.1.conv1.weight", "module.block2.nblockLayer.1.conv2.weight", "module.block2.nblockLayer.2.batch_norm1.weight", "module.block2.nblockLayer.2.batch_norm1.bias", "module.block2.nblockLayer.2.batch_norm1.running_mean", "module.block2.nblockLayer.2.batch_norm1.running_var", "module.block2.nblockLayer.2.batch_norm1.num_batches_tracked", "module.block2.nblockLayer.2.batch_norm2.weight", "module.block2.nblockLayer.2.batch_norm2.bias", "module.block2.nblockLayer.2.batch_norm2.running_mean", "module.block2.nblockLayer.2.batch_norm2.running_var", "module.block2.nblockLayer.2.batch_norm2.num_batches_tracked", "module.block2.nblockLayer.2.conv1.weight", "module.block2.nblockLayer.2.conv2.weight", "module.block2.nblockLayer.3.batch_norm1.weight", "module.block2.nblockLayer.3.batch_norm1.bias", "module.block2.nblockLayer.3.batch_norm1.running_mean", "module.block2.nblockLayer.3.batch_norm1.running_var", "module.block2.nblockLayer.3.batch_norm1.num_batches_tracked", "module.block2.nblockLayer.3.batch_norm2.weight", "module.block2.nblockLayer.3.batch_norm2.bias", "module.block2.nblockLayer.3.batch_norm2.running_mean", "module.block2.nblockLayer.3.batch_norm2.running_var", "module.block2.nblockLayer.3.batch_norm2.num_batches_tracked", "module.block2.nblockLayer.3.conv1.weight", "module.block2.nblockLayer.3.conv2.weight", "module.block3.nblockLayer.0.batch_norm1.weight", "module.block3.nblockLayer.0.batch_norm1.bias", "module.block3.nblockLayer.0.batch_norm1.running_mean", "module.block3.nblockLayer.0.batch_norm1.running_var", "module.block3.nblockLayer.0.batch_norm1.num_batches_tracked", "module.block3.nblockLayer.0.batch_norm2.weight", "module.block3.nblockLayer.0.batch_norm2.bias", "module.block3.nblockLayer.0.batch_norm2.running_mean", "module.block3.nblockLayer.0.batch_norm2.running_var", "module.block3.nblockLayer.0.batch_norm2.num_batches_tracked", "module.block3.nblockLayer.0.conv1.weight", "module.block3.nblockLayer.0.conv2.weight", "module.block3.nblockLayer.0.conv_inp.weight", "module.block3.nblockLayer.1.batch_norm1.weight", "module.block3.nblockLayer.1.batch_norm1.bias", "module.block3.nblockLayer.1.batch_norm1.running_mean", "module.block3.nblockLayer.1.batch_norm1.running_var", "module.block3.nblockLayer.1.batch_norm1.num_batches_tracked", "module.block3.nblockLayer.1.batch_norm2.weight", "module.block3.nblockLayer.1.batch_norm2.bias", "module.block3.nblockLayer.1.batch_norm2.running_mean", "module.block3.nblockLayer.1.batch_norm2.running_var", "module.block3.nblockLayer.1.batch_norm2.num_batches_tracked", "module.block3.nblockLayer.1.conv1.weight", "module.block3.nblockLayer.1.conv2.weight", "module.block3.nblockLayer.2.batch_norm1.weight", "module.block3.nblockLayer.2.batch_norm1.bias", "module.block3.nblockLayer.2.batch_norm1.running_mean", "module.block3.nblockLayer.2.batch_norm1.running_var", "module.block3.nblockLayer.2.batch_norm1.num_batches_tracked", "module.block3.nblockLayer.2.batch_norm2.weight", "module.block3.nblockLayer.2.batch_norm2.bias", "module.block3.nblockLayer.2.batch_norm2.running_mean", "module.block3.nblockLayer.2.batch_norm2.running_var", "module.block3.nblockLayer.2.batch_norm2.num_batches_tracked", "module.block3.nblockLayer.2.conv1.weight", "module.block3.nblockLayer.2.conv2.weight", "module.block3.nblockLayer.3.batch_norm1.weight", "module.block3.nblockLayer.3.batch_norm1.bias", "module.block3.nblockLayer.3.batch_norm1.running_mean", "module.block3.nblockLayer.3.batch_norm1.running_var", "module.block3.nblockLayer.3.batch_norm1.num_batches_tracked", "module.block3.nblockLayer.3.batch_norm2.weight", "module.block3.nblockLayer.3.batch_norm2.bias", "module.block3.nblockLayer.3.batch_norm2.running_mean", "module.block3.nblockLayer.3.batch_norm2.running_var", "module.block3.nblockLayer.3.batch_norm2.num_batches_tracked", "module.block3.nblockLayer.3.conv1.weight", "module.block3.nblockLayer.3.conv2.weight", "module.batch_norm.weight", "module.batch_norm.bias", "module.batch_norm.running_mean", "module.batch_norm.running_var", "module.batch_norm.num_batches_tracked", "module.fc.weight", "module.fc.bias". 
# Batch size 1000, Train accuracy 80
Namespace(alpha_l_1=1.0, alpha_l_2=0.01, alpha_l_inf=0.001, batch_size=500, combine_ratio=0.5, concat=0, concat_factor=1.0, config_file=None, data_path=None, dataset='CIFAR10', device='cuda:0', distance=None, dropRate=0.0, epochs=50, epsilon_l_1=12, epsilon_l_2=0.5, epsilon_l_inf=0.03137254901960784, experiment='3-var', feature_type='rand', gap=0.001, gpu_id=0, imagenet_architecture='wrn', k=100, lr_max=0.1, lr_min=0.0, lr_mode=1, mode='teacher', model_dataset='CIFAR10', model_id='teacher_normalized', model_type='wrn-28-10', noise_sigma=0.05, normalize=1, num_iter=500, opt_type='SGD', path=None, pseudo_labels=0, randomize=0, regressor_embed=0, restarts=1, resume=0, resume_iter=-1, reverse_train_test=0, seed=0, smallest_adv=1, target_batch_size=1000, target_epoch=0, target_te_acc=0, target_tr_acc=80)
Model Directory: ./models/CIFAR10/model_teacher_normalized_1000
File Directory: ./files/CIFAR10_1000/model_teacher_normalized_tr_acc_80
cuda:0
22-10-07 18:01
No Transform
Files already downloaded and verified
Files already downloaded and verified
No Transform
Files already downloaded and verified
Files already downloaded and verified
Loading model from ./models/CIFAR10/model_teacher_normalized_1000/tr_acc_80.pt
Traceback (most recent call last):
  File "./src/generate_features.py", line 197, in feature_extractor
    student.load_state_dict(torch.load(location, map_location = args.device)) 
  File "/home/user/tingweijing/env/DIenv/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1223, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.block1.nblockLayer.4.batch_norm1.weight", "module.block1.nblockLayer.4.batch_norm1.bias", "module.block1.nblockLayer.4.batch_norm1.running_mean", "module.block1.nblockLayer.4.batch_norm1.running_var", "module.block1.nblockLayer.4.batch_norm2.weight", "module.block1.nblockLayer.4.batch_norm2.bias", "module.block1.nblockLayer.4.batch_norm2.running_mean", "module.block1.nblockLayer.4.batch_norm2.running_var", "module.block1.nblockLayer.4.conv1.weight", "module.block1.nblockLayer.4.conv2.weight", "module.block2.nblockLayer.4.batch_norm1.weight", "module.block2.nblockLayer.4.batch_norm1.bias", "module.block2.nblockLayer.4.batch_norm1.running_mean", "module.block2.nblockLayer.4.batch_norm1.running_var", "module.block2.nblockLayer.4.batch_norm2.weight", "module.block2.nblockLayer.4.batch_norm2.bias", "module.block2.nblockLayer.4.batch_norm2.running_mean", "module.block2.nblockLayer.4.batch_norm2.running_var", "module.block2.nblockLayer.4.conv1.weight", "module.block2.nblockLayer.4.conv2.weight", "module.block3.nblockLayer.4.batch_norm1.weight", "module.block3.nblockLayer.4.batch_norm1.bias", "module.block3.nblockLayer.4.batch_norm1.running_mean", "module.block3.nblockLayer.4.batch_norm1.running_var", "module.block3.nblockLayer.4.batch_norm2.weight", "module.block3.nblockLayer.4.batch_norm2.bias", "module.block3.nblockLayer.4.batch_norm2.running_mean", "module.block3.nblockLayer.4.batch_norm2.running_var", "module.block3.nblockLayer.4.conv1.weight", "module.block3.nblockLayer.4.conv2.weight". 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "./src/generate_features.py", line 405, in <module>
    feature_extractor(args)
  File "./src/generate_features.py", line 200, in feature_extractor
    student.load_state_dict(torch.load(location, map_location = args.device))   
  File "/home/user/tingweijing/env/DIenv/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1223, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.module.conv1.weight", "module.module.block1.nblockLayer.0.batch_norm1.weight", "module.module.block1.nblockLayer.0.batch_norm1.bias", "module.module.block1.nblockLayer.0.batch_norm1.running_mean", "module.module.block1.nblockLayer.0.batch_norm1.running_var", "module.module.block1.nblockLayer.0.batch_norm2.weight", "module.module.block1.nblockLayer.0.batch_norm2.bias", "module.module.block1.nblockLayer.0.batch_norm2.running_mean", "module.module.block1.nblockLayer.0.batch_norm2.running_var", "module.module.block1.nblockLayer.0.conv1.weight", "module.module.block1.nblockLayer.0.conv2.weight", "module.module.block1.nblockLayer.0.conv_inp.weight", "module.module.block1.nblockLayer.1.batch_norm1.weight", "module.module.block1.nblockLayer.1.batch_norm1.bias", "module.module.block1.nblockLayer.1.batch_norm1.running_mean", "module.module.block1.nblockLayer.1.batch_norm1.running_var", "module.module.block1.nblockLayer.1.batch_norm2.weight", "module.module.block1.nblockLayer.1.batch_norm2.bias", "module.module.block1.nblockLayer.1.batch_norm2.running_mean", "module.module.block1.nblockLayer.1.batch_norm2.running_var", "module.module.block1.nblockLayer.1.conv1.weight", "module.module.block1.nblockLayer.1.conv2.weight", "module.module.block1.nblockLayer.2.batch_norm1.weight", "module.module.block1.nblockLayer.2.batch_norm1.bias", "module.module.block1.nblockLayer.2.batch_norm1.running_mean", "module.module.block1.nblockLayer.2.batch_norm1.running_var", "module.module.block1.nblockLayer.2.batch_norm2.weight", "module.module.block1.nblockLayer.2.batch_norm2.bias", "module.module.block1.nblockLayer.2.batch_norm2.running_mean", "module.module.block1.nblockLayer.2.batch_norm2.running_var", "module.module.block1.nblockLayer.2.conv1.weight", "module.module.block1.nblockLayer.2.conv2.weight", "module.module.block1.nblockLayer.3.batch_norm1.weight", "module.module.block1.nblockLayer.3.batch_norm1.bias", "module.module.block1.nblockLayer.3.batch_norm1.running_mean", "module.module.block1.nblockLayer.3.batch_norm1.running_var", "module.module.block1.nblockLayer.3.batch_norm2.weight", "module.module.block1.nblockLayer.3.batch_norm2.bias", "module.module.block1.nblockLayer.3.batch_norm2.running_mean", "module.module.block1.nblockLayer.3.batch_norm2.running_var", "module.module.block1.nblockLayer.3.conv1.weight", "module.module.block1.nblockLayer.3.conv2.weight", "module.module.block1.nblockLayer.4.batch_norm1.weight", "module.module.block1.nblockLayer.4.batch_norm1.bias", "module.module.block1.nblockLayer.4.batch_norm1.running_mean", "module.module.block1.nblockLayer.4.batch_norm1.running_var", "module.module.block1.nblockLayer.4.batch_norm2.weight", "module.module.block1.nblockLayer.4.batch_norm2.bias", "module.module.block1.nblockLayer.4.batch_norm2.running_mean", "module.module.block1.nblockLayer.4.batch_norm2.running_var", "module.module.block1.nblockLayer.4.conv1.weight", "module.module.block1.nblockLayer.4.conv2.weight", "module.module.block2.nblockLayer.0.batch_norm1.weight", "module.module.block2.nblockLayer.0.batch_norm1.bias", "module.module.block2.nblockLayer.0.batch_norm1.running_mean", "module.module.block2.nblockLayer.0.batch_norm1.running_var", "module.module.block2.nblockLayer.0.batch_norm2.weight", "module.module.block2.nblockLayer.0.batch_norm2.bias", "module.module.block2.nblockLayer.0.batch_norm2.running_mean", "module.module.block2.nblockLayer.0.batch_norm2.running_var", "module.module.block2.nblockLayer.0.conv1.weight", "module.module.block2.nblockLayer.0.conv2.weight", "module.module.block2.nblockLayer.0.conv_inp.weight", "module.module.block2.nblockLayer.1.batch_norm1.weight", "module.module.block2.nblockLayer.1.batch_norm1.bias", "module.module.block2.nblockLayer.1.batch_norm1.running_mean", "module.module.block2.nblockLayer.1.batch_norm1.running_var", "module.module.block2.nblockLayer.1.batch_norm2.weight", "module.module.block2.nblockLayer.1.batch_norm2.bias", "module.module.block2.nblockLayer.1.batch_norm2.running_mean", "module.module.block2.nblockLayer.1.batch_norm2.running_var", "module.module.block2.nblockLayer.1.conv1.weight", "module.module.block2.nblockLayer.1.conv2.weight", "module.module.block2.nblockLayer.2.batch_norm1.weight", "module.module.block2.nblockLayer.2.batch_norm1.bias", "module.module.block2.nblockLayer.2.batch_norm1.running_mean", "module.module.block2.nblockLayer.2.batch_norm1.running_var", "module.module.block2.nblockLayer.2.batch_norm2.weight", "module.module.block2.nblockLayer.2.batch_norm2.bias", "module.module.block2.nblockLayer.2.batch_norm2.running_mean", "module.module.block2.nblockLayer.2.batch_norm2.running_var", "module.module.block2.nblockLayer.2.conv1.weight", "module.module.block2.nblockLayer.2.conv2.weight", "module.module.block2.nblockLayer.3.batch_norm1.weight", "module.module.block2.nblockLayer.3.batch_norm1.bias", "module.module.block2.nblockLayer.3.batch_norm1.running_mean", "module.module.block2.nblockLayer.3.batch_norm1.running_var", "module.module.block2.nblockLayer.3.batch_norm2.weight", "module.module.block2.nblockLayer.3.batch_norm2.bias", "module.module.block2.nblockLayer.3.batch_norm2.running_mean", "module.module.block2.nblockLayer.3.batch_norm2.running_var", "module.module.block2.nblockLayer.3.conv1.weight", "module.module.block2.nblockLayer.3.conv2.weight", "module.module.block2.nblockLayer.4.batch_norm1.weight", "module.module.block2.nblockLayer.4.batch_norm1.bias", "module.module.block2.nblockLayer.4.batch_norm1.running_mean", "module.module.block2.nblockLayer.4.batch_norm1.running_var", "module.module.block2.nblockLayer.4.batch_norm2.weight", "module.module.block2.nblockLayer.4.batch_norm2.bias", "module.module.block2.nblockLayer.4.batch_norm2.running_mean", "module.module.block2.nblockLayer.4.batch_norm2.running_var", "module.module.block2.nblockLayer.4.conv1.weight", "module.module.block2.nblockLayer.4.conv2.weight", "module.module.block3.nblockLayer.0.batch_norm1.weight", "module.module.block3.nblockLayer.0.batch_norm1.bias", "module.module.block3.nblockLayer.0.batch_norm1.running_mean", "module.module.block3.nblockLayer.0.batch_norm1.running_var", "module.module.block3.nblockLayer.0.batch_norm2.weight", "module.module.block3.nblockLayer.0.batch_norm2.bias", "module.module.block3.nblockLayer.0.batch_norm2.running_mean", "module.module.block3.nblockLayer.0.batch_norm2.running_var", "module.module.block3.nblockLayer.0.conv1.weight", "module.module.block3.nblockLayer.0.conv2.weight", "module.module.block3.nblockLayer.0.conv_inp.weight", "module.module.block3.nblockLayer.1.batch_norm1.weight", "module.module.block3.nblockLayer.1.batch_norm1.bias", "module.module.block3.nblockLayer.1.batch_norm1.running_mean", "module.module.block3.nblockLayer.1.batch_norm1.running_var", "module.module.block3.nblockLayer.1.batch_norm2.weight", "module.module.block3.nblockLayer.1.batch_norm2.bias", "module.module.block3.nblockLayer.1.batch_norm2.running_mean", "module.module.block3.nblockLayer.1.batch_norm2.running_var", "module.module.block3.nblockLayer.1.conv1.weight", "module.module.block3.nblockLayer.1.conv2.weight", "module.module.block3.nblockLayer.2.batch_norm1.weight", "module.module.block3.nblockLayer.2.batch_norm1.bias", "module.module.block3.nblockLayer.2.batch_norm1.running_mean", "module.module.block3.nblockLayer.2.batch_norm1.running_var", "module.module.block3.nblockLayer.2.batch_norm2.weight", "module.module.block3.nblockLayer.2.batch_norm2.bias", "module.module.block3.nblockLayer.2.batch_norm2.running_mean", "module.module.block3.nblockLayer.2.batch_norm2.running_var", "module.module.block3.nblockLayer.2.conv1.weight", "module.module.block3.nblockLayer.2.conv2.weight", "module.module.block3.nblockLayer.3.batch_norm1.weight", "module.module.block3.nblockLayer.3.batch_norm1.bias", "module.module.block3.nblockLayer.3.batch_norm1.running_mean", "module.module.block3.nblockLayer.3.batch_norm1.running_var", "module.module.block3.nblockLayer.3.batch_norm2.weight", "module.module.block3.nblockLayer.3.batch_norm2.bias", "module.module.block3.nblockLayer.3.batch_norm2.running_mean", "module.module.block3.nblockLayer.3.batch_norm2.running_var", "module.module.block3.nblockLayer.3.conv1.weight", "module.module.block3.nblockLayer.3.conv2.weight", "module.module.block3.nblockLayer.4.batch_norm1.weight", "module.module.block3.nblockLayer.4.batch_norm1.bias", "module.module.block3.nblockLayer.4.batch_norm1.running_mean", "module.module.block3.nblockLayer.4.batch_norm1.running_var", "module.module.block3.nblockLayer.4.batch_norm2.weight", "module.module.block3.nblockLayer.4.batch_norm2.bias", "module.module.block3.nblockLayer.4.batch_norm2.running_mean", "module.module.block3.nblockLayer.4.batch_norm2.running_var", "module.module.block3.nblockLayer.4.conv1.weight", "module.module.block3.nblockLayer.4.conv2.weight", "module.module.batch_norm.weight", "module.module.batch_norm.bias", "module.module.batch_norm.running_mean", "module.module.batch_norm.running_var", "module.module.fc.weight", "module.module.fc.bias". 
	Unexpected key(s) in state_dict: "module.conv1.weight", "module.block1.nblockLayer.0.batch_norm1.weight", "module.block1.nblockLayer.0.batch_norm1.bias", "module.block1.nblockLayer.0.batch_norm1.running_mean", "module.block1.nblockLayer.0.batch_norm1.running_var", "module.block1.nblockLayer.0.batch_norm1.num_batches_tracked", "module.block1.nblockLayer.0.batch_norm2.weight", "module.block1.nblockLayer.0.batch_norm2.bias", "module.block1.nblockLayer.0.batch_norm2.running_mean", "module.block1.nblockLayer.0.batch_norm2.running_var", "module.block1.nblockLayer.0.batch_norm2.num_batches_tracked", "module.block1.nblockLayer.0.conv1.weight", "module.block1.nblockLayer.0.conv2.weight", "module.block1.nblockLayer.0.conv_inp.weight", "module.block1.nblockLayer.1.batch_norm1.weight", "module.block1.nblockLayer.1.batch_norm1.bias", "module.block1.nblockLayer.1.batch_norm1.running_mean", "module.block1.nblockLayer.1.batch_norm1.running_var", "module.block1.nblockLayer.1.batch_norm1.num_batches_tracked", "module.block1.nblockLayer.1.batch_norm2.weight", "module.block1.nblockLayer.1.batch_norm2.bias", "module.block1.nblockLayer.1.batch_norm2.running_mean", "module.block1.nblockLayer.1.batch_norm2.running_var", "module.block1.nblockLayer.1.batch_norm2.num_batches_tracked", "module.block1.nblockLayer.1.conv1.weight", "module.block1.nblockLayer.1.conv2.weight", "module.block1.nblockLayer.2.batch_norm1.weight", "module.block1.nblockLayer.2.batch_norm1.bias", "module.block1.nblockLayer.2.batch_norm1.running_mean", "module.block1.nblockLayer.2.batch_norm1.running_var", "module.block1.nblockLayer.2.batch_norm1.num_batches_tracked", "module.block1.nblockLayer.2.batch_norm2.weight", "module.block1.nblockLayer.2.batch_norm2.bias", "module.block1.nblockLayer.2.batch_norm2.running_mean", "module.block1.nblockLayer.2.batch_norm2.running_var", "module.block1.nblockLayer.2.batch_norm2.num_batches_tracked", "module.block1.nblockLayer.2.conv1.weight", "module.block1.nblockLayer.2.conv2.weight", "module.block1.nblockLayer.3.batch_norm1.weight", "module.block1.nblockLayer.3.batch_norm1.bias", "module.block1.nblockLayer.3.batch_norm1.running_mean", "module.block1.nblockLayer.3.batch_norm1.running_var", "module.block1.nblockLayer.3.batch_norm1.num_batches_tracked", "module.block1.nblockLayer.3.batch_norm2.weight", "module.block1.nblockLayer.3.batch_norm2.bias", "module.block1.nblockLayer.3.batch_norm2.running_mean", "module.block1.nblockLayer.3.batch_norm2.running_var", "module.block1.nblockLayer.3.batch_norm2.num_batches_tracked", "module.block1.nblockLayer.3.conv1.weight", "module.block1.nblockLayer.3.conv2.weight", "module.block2.nblockLayer.0.batch_norm1.weight", "module.block2.nblockLayer.0.batch_norm1.bias", "module.block2.nblockLayer.0.batch_norm1.running_mean", "module.block2.nblockLayer.0.batch_norm1.running_var", "module.block2.nblockLayer.0.batch_norm1.num_batches_tracked", "module.block2.nblockLayer.0.batch_norm2.weight", "module.block2.nblockLayer.0.batch_norm2.bias", "module.block2.nblockLayer.0.batch_norm2.running_mean", "module.block2.nblockLayer.0.batch_norm2.running_var", "module.block2.nblockLayer.0.batch_norm2.num_batches_tracked", "module.block2.nblockLayer.0.conv1.weight", "module.block2.nblockLayer.0.conv2.weight", "module.block2.nblockLayer.0.conv_inp.weight", "module.block2.nblockLayer.1.batch_norm1.weight", "module.block2.nblockLayer.1.batch_norm1.bias", "module.block2.nblockLayer.1.batch_norm1.running_mean", "module.block2.nblockLayer.1.batch_norm1.running_var", "module.block2.nblockLayer.1.batch_norm1.num_batches_tracked", "module.block2.nblockLayer.1.batch_norm2.weight", "module.block2.nblockLayer.1.batch_norm2.bias", "module.block2.nblockLayer.1.batch_norm2.running_mean", "module.block2.nblockLayer.1.batch_norm2.running_var", "module.block2.nblockLayer.1.batch_norm2.num_batches_tracked", "module.block2.nblockLayer.1.conv1.weight", "module.block2.nblockLayer.1.conv2.weight", "module.block2.nblockLayer.2.batch_norm1.weight", "module.block2.nblockLayer.2.batch_norm1.bias", "module.block2.nblockLayer.2.batch_norm1.running_mean", "module.block2.nblockLayer.2.batch_norm1.running_var", "module.block2.nblockLayer.2.batch_norm1.num_batches_tracked", "module.block2.nblockLayer.2.batch_norm2.weight", "module.block2.nblockLayer.2.batch_norm2.bias", "module.block2.nblockLayer.2.batch_norm2.running_mean", "module.block2.nblockLayer.2.batch_norm2.running_var", "module.block2.nblockLayer.2.batch_norm2.num_batches_tracked", "module.block2.nblockLayer.2.conv1.weight", "module.block2.nblockLayer.2.conv2.weight", "module.block2.nblockLayer.3.batch_norm1.weight", "module.block2.nblockLayer.3.batch_norm1.bias", "module.block2.nblockLayer.3.batch_norm1.running_mean", "module.block2.nblockLayer.3.batch_norm1.running_var", "module.block2.nblockLayer.3.batch_norm1.num_batches_tracked", "module.block2.nblockLayer.3.batch_norm2.weight", "module.block2.nblockLayer.3.batch_norm2.bias", "module.block2.nblockLayer.3.batch_norm2.running_mean", "module.block2.nblockLayer.3.batch_norm2.running_var", "module.block2.nblockLayer.3.batch_norm2.num_batches_tracked", "module.block2.nblockLayer.3.conv1.weight", "module.block2.nblockLayer.3.conv2.weight", "module.block3.nblockLayer.0.batch_norm1.weight", "module.block3.nblockLayer.0.batch_norm1.bias", "module.block3.nblockLayer.0.batch_norm1.running_mean", "module.block3.nblockLayer.0.batch_norm1.running_var", "module.block3.nblockLayer.0.batch_norm1.num_batches_tracked", "module.block3.nblockLayer.0.batch_norm2.weight", "module.block3.nblockLayer.0.batch_norm2.bias", "module.block3.nblockLayer.0.batch_norm2.running_mean", "module.block3.nblockLayer.0.batch_norm2.running_var", "module.block3.nblockLayer.0.batch_norm2.num_batches_tracked", "module.block3.nblockLayer.0.conv1.weight", "module.block3.nblockLayer.0.conv2.weight", "module.block3.nblockLayer.0.conv_inp.weight", "module.block3.nblockLayer.1.batch_norm1.weight", "module.block3.nblockLayer.1.batch_norm1.bias", "module.block3.nblockLayer.1.batch_norm1.running_mean", "module.block3.nblockLayer.1.batch_norm1.running_var", "module.block3.nblockLayer.1.batch_norm1.num_batches_tracked", "module.block3.nblockLayer.1.batch_norm2.weight", "module.block3.nblockLayer.1.batch_norm2.bias", "module.block3.nblockLayer.1.batch_norm2.running_mean", "module.block3.nblockLayer.1.batch_norm2.running_var", "module.block3.nblockLayer.1.batch_norm2.num_batches_tracked", "module.block3.nblockLayer.1.conv1.weight", "module.block3.nblockLayer.1.conv2.weight", "module.block3.nblockLayer.2.batch_norm1.weight", "module.block3.nblockLayer.2.batch_norm1.bias", "module.block3.nblockLayer.2.batch_norm1.running_mean", "module.block3.nblockLayer.2.batch_norm1.running_var", "module.block3.nblockLayer.2.batch_norm1.num_batches_tracked", "module.block3.nblockLayer.2.batch_norm2.weight", "module.block3.nblockLayer.2.batch_norm2.bias", "module.block3.nblockLayer.2.batch_norm2.running_mean", "module.block3.nblockLayer.2.batch_norm2.running_var", "module.block3.nblockLayer.2.batch_norm2.num_batches_tracked", "module.block3.nblockLayer.2.conv1.weight", "module.block3.nblockLayer.2.conv2.weight", "module.block3.nblockLayer.3.batch_norm1.weight", "module.block3.nblockLayer.3.batch_norm1.bias", "module.block3.nblockLayer.3.batch_norm1.running_mean", "module.block3.nblockLayer.3.batch_norm1.running_var", "module.block3.nblockLayer.3.batch_norm1.num_batches_tracked", "module.block3.nblockLayer.3.batch_norm2.weight", "module.block3.nblockLayer.3.batch_norm2.bias", "module.block3.nblockLayer.3.batch_norm2.running_mean", "module.block3.nblockLayer.3.batch_norm2.running_var", "module.block3.nblockLayer.3.batch_norm2.num_batches_tracked", "module.block3.nblockLayer.3.conv1.weight", "module.block3.nblockLayer.3.conv2.weight", "module.batch_norm.weight", "module.batch_norm.bias", "module.batch_norm.running_mean", "module.batch_norm.running_var", "module.batch_norm.num_batches_tracked", "module.fc.weight", "module.fc.bias". 
# Batch size 1000, Train accuracy 85
Namespace(alpha_l_1=1.0, alpha_l_2=0.01, alpha_l_inf=0.001, batch_size=500, combine_ratio=0.5, concat=0, concat_factor=1.0, config_file=None, data_path=None, dataset='CIFAR10', device='cuda:0', distance=None, dropRate=0.0, epochs=50, epsilon_l_1=12, epsilon_l_2=0.5, epsilon_l_inf=0.03137254901960784, experiment='3-var', feature_type='rand', gap=0.001, gpu_id=0, imagenet_architecture='wrn', k=100, lr_max=0.1, lr_min=0.0, lr_mode=1, mode='teacher', model_dataset='CIFAR10', model_id='teacher_normalized', model_type='wrn-28-10', noise_sigma=0.05, normalize=1, num_iter=500, opt_type='SGD', path=None, pseudo_labels=0, randomize=0, regressor_embed=0, restarts=1, resume=0, resume_iter=-1, reverse_train_test=0, seed=0, smallest_adv=1, target_batch_size=1000, target_epoch=0, target_te_acc=0, target_tr_acc=85)
Model Directory: ./models/CIFAR10/model_teacher_normalized_1000
File Directory: ./files/CIFAR10_1000/model_teacher_normalized_tr_acc_85
cuda:0
22-10-07 18:01
No Transform
Files already downloaded and verified
Files already downloaded and verified
No Transform
Files already downloaded and verified
Files already downloaded and verified
Loading model from ./models/CIFAR10/model_teacher_normalized_1000/tr_acc_85.pt
Traceback (most recent call last):
  File "./src/generate_features.py", line 197, in feature_extractor
    student.load_state_dict(torch.load(location, map_location = args.device)) 
  File "/home/user/tingweijing/env/DIenv/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1223, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.block1.nblockLayer.4.batch_norm1.weight", "module.block1.nblockLayer.4.batch_norm1.bias", "module.block1.nblockLayer.4.batch_norm1.running_mean", "module.block1.nblockLayer.4.batch_norm1.running_var", "module.block1.nblockLayer.4.batch_norm2.weight", "module.block1.nblockLayer.4.batch_norm2.bias", "module.block1.nblockLayer.4.batch_norm2.running_mean", "module.block1.nblockLayer.4.batch_norm2.running_var", "module.block1.nblockLayer.4.conv1.weight", "module.block1.nblockLayer.4.conv2.weight", "module.block2.nblockLayer.4.batch_norm1.weight", "module.block2.nblockLayer.4.batch_norm1.bias", "module.block2.nblockLayer.4.batch_norm1.running_mean", "module.block2.nblockLayer.4.batch_norm1.running_var", "module.block2.nblockLayer.4.batch_norm2.weight", "module.block2.nblockLayer.4.batch_norm2.bias", "module.block2.nblockLayer.4.batch_norm2.running_mean", "module.block2.nblockLayer.4.batch_norm2.running_var", "module.block2.nblockLayer.4.conv1.weight", "module.block2.nblockLayer.4.conv2.weight", "module.block3.nblockLayer.4.batch_norm1.weight", "module.block3.nblockLayer.4.batch_norm1.bias", "module.block3.nblockLayer.4.batch_norm1.running_mean", "module.block3.nblockLayer.4.batch_norm1.running_var", "module.block3.nblockLayer.4.batch_norm2.weight", "module.block3.nblockLayer.4.batch_norm2.bias", "module.block3.nblockLayer.4.batch_norm2.running_mean", "module.block3.nblockLayer.4.batch_norm2.running_var", "module.block3.nblockLayer.4.conv1.weight", "module.block3.nblockLayer.4.conv2.weight". 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "./src/generate_features.py", line 405, in <module>
    feature_extractor(args)
  File "./src/generate_features.py", line 200, in feature_extractor
    student.load_state_dict(torch.load(location, map_location = args.device))   
  File "/home/user/tingweijing/env/DIenv/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1223, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.module.conv1.weight", "module.module.block1.nblockLayer.0.batch_norm1.weight", "module.module.block1.nblockLayer.0.batch_norm1.bias", "module.module.block1.nblockLayer.0.batch_norm1.running_mean", "module.module.block1.nblockLayer.0.batch_norm1.running_var", "module.module.block1.nblockLayer.0.batch_norm2.weight", "module.module.block1.nblockLayer.0.batch_norm2.bias", "module.module.block1.nblockLayer.0.batch_norm2.running_mean", "module.module.block1.nblockLayer.0.batch_norm2.running_var", "module.module.block1.nblockLayer.0.conv1.weight", "module.module.block1.nblockLayer.0.conv2.weight", "module.module.block1.nblockLayer.0.conv_inp.weight", "module.module.block1.nblockLayer.1.batch_norm1.weight", "module.module.block1.nblockLayer.1.batch_norm1.bias", "module.module.block1.nblockLayer.1.batch_norm1.running_mean", "module.module.block1.nblockLayer.1.batch_norm1.running_var", "module.module.block1.nblockLayer.1.batch_norm2.weight", "module.module.block1.nblockLayer.1.batch_norm2.bias", "module.module.block1.nblockLayer.1.batch_norm2.running_mean", "module.module.block1.nblockLayer.1.batch_norm2.running_var", "module.module.block1.nblockLayer.1.conv1.weight", "module.module.block1.nblockLayer.1.conv2.weight", "module.module.block1.nblockLayer.2.batch_norm1.weight", "module.module.block1.nblockLayer.2.batch_norm1.bias", "module.module.block1.nblockLayer.2.batch_norm1.running_mean", "module.module.block1.nblockLayer.2.batch_norm1.running_var", "module.module.block1.nblockLayer.2.batch_norm2.weight", "module.module.block1.nblockLayer.2.batch_norm2.bias", "module.module.block1.nblockLayer.2.batch_norm2.running_mean", "module.module.block1.nblockLayer.2.batch_norm2.running_var", "module.module.block1.nblockLayer.2.conv1.weight", "module.module.block1.nblockLayer.2.conv2.weight", "module.module.block1.nblockLayer.3.batch_norm1.weight", "module.module.block1.nblockLayer.3.batch_norm1.bias", "module.module.block1.nblockLayer.3.batch_norm1.running_mean", "module.module.block1.nblockLayer.3.batch_norm1.running_var", "module.module.block1.nblockLayer.3.batch_norm2.weight", "module.module.block1.nblockLayer.3.batch_norm2.bias", "module.module.block1.nblockLayer.3.batch_norm2.running_mean", "module.module.block1.nblockLayer.3.batch_norm2.running_var", "module.module.block1.nblockLayer.3.conv1.weight", "module.module.block1.nblockLayer.3.conv2.weight", "module.module.block1.nblockLayer.4.batch_norm1.weight", "module.module.block1.nblockLayer.4.batch_norm1.bias", "module.module.block1.nblockLayer.4.batch_norm1.running_mean", "module.module.block1.nblockLayer.4.batch_norm1.running_var", "module.module.block1.nblockLayer.4.batch_norm2.weight", "module.module.block1.nblockLayer.4.batch_norm2.bias", "module.module.block1.nblockLayer.4.batch_norm2.running_mean", "module.module.block1.nblockLayer.4.batch_norm2.running_var", "module.module.block1.nblockLayer.4.conv1.weight", "module.module.block1.nblockLayer.4.conv2.weight", "module.module.block2.nblockLayer.0.batch_norm1.weight", "module.module.block2.nblockLayer.0.batch_norm1.bias", "module.module.block2.nblockLayer.0.batch_norm1.running_mean", "module.module.block2.nblockLayer.0.batch_norm1.running_var", "module.module.block2.nblockLayer.0.batch_norm2.weight", "module.module.block2.nblockLayer.0.batch_norm2.bias", "module.module.block2.nblockLayer.0.batch_norm2.running_mean", "module.module.block2.nblockLayer.0.batch_norm2.running_var", "module.module.block2.nblockLayer.0.conv1.weight", "module.module.block2.nblockLayer.0.conv2.weight", "module.module.block2.nblockLayer.0.conv_inp.weight", "module.module.block2.nblockLayer.1.batch_norm1.weight", "module.module.block2.nblockLayer.1.batch_norm1.bias", "module.module.block2.nblockLayer.1.batch_norm1.running_mean", "module.module.block2.nblockLayer.1.batch_norm1.running_var", "module.module.block2.nblockLayer.1.batch_norm2.weight", "module.module.block2.nblockLayer.1.batch_norm2.bias", "module.module.block2.nblockLayer.1.batch_norm2.running_mean", "module.module.block2.nblockLayer.1.batch_norm2.running_var", "module.module.block2.nblockLayer.1.conv1.weight", "module.module.block2.nblockLayer.1.conv2.weight", "module.module.block2.nblockLayer.2.batch_norm1.weight", "module.module.block2.nblockLayer.2.batch_norm1.bias", "module.module.block2.nblockLayer.2.batch_norm1.running_mean", "module.module.block2.nblockLayer.2.batch_norm1.running_var", "module.module.block2.nblockLayer.2.batch_norm2.weight", "module.module.block2.nblockLayer.2.batch_norm2.bias", "module.module.block2.nblockLayer.2.batch_norm2.running_mean", "module.module.block2.nblockLayer.2.batch_norm2.running_var", "module.module.block2.nblockLayer.2.conv1.weight", "module.module.block2.nblockLayer.2.conv2.weight", "module.module.block2.nblockLayer.3.batch_norm1.weight", "module.module.block2.nblockLayer.3.batch_norm1.bias", "module.module.block2.nblockLayer.3.batch_norm1.running_mean", "module.module.block2.nblockLayer.3.batch_norm1.running_var", "module.module.block2.nblockLayer.3.batch_norm2.weight", "module.module.block2.nblockLayer.3.batch_norm2.bias", "module.module.block2.nblockLayer.3.batch_norm2.running_mean", "module.module.block2.nblockLayer.3.batch_norm2.running_var", "module.module.block2.nblockLayer.3.conv1.weight", "module.module.block2.nblockLayer.3.conv2.weight", "module.module.block2.nblockLayer.4.batch_norm1.weight", "module.module.block2.nblockLayer.4.batch_norm1.bias", "module.module.block2.nblockLayer.4.batch_norm1.running_mean", "module.module.block2.nblockLayer.4.batch_norm1.running_var", "module.module.block2.nblockLayer.4.batch_norm2.weight", "module.module.block2.nblockLayer.4.batch_norm2.bias", "module.module.block2.nblockLayer.4.batch_norm2.running_mean", "module.module.block2.nblockLayer.4.batch_norm2.running_var", "module.module.block2.nblockLayer.4.conv1.weight", "module.module.block2.nblockLayer.4.conv2.weight", "module.module.block3.nblockLayer.0.batch_norm1.weight", "module.module.block3.nblockLayer.0.batch_norm1.bias", "module.module.block3.nblockLayer.0.batch_norm1.running_mean", "module.module.block3.nblockLayer.0.batch_norm1.running_var", "module.module.block3.nblockLayer.0.batch_norm2.weight", "module.module.block3.nblockLayer.0.batch_norm2.bias", "module.module.block3.nblockLayer.0.batch_norm2.running_mean", "module.module.block3.nblockLayer.0.batch_norm2.running_var", "module.module.block3.nblockLayer.0.conv1.weight", "module.module.block3.nblockLayer.0.conv2.weight", "module.module.block3.nblockLayer.0.conv_inp.weight", "module.module.block3.nblockLayer.1.batch_norm1.weight", "module.module.block3.nblockLayer.1.batch_norm1.bias", "module.module.block3.nblockLayer.1.batch_norm1.running_mean", "module.module.block3.nblockLayer.1.batch_norm1.running_var", "module.module.block3.nblockLayer.1.batch_norm2.weight", "module.module.block3.nblockLayer.1.batch_norm2.bias", "module.module.block3.nblockLayer.1.batch_norm2.running_mean", "module.module.block3.nblockLayer.1.batch_norm2.running_var", "module.module.block3.nblockLayer.1.conv1.weight", "module.module.block3.nblockLayer.1.conv2.weight", "module.module.block3.nblockLayer.2.batch_norm1.weight", "module.module.block3.nblockLayer.2.batch_norm1.bias", "module.module.block3.nblockLayer.2.batch_norm1.running_mean", "module.module.block3.nblockLayer.2.batch_norm1.running_var", "module.module.block3.nblockLayer.2.batch_norm2.weight", "module.module.block3.nblockLayer.2.batch_norm2.bias", "module.module.block3.nblockLayer.2.batch_norm2.running_mean", "module.module.block3.nblockLayer.2.batch_norm2.running_var", "module.module.block3.nblockLayer.2.conv1.weight", "module.module.block3.nblockLayer.2.conv2.weight", "module.module.block3.nblockLayer.3.batch_norm1.weight", "module.module.block3.nblockLayer.3.batch_norm1.bias", "module.module.block3.nblockLayer.3.batch_norm1.running_mean", "module.module.block3.nblockLayer.3.batch_norm1.running_var", "module.module.block3.nblockLayer.3.batch_norm2.weight", "module.module.block3.nblockLayer.3.batch_norm2.bias", "module.module.block3.nblockLayer.3.batch_norm2.running_mean", "module.module.block3.nblockLayer.3.batch_norm2.running_var", "module.module.block3.nblockLayer.3.conv1.weight", "module.module.block3.nblockLayer.3.conv2.weight", "module.module.block3.nblockLayer.4.batch_norm1.weight", "module.module.block3.nblockLayer.4.batch_norm1.bias", "module.module.block3.nblockLayer.4.batch_norm1.running_mean", "module.module.block3.nblockLayer.4.batch_norm1.running_var", "module.module.block3.nblockLayer.4.batch_norm2.weight", "module.module.block3.nblockLayer.4.batch_norm2.bias", "module.module.block3.nblockLayer.4.batch_norm2.running_mean", "module.module.block3.nblockLayer.4.batch_norm2.running_var", "module.module.block3.nblockLayer.4.conv1.weight", "module.module.block3.nblockLayer.4.conv2.weight", "module.module.batch_norm.weight", "module.module.batch_norm.bias", "module.module.batch_norm.running_mean", "module.module.batch_norm.running_var", "module.module.fc.weight", "module.module.fc.bias". 
	Unexpected key(s) in state_dict: "module.conv1.weight", "module.block1.nblockLayer.0.batch_norm1.weight", "module.block1.nblockLayer.0.batch_norm1.bias", "module.block1.nblockLayer.0.batch_norm1.running_mean", "module.block1.nblockLayer.0.batch_norm1.running_var", "module.block1.nblockLayer.0.batch_norm1.num_batches_tracked", "module.block1.nblockLayer.0.batch_norm2.weight", "module.block1.nblockLayer.0.batch_norm2.bias", "module.block1.nblockLayer.0.batch_norm2.running_mean", "module.block1.nblockLayer.0.batch_norm2.running_var", "module.block1.nblockLayer.0.batch_norm2.num_batches_tracked", "module.block1.nblockLayer.0.conv1.weight", "module.block1.nblockLayer.0.conv2.weight", "module.block1.nblockLayer.0.conv_inp.weight", "module.block1.nblockLayer.1.batch_norm1.weight", "module.block1.nblockLayer.1.batch_norm1.bias", "module.block1.nblockLayer.1.batch_norm1.running_mean", "module.block1.nblockLayer.1.batch_norm1.running_var", "module.block1.nblockLayer.1.batch_norm1.num_batches_tracked", "module.block1.nblockLayer.1.batch_norm2.weight", "module.block1.nblockLayer.1.batch_norm2.bias", "module.block1.nblockLayer.1.batch_norm2.running_mean", "module.block1.nblockLayer.1.batch_norm2.running_var", "module.block1.nblockLayer.1.batch_norm2.num_batches_tracked", "module.block1.nblockLayer.1.conv1.weight", "module.block1.nblockLayer.1.conv2.weight", "module.block1.nblockLayer.2.batch_norm1.weight", "module.block1.nblockLayer.2.batch_norm1.bias", "module.block1.nblockLayer.2.batch_norm1.running_mean", "module.block1.nblockLayer.2.batch_norm1.running_var", "module.block1.nblockLayer.2.batch_norm1.num_batches_tracked", "module.block1.nblockLayer.2.batch_norm2.weight", "module.block1.nblockLayer.2.batch_norm2.bias", "module.block1.nblockLayer.2.batch_norm2.running_mean", "module.block1.nblockLayer.2.batch_norm2.running_var", "module.block1.nblockLayer.2.batch_norm2.num_batches_tracked", "module.block1.nblockLayer.2.conv1.weight", "module.block1.nblockLayer.2.conv2.weight", "module.block1.nblockLayer.3.batch_norm1.weight", "module.block1.nblockLayer.3.batch_norm1.bias", "module.block1.nblockLayer.3.batch_norm1.running_mean", "module.block1.nblockLayer.3.batch_norm1.running_var", "module.block1.nblockLayer.3.batch_norm1.num_batches_tracked", "module.block1.nblockLayer.3.batch_norm2.weight", "module.block1.nblockLayer.3.batch_norm2.bias", "module.block1.nblockLayer.3.batch_norm2.running_mean", "module.block1.nblockLayer.3.batch_norm2.running_var", "module.block1.nblockLayer.3.batch_norm2.num_batches_tracked", "module.block1.nblockLayer.3.conv1.weight", "module.block1.nblockLayer.3.conv2.weight", "module.block2.nblockLayer.0.batch_norm1.weight", "module.block2.nblockLayer.0.batch_norm1.bias", "module.block2.nblockLayer.0.batch_norm1.running_mean", "module.block2.nblockLayer.0.batch_norm1.running_var", "module.block2.nblockLayer.0.batch_norm1.num_batches_tracked", "module.block2.nblockLayer.0.batch_norm2.weight", "module.block2.nblockLayer.0.batch_norm2.bias", "module.block2.nblockLayer.0.batch_norm2.running_mean", "module.block2.nblockLayer.0.batch_norm2.running_var", "module.block2.nblockLayer.0.batch_norm2.num_batches_tracked", "module.block2.nblockLayer.0.conv1.weight", "module.block2.nblockLayer.0.conv2.weight", "module.block2.nblockLayer.0.conv_inp.weight", "module.block2.nblockLayer.1.batch_norm1.weight", "module.block2.nblockLayer.1.batch_norm1.bias", "module.block2.nblockLayer.1.batch_norm1.running_mean", "module.block2.nblockLayer.1.batch_norm1.running_var", "module.block2.nblockLayer.1.batch_norm1.num_batches_tracked", "module.block2.nblockLayer.1.batch_norm2.weight", "module.block2.nblockLayer.1.batch_norm2.bias", "module.block2.nblockLayer.1.batch_norm2.running_mean", "module.block2.nblockLayer.1.batch_norm2.running_var", "module.block2.nblockLayer.1.batch_norm2.num_batches_tracked", "module.block2.nblockLayer.1.conv1.weight", "module.block2.nblockLayer.1.conv2.weight", "module.block2.nblockLayer.2.batch_norm1.weight", "module.block2.nblockLayer.2.batch_norm1.bias", "module.block2.nblockLayer.2.batch_norm1.running_mean", "module.block2.nblockLayer.2.batch_norm1.running_var", "module.block2.nblockLayer.2.batch_norm1.num_batches_tracked", "module.block2.nblockLayer.2.batch_norm2.weight", "module.block2.nblockLayer.2.batch_norm2.bias", "module.block2.nblockLayer.2.batch_norm2.running_mean", "module.block2.nblockLayer.2.batch_norm2.running_var", "module.block2.nblockLayer.2.batch_norm2.num_batches_tracked", "module.block2.nblockLayer.2.conv1.weight", "module.block2.nblockLayer.2.conv2.weight", "module.block2.nblockLayer.3.batch_norm1.weight", "module.block2.nblockLayer.3.batch_norm1.bias", "module.block2.nblockLayer.3.batch_norm1.running_mean", "module.block2.nblockLayer.3.batch_norm1.running_var", "module.block2.nblockLayer.3.batch_norm1.num_batches_tracked", "module.block2.nblockLayer.3.batch_norm2.weight", "module.block2.nblockLayer.3.batch_norm2.bias", "module.block2.nblockLayer.3.batch_norm2.running_mean", "module.block2.nblockLayer.3.batch_norm2.running_var", "module.block2.nblockLayer.3.batch_norm2.num_batches_tracked", "module.block2.nblockLayer.3.conv1.weight", "module.block2.nblockLayer.3.conv2.weight", "module.block3.nblockLayer.0.batch_norm1.weight", "module.block3.nblockLayer.0.batch_norm1.bias", "module.block3.nblockLayer.0.batch_norm1.running_mean", "module.block3.nblockLayer.0.batch_norm1.running_var", "module.block3.nblockLayer.0.batch_norm1.num_batches_tracked", "module.block3.nblockLayer.0.batch_norm2.weight", "module.block3.nblockLayer.0.batch_norm2.bias", "module.block3.nblockLayer.0.batch_norm2.running_mean", "module.block3.nblockLayer.0.batch_norm2.running_var", "module.block3.nblockLayer.0.batch_norm2.num_batches_tracked", "module.block3.nblockLayer.0.conv1.weight", "module.block3.nblockLayer.0.conv2.weight", "module.block3.nblockLayer.0.conv_inp.weight", "module.block3.nblockLayer.1.batch_norm1.weight", "module.block3.nblockLayer.1.batch_norm1.bias", "module.block3.nblockLayer.1.batch_norm1.running_mean", "module.block3.nblockLayer.1.batch_norm1.running_var", "module.block3.nblockLayer.1.batch_norm1.num_batches_tracked", "module.block3.nblockLayer.1.batch_norm2.weight", "module.block3.nblockLayer.1.batch_norm2.bias", "module.block3.nblockLayer.1.batch_norm2.running_mean", "module.block3.nblockLayer.1.batch_norm2.running_var", "module.block3.nblockLayer.1.batch_norm2.num_batches_tracked", "module.block3.nblockLayer.1.conv1.weight", "module.block3.nblockLayer.1.conv2.weight", "module.block3.nblockLayer.2.batch_norm1.weight", "module.block3.nblockLayer.2.batch_norm1.bias", "module.block3.nblockLayer.2.batch_norm1.running_mean", "module.block3.nblockLayer.2.batch_norm1.running_var", "module.block3.nblockLayer.2.batch_norm1.num_batches_tracked", "module.block3.nblockLayer.2.batch_norm2.weight", "module.block3.nblockLayer.2.batch_norm2.bias", "module.block3.nblockLayer.2.batch_norm2.running_mean", "module.block3.nblockLayer.2.batch_norm2.running_var", "module.block3.nblockLayer.2.batch_norm2.num_batches_tracked", "module.block3.nblockLayer.2.conv1.weight", "module.block3.nblockLayer.2.conv2.weight", "module.block3.nblockLayer.3.batch_norm1.weight", "module.block3.nblockLayer.3.batch_norm1.bias", "module.block3.nblockLayer.3.batch_norm1.running_mean", "module.block3.nblockLayer.3.batch_norm1.running_var", "module.block3.nblockLayer.3.batch_norm1.num_batches_tracked", "module.block3.nblockLayer.3.batch_norm2.weight", "module.block3.nblockLayer.3.batch_norm2.bias", "module.block3.nblockLayer.3.batch_norm2.running_mean", "module.block3.nblockLayer.3.batch_norm2.running_var", "module.block3.nblockLayer.3.batch_norm2.num_batches_tracked", "module.block3.nblockLayer.3.conv1.weight", "module.block3.nblockLayer.3.conv2.weight", "module.batch_norm.weight", "module.batch_norm.bias", "module.batch_norm.running_mean", "module.batch_norm.running_var", "module.batch_norm.num_batches_tracked", "module.fc.weight", "module.fc.bias". 
# Batch size 1000, Train accuracy 90
Namespace(alpha_l_1=1.0, alpha_l_2=0.01, alpha_l_inf=0.001, batch_size=500, combine_ratio=0.5, concat=0, concat_factor=1.0, config_file=None, data_path=None, dataset='CIFAR10', device='cuda:0', distance=None, dropRate=0.0, epochs=50, epsilon_l_1=12, epsilon_l_2=0.5, epsilon_l_inf=0.03137254901960784, experiment='3-var', feature_type='rand', gap=0.001, gpu_id=0, imagenet_architecture='wrn', k=100, lr_max=0.1, lr_min=0.0, lr_mode=1, mode='teacher', model_dataset='CIFAR10', model_id='teacher_normalized', model_type='wrn-28-10', noise_sigma=0.05, normalize=1, num_iter=500, opt_type='SGD', path=None, pseudo_labels=0, randomize=0, regressor_embed=0, restarts=1, resume=0, resume_iter=-1, reverse_train_test=0, seed=0, smallest_adv=1, target_batch_size=1000, target_epoch=0, target_te_acc=0, target_tr_acc=90)
Model Directory: ./models/CIFAR10/model_teacher_normalized_1000
File Directory: ./files/CIFAR10_1000/model_teacher_normalized_tr_acc_90
cuda:0
22-10-07 18:01
No Transform
Files already downloaded and verified
Files already downloaded and verified
No Transform
Files already downloaded and verified
Files already downloaded and verified
Loading model from ./models/CIFAR10/model_teacher_normalized_1000/tr_acc_90.pt
Traceback (most recent call last):
  File "./src/generate_features.py", line 197, in feature_extractor
    student.load_state_dict(torch.load(location, map_location = args.device)) 
  File "/home/user/tingweijing/env/DIenv/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1223, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.block1.nblockLayer.4.batch_norm1.weight", "module.block1.nblockLayer.4.batch_norm1.bias", "module.block1.nblockLayer.4.batch_norm1.running_mean", "module.block1.nblockLayer.4.batch_norm1.running_var", "module.block1.nblockLayer.4.batch_norm2.weight", "module.block1.nblockLayer.4.batch_norm2.bias", "module.block1.nblockLayer.4.batch_norm2.running_mean", "module.block1.nblockLayer.4.batch_norm2.running_var", "module.block1.nblockLayer.4.conv1.weight", "module.block1.nblockLayer.4.conv2.weight", "module.block2.nblockLayer.4.batch_norm1.weight", "module.block2.nblockLayer.4.batch_norm1.bias", "module.block2.nblockLayer.4.batch_norm1.running_mean", "module.block2.nblockLayer.4.batch_norm1.running_var", "module.block2.nblockLayer.4.batch_norm2.weight", "module.block2.nblockLayer.4.batch_norm2.bias", "module.block2.nblockLayer.4.batch_norm2.running_mean", "module.block2.nblockLayer.4.batch_norm2.running_var", "module.block2.nblockLayer.4.conv1.weight", "module.block2.nblockLayer.4.conv2.weight", "module.block3.nblockLayer.4.batch_norm1.weight", "module.block3.nblockLayer.4.batch_norm1.bias", "module.block3.nblockLayer.4.batch_norm1.running_mean", "module.block3.nblockLayer.4.batch_norm1.running_var", "module.block3.nblockLayer.4.batch_norm2.weight", "module.block3.nblockLayer.4.batch_norm2.bias", "module.block3.nblockLayer.4.batch_norm2.running_mean", "module.block3.nblockLayer.4.batch_norm2.running_var", "module.block3.nblockLayer.4.conv1.weight", "module.block3.nblockLayer.4.conv2.weight". 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "./src/generate_features.py", line 405, in <module>
    feature_extractor(args)
  File "./src/generate_features.py", line 200, in feature_extractor
    student.load_state_dict(torch.load(location, map_location = args.device))   
  File "/home/user/tingweijing/env/DIenv/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1223, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.module.conv1.weight", "module.module.block1.nblockLayer.0.batch_norm1.weight", "module.module.block1.nblockLayer.0.batch_norm1.bias", "module.module.block1.nblockLayer.0.batch_norm1.running_mean", "module.module.block1.nblockLayer.0.batch_norm1.running_var", "module.module.block1.nblockLayer.0.batch_norm2.weight", "module.module.block1.nblockLayer.0.batch_norm2.bias", "module.module.block1.nblockLayer.0.batch_norm2.running_mean", "module.module.block1.nblockLayer.0.batch_norm2.running_var", "module.module.block1.nblockLayer.0.conv1.weight", "module.module.block1.nblockLayer.0.conv2.weight", "module.module.block1.nblockLayer.0.conv_inp.weight", "module.module.block1.nblockLayer.1.batch_norm1.weight", "module.module.block1.nblockLayer.1.batch_norm1.bias", "module.module.block1.nblockLayer.1.batch_norm1.running_mean", "module.module.block1.nblockLayer.1.batch_norm1.running_var", "module.module.block1.nblockLayer.1.batch_norm2.weight", "module.module.block1.nblockLayer.1.batch_norm2.bias", "module.module.block1.nblockLayer.1.batch_norm2.running_mean", "module.module.block1.nblockLayer.1.batch_norm2.running_var", "module.module.block1.nblockLayer.1.conv1.weight", "module.module.block1.nblockLayer.1.conv2.weight", "module.module.block1.nblockLayer.2.batch_norm1.weight", "module.module.block1.nblockLayer.2.batch_norm1.bias", "module.module.block1.nblockLayer.2.batch_norm1.running_mean", "module.module.block1.nblockLayer.2.batch_norm1.running_var", "module.module.block1.nblockLayer.2.batch_norm2.weight", "module.module.block1.nblockLayer.2.batch_norm2.bias", "module.module.block1.nblockLayer.2.batch_norm2.running_mean", "module.module.block1.nblockLayer.2.batch_norm2.running_var", "module.module.block1.nblockLayer.2.conv1.weight", "module.module.block1.nblockLayer.2.conv2.weight", "module.module.block1.nblockLayer.3.batch_norm1.weight", "module.module.block1.nblockLayer.3.batch_norm1.bias", "module.module.block1.nblockLayer.3.batch_norm1.running_mean", "module.module.block1.nblockLayer.3.batch_norm1.running_var", "module.module.block1.nblockLayer.3.batch_norm2.weight", "module.module.block1.nblockLayer.3.batch_norm2.bias", "module.module.block1.nblockLayer.3.batch_norm2.running_mean", "module.module.block1.nblockLayer.3.batch_norm2.running_var", "module.module.block1.nblockLayer.3.conv1.weight", "module.module.block1.nblockLayer.3.conv2.weight", "module.module.block1.nblockLayer.4.batch_norm1.weight", "module.module.block1.nblockLayer.4.batch_norm1.bias", "module.module.block1.nblockLayer.4.batch_norm1.running_mean", "module.module.block1.nblockLayer.4.batch_norm1.running_var", "module.module.block1.nblockLayer.4.batch_norm2.weight", "module.module.block1.nblockLayer.4.batch_norm2.bias", "module.module.block1.nblockLayer.4.batch_norm2.running_mean", "module.module.block1.nblockLayer.4.batch_norm2.running_var", "module.module.block1.nblockLayer.4.conv1.weight", "module.module.block1.nblockLayer.4.conv2.weight", "module.module.block2.nblockLayer.0.batch_norm1.weight", "module.module.block2.nblockLayer.0.batch_norm1.bias", "module.module.block2.nblockLayer.0.batch_norm1.running_mean", "module.module.block2.nblockLayer.0.batch_norm1.running_var", "module.module.block2.nblockLayer.0.batch_norm2.weight", "module.module.block2.nblockLayer.0.batch_norm2.bias", "module.module.block2.nblockLayer.0.batch_norm2.running_mean", "module.module.block2.nblockLayer.0.batch_norm2.running_var", "module.module.block2.nblockLayer.0.conv1.weight", "module.module.block2.nblockLayer.0.conv2.weight", "module.module.block2.nblockLayer.0.conv_inp.weight", "module.module.block2.nblockLayer.1.batch_norm1.weight", "module.module.block2.nblockLayer.1.batch_norm1.bias", "module.module.block2.nblockLayer.1.batch_norm1.running_mean", "module.module.block2.nblockLayer.1.batch_norm1.running_var", "module.module.block2.nblockLayer.1.batch_norm2.weight", "module.module.block2.nblockLayer.1.batch_norm2.bias", "module.module.block2.nblockLayer.1.batch_norm2.running_mean", "module.module.block2.nblockLayer.1.batch_norm2.running_var", "module.module.block2.nblockLayer.1.conv1.weight", "module.module.block2.nblockLayer.1.conv2.weight", "module.module.block2.nblockLayer.2.batch_norm1.weight", "module.module.block2.nblockLayer.2.batch_norm1.bias", "module.module.block2.nblockLayer.2.batch_norm1.running_mean", "module.module.block2.nblockLayer.2.batch_norm1.running_var", "module.module.block2.nblockLayer.2.batch_norm2.weight", "module.module.block2.nblockLayer.2.batch_norm2.bias", "module.module.block2.nblockLayer.2.batch_norm2.running_mean", "module.module.block2.nblockLayer.2.batch_norm2.running_var", "module.module.block2.nblockLayer.2.conv1.weight", "module.module.block2.nblockLayer.2.conv2.weight", "module.module.block2.nblockLayer.3.batch_norm1.weight", "module.module.block2.nblockLayer.3.batch_norm1.bias", "module.module.block2.nblockLayer.3.batch_norm1.running_mean", "module.module.block2.nblockLayer.3.batch_norm1.running_var", "module.module.block2.nblockLayer.3.batch_norm2.weight", "module.module.block2.nblockLayer.3.batch_norm2.bias", "module.module.block2.nblockLayer.3.batch_norm2.running_mean", "module.module.block2.nblockLayer.3.batch_norm2.running_var", "module.module.block2.nblockLayer.3.conv1.weight", "module.module.block2.nblockLayer.3.conv2.weight", "module.module.block2.nblockLayer.4.batch_norm1.weight", "module.module.block2.nblockLayer.4.batch_norm1.bias", "module.module.block2.nblockLayer.4.batch_norm1.running_mean", "module.module.block2.nblockLayer.4.batch_norm1.running_var", "module.module.block2.nblockLayer.4.batch_norm2.weight", "module.module.block2.nblockLayer.4.batch_norm2.bias", "module.module.block2.nblockLayer.4.batch_norm2.running_mean", "module.module.block2.nblockLayer.4.batch_norm2.running_var", "module.module.block2.nblockLayer.4.conv1.weight", "module.module.block2.nblockLayer.4.conv2.weight", "module.module.block3.nblockLayer.0.batch_norm1.weight", "module.module.block3.nblockLayer.0.batch_norm1.bias", "module.module.block3.nblockLayer.0.batch_norm1.running_mean", "module.module.block3.nblockLayer.0.batch_norm1.running_var", "module.module.block3.nblockLayer.0.batch_norm2.weight", "module.module.block3.nblockLayer.0.batch_norm2.bias", "module.module.block3.nblockLayer.0.batch_norm2.running_mean", "module.module.block3.nblockLayer.0.batch_norm2.running_var", "module.module.block3.nblockLayer.0.conv1.weight", "module.module.block3.nblockLayer.0.conv2.weight", "module.module.block3.nblockLayer.0.conv_inp.weight", "module.module.block3.nblockLayer.1.batch_norm1.weight", "module.module.block3.nblockLayer.1.batch_norm1.bias", "module.module.block3.nblockLayer.1.batch_norm1.running_mean", "module.module.block3.nblockLayer.1.batch_norm1.running_var", "module.module.block3.nblockLayer.1.batch_norm2.weight", "module.module.block3.nblockLayer.1.batch_norm2.bias", "module.module.block3.nblockLayer.1.batch_norm2.running_mean", "module.module.block3.nblockLayer.1.batch_norm2.running_var", "module.module.block3.nblockLayer.1.conv1.weight", "module.module.block3.nblockLayer.1.conv2.weight", "module.module.block3.nblockLayer.2.batch_norm1.weight", "module.module.block3.nblockLayer.2.batch_norm1.bias", "module.module.block3.nblockLayer.2.batch_norm1.running_mean", "module.module.block3.nblockLayer.2.batch_norm1.running_var", "module.module.block3.nblockLayer.2.batch_norm2.weight", "module.module.block3.nblockLayer.2.batch_norm2.bias", "module.module.block3.nblockLayer.2.batch_norm2.running_mean", "module.module.block3.nblockLayer.2.batch_norm2.running_var", "module.module.block3.nblockLayer.2.conv1.weight", "module.module.block3.nblockLayer.2.conv2.weight", "module.module.block3.nblockLayer.3.batch_norm1.weight", "module.module.block3.nblockLayer.3.batch_norm1.bias", "module.module.block3.nblockLayer.3.batch_norm1.running_mean", "module.module.block3.nblockLayer.3.batch_norm1.running_var", "module.module.block3.nblockLayer.3.batch_norm2.weight", "module.module.block3.nblockLayer.3.batch_norm2.bias", "module.module.block3.nblockLayer.3.batch_norm2.running_mean", "module.module.block3.nblockLayer.3.batch_norm2.running_var", "module.module.block3.nblockLayer.3.conv1.weight", "module.module.block3.nblockLayer.3.conv2.weight", "module.module.block3.nblockLayer.4.batch_norm1.weight", "module.module.block3.nblockLayer.4.batch_norm1.bias", "module.module.block3.nblockLayer.4.batch_norm1.running_mean", "module.module.block3.nblockLayer.4.batch_norm1.running_var", "module.module.block3.nblockLayer.4.batch_norm2.weight", "module.module.block3.nblockLayer.4.batch_norm2.bias", "module.module.block3.nblockLayer.4.batch_norm2.running_mean", "module.module.block3.nblockLayer.4.batch_norm2.running_var", "module.module.block3.nblockLayer.4.conv1.weight", "module.module.block3.nblockLayer.4.conv2.weight", "module.module.batch_norm.weight", "module.module.batch_norm.bias", "module.module.batch_norm.running_mean", "module.module.batch_norm.running_var", "module.module.fc.weight", "module.module.fc.bias". 
	Unexpected key(s) in state_dict: "module.conv1.weight", "module.block1.nblockLayer.0.batch_norm1.weight", "module.block1.nblockLayer.0.batch_norm1.bias", "module.block1.nblockLayer.0.batch_norm1.running_mean", "module.block1.nblockLayer.0.batch_norm1.running_var", "module.block1.nblockLayer.0.batch_norm1.num_batches_tracked", "module.block1.nblockLayer.0.batch_norm2.weight", "module.block1.nblockLayer.0.batch_norm2.bias", "module.block1.nblockLayer.0.batch_norm2.running_mean", "module.block1.nblockLayer.0.batch_norm2.running_var", "module.block1.nblockLayer.0.batch_norm2.num_batches_tracked", "module.block1.nblockLayer.0.conv1.weight", "module.block1.nblockLayer.0.conv2.weight", "module.block1.nblockLayer.0.conv_inp.weight", "module.block1.nblockLayer.1.batch_norm1.weight", "module.block1.nblockLayer.1.batch_norm1.bias", "module.block1.nblockLayer.1.batch_norm1.running_mean", "module.block1.nblockLayer.1.batch_norm1.running_var", "module.block1.nblockLayer.1.batch_norm1.num_batches_tracked", "module.block1.nblockLayer.1.batch_norm2.weight", "module.block1.nblockLayer.1.batch_norm2.bias", "module.block1.nblockLayer.1.batch_norm2.running_mean", "module.block1.nblockLayer.1.batch_norm2.running_var", "module.block1.nblockLayer.1.batch_norm2.num_batches_tracked", "module.block1.nblockLayer.1.conv1.weight", "module.block1.nblockLayer.1.conv2.weight", "module.block1.nblockLayer.2.batch_norm1.weight", "module.block1.nblockLayer.2.batch_norm1.bias", "module.block1.nblockLayer.2.batch_norm1.running_mean", "module.block1.nblockLayer.2.batch_norm1.running_var", "module.block1.nblockLayer.2.batch_norm1.num_batches_tracked", "module.block1.nblockLayer.2.batch_norm2.weight", "module.block1.nblockLayer.2.batch_norm2.bias", "module.block1.nblockLayer.2.batch_norm2.running_mean", "module.block1.nblockLayer.2.batch_norm2.running_var", "module.block1.nblockLayer.2.batch_norm2.num_batches_tracked", "module.block1.nblockLayer.2.conv1.weight", "module.block1.nblockLayer.2.conv2.weight", "module.block1.nblockLayer.3.batch_norm1.weight", "module.block1.nblockLayer.3.batch_norm1.bias", "module.block1.nblockLayer.3.batch_norm1.running_mean", "module.block1.nblockLayer.3.batch_norm1.running_var", "module.block1.nblockLayer.3.batch_norm1.num_batches_tracked", "module.block1.nblockLayer.3.batch_norm2.weight", "module.block1.nblockLayer.3.batch_norm2.bias", "module.block1.nblockLayer.3.batch_norm2.running_mean", "module.block1.nblockLayer.3.batch_norm2.running_var", "module.block1.nblockLayer.3.batch_norm2.num_batches_tracked", "module.block1.nblockLayer.3.conv1.weight", "module.block1.nblockLayer.3.conv2.weight", "module.block2.nblockLayer.0.batch_norm1.weight", "module.block2.nblockLayer.0.batch_norm1.bias", "module.block2.nblockLayer.0.batch_norm1.running_mean", "module.block2.nblockLayer.0.batch_norm1.running_var", "module.block2.nblockLayer.0.batch_norm1.num_batches_tracked", "module.block2.nblockLayer.0.batch_norm2.weight", "module.block2.nblockLayer.0.batch_norm2.bias", "module.block2.nblockLayer.0.batch_norm2.running_mean", "module.block2.nblockLayer.0.batch_norm2.running_var", "module.block2.nblockLayer.0.batch_norm2.num_batches_tracked", "module.block2.nblockLayer.0.conv1.weight", "module.block2.nblockLayer.0.conv2.weight", "module.block2.nblockLayer.0.conv_inp.weight", "module.block2.nblockLayer.1.batch_norm1.weight", "module.block2.nblockLayer.1.batch_norm1.bias", "module.block2.nblockLayer.1.batch_norm1.running_mean", "module.block2.nblockLayer.1.batch_norm1.running_var", "module.block2.nblockLayer.1.batch_norm1.num_batches_tracked", "module.block2.nblockLayer.1.batch_norm2.weight", "module.block2.nblockLayer.1.batch_norm2.bias", "module.block2.nblockLayer.1.batch_norm2.running_mean", "module.block2.nblockLayer.1.batch_norm2.running_var", "module.block2.nblockLayer.1.batch_norm2.num_batches_tracked", "module.block2.nblockLayer.1.conv1.weight", "module.block2.nblockLayer.1.conv2.weight", "module.block2.nblockLayer.2.batch_norm1.weight", "module.block2.nblockLayer.2.batch_norm1.bias", "module.block2.nblockLayer.2.batch_norm1.running_mean", "module.block2.nblockLayer.2.batch_norm1.running_var", "module.block2.nblockLayer.2.batch_norm1.num_batches_tracked", "module.block2.nblockLayer.2.batch_norm2.weight", "module.block2.nblockLayer.2.batch_norm2.bias", "module.block2.nblockLayer.2.batch_norm2.running_mean", "module.block2.nblockLayer.2.batch_norm2.running_var", "module.block2.nblockLayer.2.batch_norm2.num_batches_tracked", "module.block2.nblockLayer.2.conv1.weight", "module.block2.nblockLayer.2.conv2.weight", "module.block2.nblockLayer.3.batch_norm1.weight", "module.block2.nblockLayer.3.batch_norm1.bias", "module.block2.nblockLayer.3.batch_norm1.running_mean", "module.block2.nblockLayer.3.batch_norm1.running_var", "module.block2.nblockLayer.3.batch_norm1.num_batches_tracked", "module.block2.nblockLayer.3.batch_norm2.weight", "module.block2.nblockLayer.3.batch_norm2.bias", "module.block2.nblockLayer.3.batch_norm2.running_mean", "module.block2.nblockLayer.3.batch_norm2.running_var", "module.block2.nblockLayer.3.batch_norm2.num_batches_tracked", "module.block2.nblockLayer.3.conv1.weight", "module.block2.nblockLayer.3.conv2.weight", "module.block3.nblockLayer.0.batch_norm1.weight", "module.block3.nblockLayer.0.batch_norm1.bias", "module.block3.nblockLayer.0.batch_norm1.running_mean", "module.block3.nblockLayer.0.batch_norm1.running_var", "module.block3.nblockLayer.0.batch_norm1.num_batches_tracked", "module.block3.nblockLayer.0.batch_norm2.weight", "module.block3.nblockLayer.0.batch_norm2.bias", "module.block3.nblockLayer.0.batch_norm2.running_mean", "module.block3.nblockLayer.0.batch_norm2.running_var", "module.block3.nblockLayer.0.batch_norm2.num_batches_tracked", "module.block3.nblockLayer.0.conv1.weight", "module.block3.nblockLayer.0.conv2.weight", "module.block3.nblockLayer.0.conv_inp.weight", "module.block3.nblockLayer.1.batch_norm1.weight", "module.block3.nblockLayer.1.batch_norm1.bias", "module.block3.nblockLayer.1.batch_norm1.running_mean", "module.block3.nblockLayer.1.batch_norm1.running_var", "module.block3.nblockLayer.1.batch_norm1.num_batches_tracked", "module.block3.nblockLayer.1.batch_norm2.weight", "module.block3.nblockLayer.1.batch_norm2.bias", "module.block3.nblockLayer.1.batch_norm2.running_mean", "module.block3.nblockLayer.1.batch_norm2.running_var", "module.block3.nblockLayer.1.batch_norm2.num_batches_tracked", "module.block3.nblockLayer.1.conv1.weight", "module.block3.nblockLayer.1.conv2.weight", "module.block3.nblockLayer.2.batch_norm1.weight", "module.block3.nblockLayer.2.batch_norm1.bias", "module.block3.nblockLayer.2.batch_norm1.running_mean", "module.block3.nblockLayer.2.batch_norm1.running_var", "module.block3.nblockLayer.2.batch_norm1.num_batches_tracked", "module.block3.nblockLayer.2.batch_norm2.weight", "module.block3.nblockLayer.2.batch_norm2.bias", "module.block3.nblockLayer.2.batch_norm2.running_mean", "module.block3.nblockLayer.2.batch_norm2.running_var", "module.block3.nblockLayer.2.batch_norm2.num_batches_tracked", "module.block3.nblockLayer.2.conv1.weight", "module.block3.nblockLayer.2.conv2.weight", "module.block3.nblockLayer.3.batch_norm1.weight", "module.block3.nblockLayer.3.batch_norm1.bias", "module.block3.nblockLayer.3.batch_norm1.running_mean", "module.block3.nblockLayer.3.batch_norm1.running_var", "module.block3.nblockLayer.3.batch_norm1.num_batches_tracked", "module.block3.nblockLayer.3.batch_norm2.weight", "module.block3.nblockLayer.3.batch_norm2.bias", "module.block3.nblockLayer.3.batch_norm2.running_mean", "module.block3.nblockLayer.3.batch_norm2.running_var", "module.block3.nblockLayer.3.batch_norm2.num_batches_tracked", "module.block3.nblockLayer.3.conv1.weight", "module.block3.nblockLayer.3.conv2.weight", "module.batch_norm.weight", "module.batch_norm.bias", "module.batch_norm.running_mean", "module.batch_norm.running_var", "module.batch_norm.num_batches_tracked", "module.fc.weight", "module.fc.bias". 
# Batch size 1000, Train accuracy 95
Namespace(alpha_l_1=1.0, alpha_l_2=0.01, alpha_l_inf=0.001, batch_size=500, combine_ratio=0.5, concat=0, concat_factor=1.0, config_file=None, data_path=None, dataset='CIFAR10', device='cuda:0', distance=None, dropRate=0.0, epochs=50, epsilon_l_1=12, epsilon_l_2=0.5, epsilon_l_inf=0.03137254901960784, experiment='3-var', feature_type='rand', gap=0.001, gpu_id=0, imagenet_architecture='wrn', k=100, lr_max=0.1, lr_min=0.0, lr_mode=1, mode='teacher', model_dataset='CIFAR10', model_id='teacher_normalized', model_type='wrn-28-10', noise_sigma=0.05, normalize=1, num_iter=500, opt_type='SGD', path=None, pseudo_labels=0, randomize=0, regressor_embed=0, restarts=1, resume=0, resume_iter=-1, reverse_train_test=0, seed=0, smallest_adv=1, target_batch_size=1000, target_epoch=0, target_te_acc=0, target_tr_acc=95)
Model Directory: ./models/CIFAR10/model_teacher_normalized_1000
File Directory: ./files/CIFAR10_1000/model_teacher_normalized_tr_acc_95
cuda:0
22-10-07 18:02
No Transform
Files already downloaded and verified
Files already downloaded and verified
No Transform
Files already downloaded and verified
Files already downloaded and verified
Loading model from ./models/CIFAR10/model_teacher_normalized_1000/tr_acc_95.pt
Traceback (most recent call last):
  File "./src/generate_features.py", line 197, in feature_extractor
    student.load_state_dict(torch.load(location, map_location = args.device)) 
  File "/home/user/tingweijing/env/DIenv/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1223, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.block1.nblockLayer.4.batch_norm1.weight", "module.block1.nblockLayer.4.batch_norm1.bias", "module.block1.nblockLayer.4.batch_norm1.running_mean", "module.block1.nblockLayer.4.batch_norm1.running_var", "module.block1.nblockLayer.4.batch_norm2.weight", "module.block1.nblockLayer.4.batch_norm2.bias", "module.block1.nblockLayer.4.batch_norm2.running_mean", "module.block1.nblockLayer.4.batch_norm2.running_var", "module.block1.nblockLayer.4.conv1.weight", "module.block1.nblockLayer.4.conv2.weight", "module.block2.nblockLayer.4.batch_norm1.weight", "module.block2.nblockLayer.4.batch_norm1.bias", "module.block2.nblockLayer.4.batch_norm1.running_mean", "module.block2.nblockLayer.4.batch_norm1.running_var", "module.block2.nblockLayer.4.batch_norm2.weight", "module.block2.nblockLayer.4.batch_norm2.bias", "module.block2.nblockLayer.4.batch_norm2.running_mean", "module.block2.nblockLayer.4.batch_norm2.running_var", "module.block2.nblockLayer.4.conv1.weight", "module.block2.nblockLayer.4.conv2.weight", "module.block3.nblockLayer.4.batch_norm1.weight", "module.block3.nblockLayer.4.batch_norm1.bias", "module.block3.nblockLayer.4.batch_norm1.running_mean", "module.block3.nblockLayer.4.batch_norm1.running_var", "module.block3.nblockLayer.4.batch_norm2.weight", "module.block3.nblockLayer.4.batch_norm2.bias", "module.block3.nblockLayer.4.batch_norm2.running_mean", "module.block3.nblockLayer.4.batch_norm2.running_var", "module.block3.nblockLayer.4.conv1.weight", "module.block3.nblockLayer.4.conv2.weight". 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "./src/generate_features.py", line 405, in <module>
    feature_extractor(args)
  File "./src/generate_features.py", line 200, in feature_extractor
    student.load_state_dict(torch.load(location, map_location = args.device))   
  File "/home/user/tingweijing/env/DIenv/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1223, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.module.conv1.weight", "module.module.block1.nblockLayer.0.batch_norm1.weight", "module.module.block1.nblockLayer.0.batch_norm1.bias", "module.module.block1.nblockLayer.0.batch_norm1.running_mean", "module.module.block1.nblockLayer.0.batch_norm1.running_var", "module.module.block1.nblockLayer.0.batch_norm2.weight", "module.module.block1.nblockLayer.0.batch_norm2.bias", "module.module.block1.nblockLayer.0.batch_norm2.running_mean", "module.module.block1.nblockLayer.0.batch_norm2.running_var", "module.module.block1.nblockLayer.0.conv1.weight", "module.module.block1.nblockLayer.0.conv2.weight", "module.module.block1.nblockLayer.0.conv_inp.weight", "module.module.block1.nblockLayer.1.batch_norm1.weight", "module.module.block1.nblockLayer.1.batch_norm1.bias", "module.module.block1.nblockLayer.1.batch_norm1.running_mean", "module.module.block1.nblockLayer.1.batch_norm1.running_var", "module.module.block1.nblockLayer.1.batch_norm2.weight", "module.module.block1.nblockLayer.1.batch_norm2.bias", "module.module.block1.nblockLayer.1.batch_norm2.running_mean", "module.module.block1.nblockLayer.1.batch_norm2.running_var", "module.module.block1.nblockLayer.1.conv1.weight", "module.module.block1.nblockLayer.1.conv2.weight", "module.module.block1.nblockLayer.2.batch_norm1.weight", "module.module.block1.nblockLayer.2.batch_norm1.bias", "module.module.block1.nblockLayer.2.batch_norm1.running_mean", "module.module.block1.nblockLayer.2.batch_norm1.running_var", "module.module.block1.nblockLayer.2.batch_norm2.weight", "module.module.block1.nblockLayer.2.batch_norm2.bias", "module.module.block1.nblockLayer.2.batch_norm2.running_mean", "module.module.block1.nblockLayer.2.batch_norm2.running_var", "module.module.block1.nblockLayer.2.conv1.weight", "module.module.block1.nblockLayer.2.conv2.weight", "module.module.block1.nblockLayer.3.batch_norm1.weight", "module.module.block1.nblockLayer.3.batch_norm1.bias", "module.module.block1.nblockLayer.3.batch_norm1.running_mean", "module.module.block1.nblockLayer.3.batch_norm1.running_var", "module.module.block1.nblockLayer.3.batch_norm2.weight", "module.module.block1.nblockLayer.3.batch_norm2.bias", "module.module.block1.nblockLayer.3.batch_norm2.running_mean", "module.module.block1.nblockLayer.3.batch_norm2.running_var", "module.module.block1.nblockLayer.3.conv1.weight", "module.module.block1.nblockLayer.3.conv2.weight", "module.module.block1.nblockLayer.4.batch_norm1.weight", "module.module.block1.nblockLayer.4.batch_norm1.bias", "module.module.block1.nblockLayer.4.batch_norm1.running_mean", "module.module.block1.nblockLayer.4.batch_norm1.running_var", "module.module.block1.nblockLayer.4.batch_norm2.weight", "module.module.block1.nblockLayer.4.batch_norm2.bias", "module.module.block1.nblockLayer.4.batch_norm2.running_mean", "module.module.block1.nblockLayer.4.batch_norm2.running_var", "module.module.block1.nblockLayer.4.conv1.weight", "module.module.block1.nblockLayer.4.conv2.weight", "module.module.block2.nblockLayer.0.batch_norm1.weight", "module.module.block2.nblockLayer.0.batch_norm1.bias", "module.module.block2.nblockLayer.0.batch_norm1.running_mean", "module.module.block2.nblockLayer.0.batch_norm1.running_var", "module.module.block2.nblockLayer.0.batch_norm2.weight", "module.module.block2.nblockLayer.0.batch_norm2.bias", "module.module.block2.nblockLayer.0.batch_norm2.running_mean", "module.module.block2.nblockLayer.0.batch_norm2.running_var", "module.module.block2.nblockLayer.0.conv1.weight", "module.module.block2.nblockLayer.0.conv2.weight", "module.module.block2.nblockLayer.0.conv_inp.weight", "module.module.block2.nblockLayer.1.batch_norm1.weight", "module.module.block2.nblockLayer.1.batch_norm1.bias", "module.module.block2.nblockLayer.1.batch_norm1.running_mean", "module.module.block2.nblockLayer.1.batch_norm1.running_var", "module.module.block2.nblockLayer.1.batch_norm2.weight", "module.module.block2.nblockLayer.1.batch_norm2.bias", "module.module.block2.nblockLayer.1.batch_norm2.running_mean", "module.module.block2.nblockLayer.1.batch_norm2.running_var", "module.module.block2.nblockLayer.1.conv1.weight", "module.module.block2.nblockLayer.1.conv2.weight", "module.module.block2.nblockLayer.2.batch_norm1.weight", "module.module.block2.nblockLayer.2.batch_norm1.bias", "module.module.block2.nblockLayer.2.batch_norm1.running_mean", "module.module.block2.nblockLayer.2.batch_norm1.running_var", "module.module.block2.nblockLayer.2.batch_norm2.weight", "module.module.block2.nblockLayer.2.batch_norm2.bias", "module.module.block2.nblockLayer.2.batch_norm2.running_mean", "module.module.block2.nblockLayer.2.batch_norm2.running_var", "module.module.block2.nblockLayer.2.conv1.weight", "module.module.block2.nblockLayer.2.conv2.weight", "module.module.block2.nblockLayer.3.batch_norm1.weight", "module.module.block2.nblockLayer.3.batch_norm1.bias", "module.module.block2.nblockLayer.3.batch_norm1.running_mean", "module.module.block2.nblockLayer.3.batch_norm1.running_var", "module.module.block2.nblockLayer.3.batch_norm2.weight", "module.module.block2.nblockLayer.3.batch_norm2.bias", "module.module.block2.nblockLayer.3.batch_norm2.running_mean", "module.module.block2.nblockLayer.3.batch_norm2.running_var", "module.module.block2.nblockLayer.3.conv1.weight", "module.module.block2.nblockLayer.3.conv2.weight", "module.module.block2.nblockLayer.4.batch_norm1.weight", "module.module.block2.nblockLayer.4.batch_norm1.bias", "module.module.block2.nblockLayer.4.batch_norm1.running_mean", "module.module.block2.nblockLayer.4.batch_norm1.running_var", "module.module.block2.nblockLayer.4.batch_norm2.weight", "module.module.block2.nblockLayer.4.batch_norm2.bias", "module.module.block2.nblockLayer.4.batch_norm2.running_mean", "module.module.block2.nblockLayer.4.batch_norm2.running_var", "module.module.block2.nblockLayer.4.conv1.weight", "module.module.block2.nblockLayer.4.conv2.weight", "module.module.block3.nblockLayer.0.batch_norm1.weight", "module.module.block3.nblockLayer.0.batch_norm1.bias", "module.module.block3.nblockLayer.0.batch_norm1.running_mean", "module.module.block3.nblockLayer.0.batch_norm1.running_var", "module.module.block3.nblockLayer.0.batch_norm2.weight", "module.module.block3.nblockLayer.0.batch_norm2.bias", "module.module.block3.nblockLayer.0.batch_norm2.running_mean", "module.module.block3.nblockLayer.0.batch_norm2.running_var", "module.module.block3.nblockLayer.0.conv1.weight", "module.module.block3.nblockLayer.0.conv2.weight", "module.module.block3.nblockLayer.0.conv_inp.weight", "module.module.block3.nblockLayer.1.batch_norm1.weight", "module.module.block3.nblockLayer.1.batch_norm1.bias", "module.module.block3.nblockLayer.1.batch_norm1.running_mean", "module.module.block3.nblockLayer.1.batch_norm1.running_var", "module.module.block3.nblockLayer.1.batch_norm2.weight", "module.module.block3.nblockLayer.1.batch_norm2.bias", "module.module.block3.nblockLayer.1.batch_norm2.running_mean", "module.module.block3.nblockLayer.1.batch_norm2.running_var", "module.module.block3.nblockLayer.1.conv1.weight", "module.module.block3.nblockLayer.1.conv2.weight", "module.module.block3.nblockLayer.2.batch_norm1.weight", "module.module.block3.nblockLayer.2.batch_norm1.bias", "module.module.block3.nblockLayer.2.batch_norm1.running_mean", "module.module.block3.nblockLayer.2.batch_norm1.running_var", "module.module.block3.nblockLayer.2.batch_norm2.weight", "module.module.block3.nblockLayer.2.batch_norm2.bias", "module.module.block3.nblockLayer.2.batch_norm2.running_mean", "module.module.block3.nblockLayer.2.batch_norm2.running_var", "module.module.block3.nblockLayer.2.conv1.weight", "module.module.block3.nblockLayer.2.conv2.weight", "module.module.block3.nblockLayer.3.batch_norm1.weight", "module.module.block3.nblockLayer.3.batch_norm1.bias", "module.module.block3.nblockLayer.3.batch_norm1.running_mean", "module.module.block3.nblockLayer.3.batch_norm1.running_var", "module.module.block3.nblockLayer.3.batch_norm2.weight", "module.module.block3.nblockLayer.3.batch_norm2.bias", "module.module.block3.nblockLayer.3.batch_norm2.running_mean", "module.module.block3.nblockLayer.3.batch_norm2.running_var", "module.module.block3.nblockLayer.3.conv1.weight", "module.module.block3.nblockLayer.3.conv2.weight", "module.module.block3.nblockLayer.4.batch_norm1.weight", "module.module.block3.nblockLayer.4.batch_norm1.bias", "module.module.block3.nblockLayer.4.batch_norm1.running_mean", "module.module.block3.nblockLayer.4.batch_norm1.running_var", "module.module.block3.nblockLayer.4.batch_norm2.weight", "module.module.block3.nblockLayer.4.batch_norm2.bias", "module.module.block3.nblockLayer.4.batch_norm2.running_mean", "module.module.block3.nblockLayer.4.batch_norm2.running_var", "module.module.block3.nblockLayer.4.conv1.weight", "module.module.block3.nblockLayer.4.conv2.weight", "module.module.batch_norm.weight", "module.module.batch_norm.bias", "module.module.batch_norm.running_mean", "module.module.batch_norm.running_var", "module.module.fc.weight", "module.module.fc.bias". 
	Unexpected key(s) in state_dict: "module.conv1.weight", "module.block1.nblockLayer.0.batch_norm1.weight", "module.block1.nblockLayer.0.batch_norm1.bias", "module.block1.nblockLayer.0.batch_norm1.running_mean", "module.block1.nblockLayer.0.batch_norm1.running_var", "module.block1.nblockLayer.0.batch_norm1.num_batches_tracked", "module.block1.nblockLayer.0.batch_norm2.weight", "module.block1.nblockLayer.0.batch_norm2.bias", "module.block1.nblockLayer.0.batch_norm2.running_mean", "module.block1.nblockLayer.0.batch_norm2.running_var", "module.block1.nblockLayer.0.batch_norm2.num_batches_tracked", "module.block1.nblockLayer.0.conv1.weight", "module.block1.nblockLayer.0.conv2.weight", "module.block1.nblockLayer.0.conv_inp.weight", "module.block1.nblockLayer.1.batch_norm1.weight", "module.block1.nblockLayer.1.batch_norm1.bias", "module.block1.nblockLayer.1.batch_norm1.running_mean", "module.block1.nblockLayer.1.batch_norm1.running_var", "module.block1.nblockLayer.1.batch_norm1.num_batches_tracked", "module.block1.nblockLayer.1.batch_norm2.weight", "module.block1.nblockLayer.1.batch_norm2.bias", "module.block1.nblockLayer.1.batch_norm2.running_mean", "module.block1.nblockLayer.1.batch_norm2.running_var", "module.block1.nblockLayer.1.batch_norm2.num_batches_tracked", "module.block1.nblockLayer.1.conv1.weight", "module.block1.nblockLayer.1.conv2.weight", "module.block1.nblockLayer.2.batch_norm1.weight", "module.block1.nblockLayer.2.batch_norm1.bias", "module.block1.nblockLayer.2.batch_norm1.running_mean", "module.block1.nblockLayer.2.batch_norm1.running_var", "module.block1.nblockLayer.2.batch_norm1.num_batches_tracked", "module.block1.nblockLayer.2.batch_norm2.weight", "module.block1.nblockLayer.2.batch_norm2.bias", "module.block1.nblockLayer.2.batch_norm2.running_mean", "module.block1.nblockLayer.2.batch_norm2.running_var", "module.block1.nblockLayer.2.batch_norm2.num_batches_tracked", "module.block1.nblockLayer.2.conv1.weight", "module.block1.nblockLayer.2.conv2.weight", "module.block1.nblockLayer.3.batch_norm1.weight", "module.block1.nblockLayer.3.batch_norm1.bias", "module.block1.nblockLayer.3.batch_norm1.running_mean", "module.block1.nblockLayer.3.batch_norm1.running_var", "module.block1.nblockLayer.3.batch_norm1.num_batches_tracked", "module.block1.nblockLayer.3.batch_norm2.weight", "module.block1.nblockLayer.3.batch_norm2.bias", "module.block1.nblockLayer.3.batch_norm2.running_mean", "module.block1.nblockLayer.3.batch_norm2.running_var", "module.block1.nblockLayer.3.batch_norm2.num_batches_tracked", "module.block1.nblockLayer.3.conv1.weight", "module.block1.nblockLayer.3.conv2.weight", "module.block2.nblockLayer.0.batch_norm1.weight", "module.block2.nblockLayer.0.batch_norm1.bias", "module.block2.nblockLayer.0.batch_norm1.running_mean", "module.block2.nblockLayer.0.batch_norm1.running_var", "module.block2.nblockLayer.0.batch_norm1.num_batches_tracked", "module.block2.nblockLayer.0.batch_norm2.weight", "module.block2.nblockLayer.0.batch_norm2.bias", "module.block2.nblockLayer.0.batch_norm2.running_mean", "module.block2.nblockLayer.0.batch_norm2.running_var", "module.block2.nblockLayer.0.batch_norm2.num_batches_tracked", "module.block2.nblockLayer.0.conv1.weight", "module.block2.nblockLayer.0.conv2.weight", "module.block2.nblockLayer.0.conv_inp.weight", "module.block2.nblockLayer.1.batch_norm1.weight", "module.block2.nblockLayer.1.batch_norm1.bias", "module.block2.nblockLayer.1.batch_norm1.running_mean", "module.block2.nblockLayer.1.batch_norm1.running_var", "module.block2.nblockLayer.1.batch_norm1.num_batches_tracked", "module.block2.nblockLayer.1.batch_norm2.weight", "module.block2.nblockLayer.1.batch_norm2.bias", "module.block2.nblockLayer.1.batch_norm2.running_mean", "module.block2.nblockLayer.1.batch_norm2.running_var", "module.block2.nblockLayer.1.batch_norm2.num_batches_tracked", "module.block2.nblockLayer.1.conv1.weight", "module.block2.nblockLayer.1.conv2.weight", "module.block2.nblockLayer.2.batch_norm1.weight", "module.block2.nblockLayer.2.batch_norm1.bias", "module.block2.nblockLayer.2.batch_norm1.running_mean", "module.block2.nblockLayer.2.batch_norm1.running_var", "module.block2.nblockLayer.2.batch_norm1.num_batches_tracked", "module.block2.nblockLayer.2.batch_norm2.weight", "module.block2.nblockLayer.2.batch_norm2.bias", "module.block2.nblockLayer.2.batch_norm2.running_mean", "module.block2.nblockLayer.2.batch_norm2.running_var", "module.block2.nblockLayer.2.batch_norm2.num_batches_tracked", "module.block2.nblockLayer.2.conv1.weight", "module.block2.nblockLayer.2.conv2.weight", "module.block2.nblockLayer.3.batch_norm1.weight", "module.block2.nblockLayer.3.batch_norm1.bias", "module.block2.nblockLayer.3.batch_norm1.running_mean", "module.block2.nblockLayer.3.batch_norm1.running_var", "module.block2.nblockLayer.3.batch_norm1.num_batches_tracked", "module.block2.nblockLayer.3.batch_norm2.weight", "module.block2.nblockLayer.3.batch_norm2.bias", "module.block2.nblockLayer.3.batch_norm2.running_mean", "module.block2.nblockLayer.3.batch_norm2.running_var", "module.block2.nblockLayer.3.batch_norm2.num_batches_tracked", "module.block2.nblockLayer.3.conv1.weight", "module.block2.nblockLayer.3.conv2.weight", "module.block3.nblockLayer.0.batch_norm1.weight", "module.block3.nblockLayer.0.batch_norm1.bias", "module.block3.nblockLayer.0.batch_norm1.running_mean", "module.block3.nblockLayer.0.batch_norm1.running_var", "module.block3.nblockLayer.0.batch_norm1.num_batches_tracked", "module.block3.nblockLayer.0.batch_norm2.weight", "module.block3.nblockLayer.0.batch_norm2.bias", "module.block3.nblockLayer.0.batch_norm2.running_mean", "module.block3.nblockLayer.0.batch_norm2.running_var", "module.block3.nblockLayer.0.batch_norm2.num_batches_tracked", "module.block3.nblockLayer.0.conv1.weight", "module.block3.nblockLayer.0.conv2.weight", "module.block3.nblockLayer.0.conv_inp.weight", "module.block3.nblockLayer.1.batch_norm1.weight", "module.block3.nblockLayer.1.batch_norm1.bias", "module.block3.nblockLayer.1.batch_norm1.running_mean", "module.block3.nblockLayer.1.batch_norm1.running_var", "module.block3.nblockLayer.1.batch_norm1.num_batches_tracked", "module.block3.nblockLayer.1.batch_norm2.weight", "module.block3.nblockLayer.1.batch_norm2.bias", "module.block3.nblockLayer.1.batch_norm2.running_mean", "module.block3.nblockLayer.1.batch_norm2.running_var", "module.block3.nblockLayer.1.batch_norm2.num_batches_tracked", "module.block3.nblockLayer.1.conv1.weight", "module.block3.nblockLayer.1.conv2.weight", "module.block3.nblockLayer.2.batch_norm1.weight", "module.block3.nblockLayer.2.batch_norm1.bias", "module.block3.nblockLayer.2.batch_norm1.running_mean", "module.block3.nblockLayer.2.batch_norm1.running_var", "module.block3.nblockLayer.2.batch_norm1.num_batches_tracked", "module.block3.nblockLayer.2.batch_norm2.weight", "module.block3.nblockLayer.2.batch_norm2.bias", "module.block3.nblockLayer.2.batch_norm2.running_mean", "module.block3.nblockLayer.2.batch_norm2.running_var", "module.block3.nblockLayer.2.batch_norm2.num_batches_tracked", "module.block3.nblockLayer.2.conv1.weight", "module.block3.nblockLayer.2.conv2.weight", "module.block3.nblockLayer.3.batch_norm1.weight", "module.block3.nblockLayer.3.batch_norm1.bias", "module.block3.nblockLayer.3.batch_norm1.running_mean", "module.block3.nblockLayer.3.batch_norm1.running_var", "module.block3.nblockLayer.3.batch_norm1.num_batches_tracked", "module.block3.nblockLayer.3.batch_norm2.weight", "module.block3.nblockLayer.3.batch_norm2.bias", "module.block3.nblockLayer.3.batch_norm2.running_mean", "module.block3.nblockLayer.3.batch_norm2.running_var", "module.block3.nblockLayer.3.batch_norm2.num_batches_tracked", "module.block3.nblockLayer.3.conv1.weight", "module.block3.nblockLayer.3.conv2.weight", "module.batch_norm.weight", "module.batch_norm.bias", "module.batch_norm.running_mean", "module.batch_norm.running_var", "module.batch_norm.num_batches_tracked", "module.fc.weight", "module.fc.bias". 
# Batch size 1000, Train accuracy 98
Namespace(alpha_l_1=1.0, alpha_l_2=0.01, alpha_l_inf=0.001, batch_size=500, combine_ratio=0.5, concat=0, concat_factor=1.0, config_file=None, data_path=None, dataset='CIFAR10', device='cuda:0', distance=None, dropRate=0.0, epochs=50, epsilon_l_1=12, epsilon_l_2=0.5, epsilon_l_inf=0.03137254901960784, experiment='3-var', feature_type='rand', gap=0.001, gpu_id=0, imagenet_architecture='wrn', k=100, lr_max=0.1, lr_min=0.0, lr_mode=1, mode='teacher', model_dataset='CIFAR10', model_id='teacher_normalized', model_type='wrn-28-10', noise_sigma=0.05, normalize=1, num_iter=500, opt_type='SGD', path=None, pseudo_labels=0, randomize=0, regressor_embed=0, restarts=1, resume=0, resume_iter=-1, reverse_train_test=0, seed=0, smallest_adv=1, target_batch_size=1000, target_epoch=0, target_te_acc=0, target_tr_acc=98)
Model Directory: ./models/CIFAR10/model_teacher_normalized_1000
File Directory: ./files/CIFAR10_1000/model_teacher_normalized_tr_acc_98
cuda:0
22-10-07 18:02
No Transform
Files already downloaded and verified
Files already downloaded and verified
No Transform
Files already downloaded and verified
Files already downloaded and verified
Loading model from ./models/CIFAR10/model_teacher_normalized_1000/tr_acc_98.pt
Traceback (most recent call last):
  File "./src/generate_features.py", line 197, in feature_extractor
    student.load_state_dict(torch.load(location, map_location = args.device)) 
  File "/home/user/tingweijing/env/DIenv/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1223, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.block1.nblockLayer.4.batch_norm1.weight", "module.block1.nblockLayer.4.batch_norm1.bias", "module.block1.nblockLayer.4.batch_norm1.running_mean", "module.block1.nblockLayer.4.batch_norm1.running_var", "module.block1.nblockLayer.4.batch_norm2.weight", "module.block1.nblockLayer.4.batch_norm2.bias", "module.block1.nblockLayer.4.batch_norm2.running_mean", "module.block1.nblockLayer.4.batch_norm2.running_var", "module.block1.nblockLayer.4.conv1.weight", "module.block1.nblockLayer.4.conv2.weight", "module.block2.nblockLayer.4.batch_norm1.weight", "module.block2.nblockLayer.4.batch_norm1.bias", "module.block2.nblockLayer.4.batch_norm1.running_mean", "module.block2.nblockLayer.4.batch_norm1.running_var", "module.block2.nblockLayer.4.batch_norm2.weight", "module.block2.nblockLayer.4.batch_norm2.bias", "module.block2.nblockLayer.4.batch_norm2.running_mean", "module.block2.nblockLayer.4.batch_norm2.running_var", "module.block2.nblockLayer.4.conv1.weight", "module.block2.nblockLayer.4.conv2.weight", "module.block3.nblockLayer.4.batch_norm1.weight", "module.block3.nblockLayer.4.batch_norm1.bias", "module.block3.nblockLayer.4.batch_norm1.running_mean", "module.block3.nblockLayer.4.batch_norm1.running_var", "module.block3.nblockLayer.4.batch_norm2.weight", "module.block3.nblockLayer.4.batch_norm2.bias", "module.block3.nblockLayer.4.batch_norm2.running_mean", "module.block3.nblockLayer.4.batch_norm2.running_var", "module.block3.nblockLayer.4.conv1.weight", "module.block3.nblockLayer.4.conv2.weight". 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "./src/generate_features.py", line 405, in <module>
    feature_extractor(args)
  File "./src/generate_features.py", line 200, in feature_extractor
    student.load_state_dict(torch.load(location, map_location = args.device))   
  File "/home/user/tingweijing/env/DIenv/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1223, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.module.conv1.weight", "module.module.block1.nblockLayer.0.batch_norm1.weight", "module.module.block1.nblockLayer.0.batch_norm1.bias", "module.module.block1.nblockLayer.0.batch_norm1.running_mean", "module.module.block1.nblockLayer.0.batch_norm1.running_var", "module.module.block1.nblockLayer.0.batch_norm2.weight", "module.module.block1.nblockLayer.0.batch_norm2.bias", "module.module.block1.nblockLayer.0.batch_norm2.running_mean", "module.module.block1.nblockLayer.0.batch_norm2.running_var", "module.module.block1.nblockLayer.0.conv1.weight", "module.module.block1.nblockLayer.0.conv2.weight", "module.module.block1.nblockLayer.0.conv_inp.weight", "module.module.block1.nblockLayer.1.batch_norm1.weight", "module.module.block1.nblockLayer.1.batch_norm1.bias", "module.module.block1.nblockLayer.1.batch_norm1.running_mean", "module.module.block1.nblockLayer.1.batch_norm1.running_var", "module.module.block1.nblockLayer.1.batch_norm2.weight", "module.module.block1.nblockLayer.1.batch_norm2.bias", "module.module.block1.nblockLayer.1.batch_norm2.running_mean", "module.module.block1.nblockLayer.1.batch_norm2.running_var", "module.module.block1.nblockLayer.1.conv1.weight", "module.module.block1.nblockLayer.1.conv2.weight", "module.module.block1.nblockLayer.2.batch_norm1.weight", "module.module.block1.nblockLayer.2.batch_norm1.bias", "module.module.block1.nblockLayer.2.batch_norm1.running_mean", "module.module.block1.nblockLayer.2.batch_norm1.running_var", "module.module.block1.nblockLayer.2.batch_norm2.weight", "module.module.block1.nblockLayer.2.batch_norm2.bias", "module.module.block1.nblockLayer.2.batch_norm2.running_mean", "module.module.block1.nblockLayer.2.batch_norm2.running_var", "module.module.block1.nblockLayer.2.conv1.weight", "module.module.block1.nblockLayer.2.conv2.weight", "module.module.block1.nblockLayer.3.batch_norm1.weight", "module.module.block1.nblockLayer.3.batch_norm1.bias", "module.module.block1.nblockLayer.3.batch_norm1.running_mean", "module.module.block1.nblockLayer.3.batch_norm1.running_var", "module.module.block1.nblockLayer.3.batch_norm2.weight", "module.module.block1.nblockLayer.3.batch_norm2.bias", "module.module.block1.nblockLayer.3.batch_norm2.running_mean", "module.module.block1.nblockLayer.3.batch_norm2.running_var", "module.module.block1.nblockLayer.3.conv1.weight", "module.module.block1.nblockLayer.3.conv2.weight", "module.module.block1.nblockLayer.4.batch_norm1.weight", "module.module.block1.nblockLayer.4.batch_norm1.bias", "module.module.block1.nblockLayer.4.batch_norm1.running_mean", "module.module.block1.nblockLayer.4.batch_norm1.running_var", "module.module.block1.nblockLayer.4.batch_norm2.weight", "module.module.block1.nblockLayer.4.batch_norm2.bias", "module.module.block1.nblockLayer.4.batch_norm2.running_mean", "module.module.block1.nblockLayer.4.batch_norm2.running_var", "module.module.block1.nblockLayer.4.conv1.weight", "module.module.block1.nblockLayer.4.conv2.weight", "module.module.block2.nblockLayer.0.batch_norm1.weight", "module.module.block2.nblockLayer.0.batch_norm1.bias", "module.module.block2.nblockLayer.0.batch_norm1.running_mean", "module.module.block2.nblockLayer.0.batch_norm1.running_var", "module.module.block2.nblockLayer.0.batch_norm2.weight", "module.module.block2.nblockLayer.0.batch_norm2.bias", "module.module.block2.nblockLayer.0.batch_norm2.running_mean", "module.module.block2.nblockLayer.0.batch_norm2.running_var", "module.module.block2.nblockLayer.0.conv1.weight", "module.module.block2.nblockLayer.0.conv2.weight", "module.module.block2.nblockLayer.0.conv_inp.weight", "module.module.block2.nblockLayer.1.batch_norm1.weight", "module.module.block2.nblockLayer.1.batch_norm1.bias", "module.module.block2.nblockLayer.1.batch_norm1.running_mean", "module.module.block2.nblockLayer.1.batch_norm1.running_var", "module.module.block2.nblockLayer.1.batch_norm2.weight", "module.module.block2.nblockLayer.1.batch_norm2.bias", "module.module.block2.nblockLayer.1.batch_norm2.running_mean", "module.module.block2.nblockLayer.1.batch_norm2.running_var", "module.module.block2.nblockLayer.1.conv1.weight", "module.module.block2.nblockLayer.1.conv2.weight", "module.module.block2.nblockLayer.2.batch_norm1.weight", "module.module.block2.nblockLayer.2.batch_norm1.bias", "module.module.block2.nblockLayer.2.batch_norm1.running_mean", "module.module.block2.nblockLayer.2.batch_norm1.running_var", "module.module.block2.nblockLayer.2.batch_norm2.weight", "module.module.block2.nblockLayer.2.batch_norm2.bias", "module.module.block2.nblockLayer.2.batch_norm2.running_mean", "module.module.block2.nblockLayer.2.batch_norm2.running_var", "module.module.block2.nblockLayer.2.conv1.weight", "module.module.block2.nblockLayer.2.conv2.weight", "module.module.block2.nblockLayer.3.batch_norm1.weight", "module.module.block2.nblockLayer.3.batch_norm1.bias", "module.module.block2.nblockLayer.3.batch_norm1.running_mean", "module.module.block2.nblockLayer.3.batch_norm1.running_var", "module.module.block2.nblockLayer.3.batch_norm2.weight", "module.module.block2.nblockLayer.3.batch_norm2.bias", "module.module.block2.nblockLayer.3.batch_norm2.running_mean", "module.module.block2.nblockLayer.3.batch_norm2.running_var", "module.module.block2.nblockLayer.3.conv1.weight", "module.module.block2.nblockLayer.3.conv2.weight", "module.module.block2.nblockLayer.4.batch_norm1.weight", "module.module.block2.nblockLayer.4.batch_norm1.bias", "module.module.block2.nblockLayer.4.batch_norm1.running_mean", "module.module.block2.nblockLayer.4.batch_norm1.running_var", "module.module.block2.nblockLayer.4.batch_norm2.weight", "module.module.block2.nblockLayer.4.batch_norm2.bias", "module.module.block2.nblockLayer.4.batch_norm2.running_mean", "module.module.block2.nblockLayer.4.batch_norm2.running_var", "module.module.block2.nblockLayer.4.conv1.weight", "module.module.block2.nblockLayer.4.conv2.weight", "module.module.block3.nblockLayer.0.batch_norm1.weight", "module.module.block3.nblockLayer.0.batch_norm1.bias", "module.module.block3.nblockLayer.0.batch_norm1.running_mean", "module.module.block3.nblockLayer.0.batch_norm1.running_var", "module.module.block3.nblockLayer.0.batch_norm2.weight", "module.module.block3.nblockLayer.0.batch_norm2.bias", "module.module.block3.nblockLayer.0.batch_norm2.running_mean", "module.module.block3.nblockLayer.0.batch_norm2.running_var", "module.module.block3.nblockLayer.0.conv1.weight", "module.module.block3.nblockLayer.0.conv2.weight", "module.module.block3.nblockLayer.0.conv_inp.weight", "module.module.block3.nblockLayer.1.batch_norm1.weight", "module.module.block3.nblockLayer.1.batch_norm1.bias", "module.module.block3.nblockLayer.1.batch_norm1.running_mean", "module.module.block3.nblockLayer.1.batch_norm1.running_var", "module.module.block3.nblockLayer.1.batch_norm2.weight", "module.module.block3.nblockLayer.1.batch_norm2.bias", "module.module.block3.nblockLayer.1.batch_norm2.running_mean", "module.module.block3.nblockLayer.1.batch_norm2.running_var", "module.module.block3.nblockLayer.1.conv1.weight", "module.module.block3.nblockLayer.1.conv2.weight", "module.module.block3.nblockLayer.2.batch_norm1.weight", "module.module.block3.nblockLayer.2.batch_norm1.bias", "module.module.block3.nblockLayer.2.batch_norm1.running_mean", "module.module.block3.nblockLayer.2.batch_norm1.running_var", "module.module.block3.nblockLayer.2.batch_norm2.weight", "module.module.block3.nblockLayer.2.batch_norm2.bias", "module.module.block3.nblockLayer.2.batch_norm2.running_mean", "module.module.block3.nblockLayer.2.batch_norm2.running_var", "module.module.block3.nblockLayer.2.conv1.weight", "module.module.block3.nblockLayer.2.conv2.weight", "module.module.block3.nblockLayer.3.batch_norm1.weight", "module.module.block3.nblockLayer.3.batch_norm1.bias", "module.module.block3.nblockLayer.3.batch_norm1.running_mean", "module.module.block3.nblockLayer.3.batch_norm1.running_var", "module.module.block3.nblockLayer.3.batch_norm2.weight", "module.module.block3.nblockLayer.3.batch_norm2.bias", "module.module.block3.nblockLayer.3.batch_norm2.running_mean", "module.module.block3.nblockLayer.3.batch_norm2.running_var", "module.module.block3.nblockLayer.3.conv1.weight", "module.module.block3.nblockLayer.3.conv2.weight", "module.module.block3.nblockLayer.4.batch_norm1.weight", "module.module.block3.nblockLayer.4.batch_norm1.bias", "module.module.block3.nblockLayer.4.batch_norm1.running_mean", "module.module.block3.nblockLayer.4.batch_norm1.running_var", "module.module.block3.nblockLayer.4.batch_norm2.weight", "module.module.block3.nblockLayer.4.batch_norm2.bias", "module.module.block3.nblockLayer.4.batch_norm2.running_mean", "module.module.block3.nblockLayer.4.batch_norm2.running_var", "module.module.block3.nblockLayer.4.conv1.weight", "module.module.block3.nblockLayer.4.conv2.weight", "module.module.batch_norm.weight", "module.module.batch_norm.bias", "module.module.batch_norm.running_mean", "module.module.batch_norm.running_var", "module.module.fc.weight", "module.module.fc.bias". 
	Unexpected key(s) in state_dict: "module.conv1.weight", "module.block1.nblockLayer.0.batch_norm1.weight", "module.block1.nblockLayer.0.batch_norm1.bias", "module.block1.nblockLayer.0.batch_norm1.running_mean", "module.block1.nblockLayer.0.batch_norm1.running_var", "module.block1.nblockLayer.0.batch_norm1.num_batches_tracked", "module.block1.nblockLayer.0.batch_norm2.weight", "module.block1.nblockLayer.0.batch_norm2.bias", "module.block1.nblockLayer.0.batch_norm2.running_mean", "module.block1.nblockLayer.0.batch_norm2.running_var", "module.block1.nblockLayer.0.batch_norm2.num_batches_tracked", "module.block1.nblockLayer.0.conv1.weight", "module.block1.nblockLayer.0.conv2.weight", "module.block1.nblockLayer.0.conv_inp.weight", "module.block1.nblockLayer.1.batch_norm1.weight", "module.block1.nblockLayer.1.batch_norm1.bias", "module.block1.nblockLayer.1.batch_norm1.running_mean", "module.block1.nblockLayer.1.batch_norm1.running_var", "module.block1.nblockLayer.1.batch_norm1.num_batches_tracked", "module.block1.nblockLayer.1.batch_norm2.weight", "module.block1.nblockLayer.1.batch_norm2.bias", "module.block1.nblockLayer.1.batch_norm2.running_mean", "module.block1.nblockLayer.1.batch_norm2.running_var", "module.block1.nblockLayer.1.batch_norm2.num_batches_tracked", "module.block1.nblockLayer.1.conv1.weight", "module.block1.nblockLayer.1.conv2.weight", "module.block1.nblockLayer.2.batch_norm1.weight", "module.block1.nblockLayer.2.batch_norm1.bias", "module.block1.nblockLayer.2.batch_norm1.running_mean", "module.block1.nblockLayer.2.batch_norm1.running_var", "module.block1.nblockLayer.2.batch_norm1.num_batches_tracked", "module.block1.nblockLayer.2.batch_norm2.weight", "module.block1.nblockLayer.2.batch_norm2.bias", "module.block1.nblockLayer.2.batch_norm2.running_mean", "module.block1.nblockLayer.2.batch_norm2.running_var", "module.block1.nblockLayer.2.batch_norm2.num_batches_tracked", "module.block1.nblockLayer.2.conv1.weight", "module.block1.nblockLayer.2.conv2.weight", "module.block1.nblockLayer.3.batch_norm1.weight", "module.block1.nblockLayer.3.batch_norm1.bias", "module.block1.nblockLayer.3.batch_norm1.running_mean", "module.block1.nblockLayer.3.batch_norm1.running_var", "module.block1.nblockLayer.3.batch_norm1.num_batches_tracked", "module.block1.nblockLayer.3.batch_norm2.weight", "module.block1.nblockLayer.3.batch_norm2.bias", "module.block1.nblockLayer.3.batch_norm2.running_mean", "module.block1.nblockLayer.3.batch_norm2.running_var", "module.block1.nblockLayer.3.batch_norm2.num_batches_tracked", "module.block1.nblockLayer.3.conv1.weight", "module.block1.nblockLayer.3.conv2.weight", "module.block2.nblockLayer.0.batch_norm1.weight", "module.block2.nblockLayer.0.batch_norm1.bias", "module.block2.nblockLayer.0.batch_norm1.running_mean", "module.block2.nblockLayer.0.batch_norm1.running_var", "module.block2.nblockLayer.0.batch_norm1.num_batches_tracked", "module.block2.nblockLayer.0.batch_norm2.weight", "module.block2.nblockLayer.0.batch_norm2.bias", "module.block2.nblockLayer.0.batch_norm2.running_mean", "module.block2.nblockLayer.0.batch_norm2.running_var", "module.block2.nblockLayer.0.batch_norm2.num_batches_tracked", "module.block2.nblockLayer.0.conv1.weight", "module.block2.nblockLayer.0.conv2.weight", "module.block2.nblockLayer.0.conv_inp.weight", "module.block2.nblockLayer.1.batch_norm1.weight", "module.block2.nblockLayer.1.batch_norm1.bias", "module.block2.nblockLayer.1.batch_norm1.running_mean", "module.block2.nblockLayer.1.batch_norm1.running_var", "module.block2.nblockLayer.1.batch_norm1.num_batches_tracked", "module.block2.nblockLayer.1.batch_norm2.weight", "module.block2.nblockLayer.1.batch_norm2.bias", "module.block2.nblockLayer.1.batch_norm2.running_mean", "module.block2.nblockLayer.1.batch_norm2.running_var", "module.block2.nblockLayer.1.batch_norm2.num_batches_tracked", "module.block2.nblockLayer.1.conv1.weight", "module.block2.nblockLayer.1.conv2.weight", "module.block2.nblockLayer.2.batch_norm1.weight", "module.block2.nblockLayer.2.batch_norm1.bias", "module.block2.nblockLayer.2.batch_norm1.running_mean", "module.block2.nblockLayer.2.batch_norm1.running_var", "module.block2.nblockLayer.2.batch_norm1.num_batches_tracked", "module.block2.nblockLayer.2.batch_norm2.weight", "module.block2.nblockLayer.2.batch_norm2.bias", "module.block2.nblockLayer.2.batch_norm2.running_mean", "module.block2.nblockLayer.2.batch_norm2.running_var", "module.block2.nblockLayer.2.batch_norm2.num_batches_tracked", "module.block2.nblockLayer.2.conv1.weight", "module.block2.nblockLayer.2.conv2.weight", "module.block2.nblockLayer.3.batch_norm1.weight", "module.block2.nblockLayer.3.batch_norm1.bias", "module.block2.nblockLayer.3.batch_norm1.running_mean", "module.block2.nblockLayer.3.batch_norm1.running_var", "module.block2.nblockLayer.3.batch_norm1.num_batches_tracked", "module.block2.nblockLayer.3.batch_norm2.weight", "module.block2.nblockLayer.3.batch_norm2.bias", "module.block2.nblockLayer.3.batch_norm2.running_mean", "module.block2.nblockLayer.3.batch_norm2.running_var", "module.block2.nblockLayer.3.batch_norm2.num_batches_tracked", "module.block2.nblockLayer.3.conv1.weight", "module.block2.nblockLayer.3.conv2.weight", "module.block3.nblockLayer.0.batch_norm1.weight", "module.block3.nblockLayer.0.batch_norm1.bias", "module.block3.nblockLayer.0.batch_norm1.running_mean", "module.block3.nblockLayer.0.batch_norm1.running_var", "module.block3.nblockLayer.0.batch_norm1.num_batches_tracked", "module.block3.nblockLayer.0.batch_norm2.weight", "module.block3.nblockLayer.0.batch_norm2.bias", "module.block3.nblockLayer.0.batch_norm2.running_mean", "module.block3.nblockLayer.0.batch_norm2.running_var", "module.block3.nblockLayer.0.batch_norm2.num_batches_tracked", "module.block3.nblockLayer.0.conv1.weight", "module.block3.nblockLayer.0.conv2.weight", "module.block3.nblockLayer.0.conv_inp.weight", "module.block3.nblockLayer.1.batch_norm1.weight", "module.block3.nblockLayer.1.batch_norm1.bias", "module.block3.nblockLayer.1.batch_norm1.running_mean", "module.block3.nblockLayer.1.batch_norm1.running_var", "module.block3.nblockLayer.1.batch_norm1.num_batches_tracked", "module.block3.nblockLayer.1.batch_norm2.weight", "module.block3.nblockLayer.1.batch_norm2.bias", "module.block3.nblockLayer.1.batch_norm2.running_mean", "module.block3.nblockLayer.1.batch_norm2.running_var", "module.block3.nblockLayer.1.batch_norm2.num_batches_tracked", "module.block3.nblockLayer.1.conv1.weight", "module.block3.nblockLayer.1.conv2.weight", "module.block3.nblockLayer.2.batch_norm1.weight", "module.block3.nblockLayer.2.batch_norm1.bias", "module.block3.nblockLayer.2.batch_norm1.running_mean", "module.block3.nblockLayer.2.batch_norm1.running_var", "module.block3.nblockLayer.2.batch_norm1.num_batches_tracked", "module.block3.nblockLayer.2.batch_norm2.weight", "module.block3.nblockLayer.2.batch_norm2.bias", "module.block3.nblockLayer.2.batch_norm2.running_mean", "module.block3.nblockLayer.2.batch_norm2.running_var", "module.block3.nblockLayer.2.batch_norm2.num_batches_tracked", "module.block3.nblockLayer.2.conv1.weight", "module.block3.nblockLayer.2.conv2.weight", "module.block3.nblockLayer.3.batch_norm1.weight", "module.block3.nblockLayer.3.batch_norm1.bias", "module.block3.nblockLayer.3.batch_norm1.running_mean", "module.block3.nblockLayer.3.batch_norm1.running_var", "module.block3.nblockLayer.3.batch_norm1.num_batches_tracked", "module.block3.nblockLayer.3.batch_norm2.weight", "module.block3.nblockLayer.3.batch_norm2.bias", "module.block3.nblockLayer.3.batch_norm2.running_mean", "module.block3.nblockLayer.3.batch_norm2.running_var", "module.block3.nblockLayer.3.batch_norm2.num_batches_tracked", "module.block3.nblockLayer.3.conv1.weight", "module.block3.nblockLayer.3.conv2.weight", "module.batch_norm.weight", "module.batch_norm.bias", "module.batch_norm.running_mean", "module.batch_norm.running_var", "module.batch_norm.num_batches_tracked", "module.fc.weight", "module.fc.bias". 
# Batch size 1000, Train accuracy 99
Namespace(alpha_l_1=1.0, alpha_l_2=0.01, alpha_l_inf=0.001, batch_size=500, combine_ratio=0.5, concat=0, concat_factor=1.0, config_file=None, data_path=None, dataset='CIFAR10', device='cuda:0', distance=None, dropRate=0.0, epochs=50, epsilon_l_1=12, epsilon_l_2=0.5, epsilon_l_inf=0.03137254901960784, experiment='3-var', feature_type='rand', gap=0.001, gpu_id=0, imagenet_architecture='wrn', k=100, lr_max=0.1, lr_min=0.0, lr_mode=1, mode='teacher', model_dataset='CIFAR10', model_id='teacher_normalized', model_type='wrn-28-10', noise_sigma=0.05, normalize=1, num_iter=500, opt_type='SGD', path=None, pseudo_labels=0, randomize=0, regressor_embed=0, restarts=1, resume=0, resume_iter=-1, reverse_train_test=0, seed=0, smallest_adv=1, target_batch_size=1000, target_epoch=0, target_te_acc=0, target_tr_acc=99)
Model Directory: ./models/CIFAR10/model_teacher_normalized_1000
File Directory: ./files/CIFAR10_1000/model_teacher_normalized_tr_acc_99
cuda:0
22-10-07 18:02
No Transform
Files already downloaded and verified
Files already downloaded and verified
No Transform
Files already downloaded and verified
Files already downloaded and verified
Loading model from ./models/CIFAR10/model_teacher_normalized_1000/tr_acc_99.pt
Traceback (most recent call last):
  File "./src/generate_features.py", line 197, in feature_extractor
    student.load_state_dict(torch.load(location, map_location = args.device)) 
  File "/home/user/tingweijing/env/DIenv/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1223, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.block1.nblockLayer.4.batch_norm1.weight", "module.block1.nblockLayer.4.batch_norm1.bias", "module.block1.nblockLayer.4.batch_norm1.running_mean", "module.block1.nblockLayer.4.batch_norm1.running_var", "module.block1.nblockLayer.4.batch_norm2.weight", "module.block1.nblockLayer.4.batch_norm2.bias", "module.block1.nblockLayer.4.batch_norm2.running_mean", "module.block1.nblockLayer.4.batch_norm2.running_var", "module.block1.nblockLayer.4.conv1.weight", "module.block1.nblockLayer.4.conv2.weight", "module.block2.nblockLayer.4.batch_norm1.weight", "module.block2.nblockLayer.4.batch_norm1.bias", "module.block2.nblockLayer.4.batch_norm1.running_mean", "module.block2.nblockLayer.4.batch_norm1.running_var", "module.block2.nblockLayer.4.batch_norm2.weight", "module.block2.nblockLayer.4.batch_norm2.bias", "module.block2.nblockLayer.4.batch_norm2.running_mean", "module.block2.nblockLayer.4.batch_norm2.running_var", "module.block2.nblockLayer.4.conv1.weight", "module.block2.nblockLayer.4.conv2.weight", "module.block3.nblockLayer.4.batch_norm1.weight", "module.block3.nblockLayer.4.batch_norm1.bias", "module.block3.nblockLayer.4.batch_norm1.running_mean", "module.block3.nblockLayer.4.batch_norm1.running_var", "module.block3.nblockLayer.4.batch_norm2.weight", "module.block3.nblockLayer.4.batch_norm2.bias", "module.block3.nblockLayer.4.batch_norm2.running_mean", "module.block3.nblockLayer.4.batch_norm2.running_var", "module.block3.nblockLayer.4.conv1.weight", "module.block3.nblockLayer.4.conv2.weight". 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "./src/generate_features.py", line 405, in <module>
    feature_extractor(args)
  File "./src/generate_features.py", line 200, in feature_extractor
    student.load_state_dict(torch.load(location, map_location = args.device))   
  File "/home/user/tingweijing/env/DIenv/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1223, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for DataParallel:
	Missing key(s) in state_dict: "module.module.conv1.weight", "module.module.block1.nblockLayer.0.batch_norm1.weight", "module.module.block1.nblockLayer.0.batch_norm1.bias", "module.module.block1.nblockLayer.0.batch_norm1.running_mean", "module.module.block1.nblockLayer.0.batch_norm1.running_var", "module.module.block1.nblockLayer.0.batch_norm2.weight", "module.module.block1.nblockLayer.0.batch_norm2.bias", "module.module.block1.nblockLayer.0.batch_norm2.running_mean", "module.module.block1.nblockLayer.0.batch_norm2.running_var", "module.module.block1.nblockLayer.0.conv1.weight", "module.module.block1.nblockLayer.0.conv2.weight", "module.module.block1.nblockLayer.0.conv_inp.weight", "module.module.block1.nblockLayer.1.batch_norm1.weight", "module.module.block1.nblockLayer.1.batch_norm1.bias", "module.module.block1.nblockLayer.1.batch_norm1.running_mean", "module.module.block1.nblockLayer.1.batch_norm1.running_var", "module.module.block1.nblockLayer.1.batch_norm2.weight", "module.module.block1.nblockLayer.1.batch_norm2.bias", "module.module.block1.nblockLayer.1.batch_norm2.running_mean", "module.module.block1.nblockLayer.1.batch_norm2.running_var", "module.module.block1.nblockLayer.1.conv1.weight", "module.module.block1.nblockLayer.1.conv2.weight", "module.module.block1.nblockLayer.2.batch_norm1.weight", "module.module.block1.nblockLayer.2.batch_norm1.bias", "module.module.block1.nblockLayer.2.batch_norm1.running_mean", "module.module.block1.nblockLayer.2.batch_norm1.running_var", "module.module.block1.nblockLayer.2.batch_norm2.weight", "module.module.block1.nblockLayer.2.batch_norm2.bias", "module.module.block1.nblockLayer.2.batch_norm2.running_mean", "module.module.block1.nblockLayer.2.batch_norm2.running_var", "module.module.block1.nblockLayer.2.conv1.weight", "module.module.block1.nblockLayer.2.conv2.weight", "module.module.block1.nblockLayer.3.batch_norm1.weight", "module.module.block1.nblockLayer.3.batch_norm1.bias", "module.module.block1.nblockLayer.3.batch_norm1.running_mean", "module.module.block1.nblockLayer.3.batch_norm1.running_var", "module.module.block1.nblockLayer.3.batch_norm2.weight", "module.module.block1.nblockLayer.3.batch_norm2.bias", "module.module.block1.nblockLayer.3.batch_norm2.running_mean", "module.module.block1.nblockLayer.3.batch_norm2.running_var", "module.module.block1.nblockLayer.3.conv1.weight", "module.module.block1.nblockLayer.3.conv2.weight", "module.module.block1.nblockLayer.4.batch_norm1.weight", "module.module.block1.nblockLayer.4.batch_norm1.bias", "module.module.block1.nblockLayer.4.batch_norm1.running_mean", "module.module.block1.nblockLayer.4.batch_norm1.running_var", "module.module.block1.nblockLayer.4.batch_norm2.weight", "module.module.block1.nblockLayer.4.batch_norm2.bias", "module.module.block1.nblockLayer.4.batch_norm2.running_mean", "module.module.block1.nblockLayer.4.batch_norm2.running_var", "module.module.block1.nblockLayer.4.conv1.weight", "module.module.block1.nblockLayer.4.conv2.weight", "module.module.block2.nblockLayer.0.batch_norm1.weight", "module.module.block2.nblockLayer.0.batch_norm1.bias", "module.module.block2.nblockLayer.0.batch_norm1.running_mean", "module.module.block2.nblockLayer.0.batch_norm1.running_var", "module.module.block2.nblockLayer.0.batch_norm2.weight", "module.module.block2.nblockLayer.0.batch_norm2.bias", "module.module.block2.nblockLayer.0.batch_norm2.running_mean", "module.module.block2.nblockLayer.0.batch_norm2.running_var", "module.module.block2.nblockLayer.0.conv1.weight", "module.module.block2.nblockLayer.0.conv2.weight", "module.module.block2.nblockLayer.0.conv_inp.weight", "module.module.block2.nblockLayer.1.batch_norm1.weight", "module.module.block2.nblockLayer.1.batch_norm1.bias", "module.module.block2.nblockLayer.1.batch_norm1.running_mean", "module.module.block2.nblockLayer.1.batch_norm1.running_var", "module.module.block2.nblockLayer.1.batch_norm2.weight", "module.module.block2.nblockLayer.1.batch_norm2.bias", "module.module.block2.nblockLayer.1.batch_norm2.running_mean", "module.module.block2.nblockLayer.1.batch_norm2.running_var", "module.module.block2.nblockLayer.1.conv1.weight", "module.module.block2.nblockLayer.1.conv2.weight", "module.module.block2.nblockLayer.2.batch_norm1.weight", "module.module.block2.nblockLayer.2.batch_norm1.bias", "module.module.block2.nblockLayer.2.batch_norm1.running_mean", "module.module.block2.nblockLayer.2.batch_norm1.running_var", "module.module.block2.nblockLayer.2.batch_norm2.weight", "module.module.block2.nblockLayer.2.batch_norm2.bias", "module.module.block2.nblockLayer.2.batch_norm2.running_mean", "module.module.block2.nblockLayer.2.batch_norm2.running_var", "module.module.block2.nblockLayer.2.conv1.weight", "module.module.block2.nblockLayer.2.conv2.weight", "module.module.block2.nblockLayer.3.batch_norm1.weight", "module.module.block2.nblockLayer.3.batch_norm1.bias", "module.module.block2.nblockLayer.3.batch_norm1.running_mean", "module.module.block2.nblockLayer.3.batch_norm1.running_var", "module.module.block2.nblockLayer.3.batch_norm2.weight", "module.module.block2.nblockLayer.3.batch_norm2.bias", "module.module.block2.nblockLayer.3.batch_norm2.running_mean", "module.module.block2.nblockLayer.3.batch_norm2.running_var", "module.module.block2.nblockLayer.3.conv1.weight", "module.module.block2.nblockLayer.3.conv2.weight", "module.module.block2.nblockLayer.4.batch_norm1.weight", "module.module.block2.nblockLayer.4.batch_norm1.bias", "module.module.block2.nblockLayer.4.batch_norm1.running_mean", "module.module.block2.nblockLayer.4.batch_norm1.running_var", "module.module.block2.nblockLayer.4.batch_norm2.weight", "module.module.block2.nblockLayer.4.batch_norm2.bias", "module.module.block2.nblockLayer.4.batch_norm2.running_mean", "module.module.block2.nblockLayer.4.batch_norm2.running_var", "module.module.block2.nblockLayer.4.conv1.weight", "module.module.block2.nblockLayer.4.conv2.weight", "module.module.block3.nblockLayer.0.batch_norm1.weight", "module.module.block3.nblockLayer.0.batch_norm1.bias", "module.module.block3.nblockLayer.0.batch_norm1.running_mean", "module.module.block3.nblockLayer.0.batch_norm1.running_var", "module.module.block3.nblockLayer.0.batch_norm2.weight", "module.module.block3.nblockLayer.0.batch_norm2.bias", "module.module.block3.nblockLayer.0.batch_norm2.running_mean", "module.module.block3.nblockLayer.0.batch_norm2.running_var", "module.module.block3.nblockLayer.0.conv1.weight", "module.module.block3.nblockLayer.0.conv2.weight", "module.module.block3.nblockLayer.0.conv_inp.weight", "module.module.block3.nblockLayer.1.batch_norm1.weight", "module.module.block3.nblockLayer.1.batch_norm1.bias", "module.module.block3.nblockLayer.1.batch_norm1.running_mean", "module.module.block3.nblockLayer.1.batch_norm1.running_var", "module.module.block3.nblockLayer.1.batch_norm2.weight", "module.module.block3.nblockLayer.1.batch_norm2.bias", "module.module.block3.nblockLayer.1.batch_norm2.running_mean", "module.module.block3.nblockLayer.1.batch_norm2.running_var", "module.module.block3.nblockLayer.1.conv1.weight", "module.module.block3.nblockLayer.1.conv2.weight", "module.module.block3.nblockLayer.2.batch_norm1.weight", "module.module.block3.nblockLayer.2.batch_norm1.bias", "module.module.block3.nblockLayer.2.batch_norm1.running_mean", "module.module.block3.nblockLayer.2.batch_norm1.running_var", "module.module.block3.nblockLayer.2.batch_norm2.weight", "module.module.block3.nblockLayer.2.batch_norm2.bias", "module.module.block3.nblockLayer.2.batch_norm2.running_mean", "module.module.block3.nblockLayer.2.batch_norm2.running_var", "module.module.block3.nblockLayer.2.conv1.weight", "module.module.block3.nblockLayer.2.conv2.weight", "module.module.block3.nblockLayer.3.batch_norm1.weight", "module.module.block3.nblockLayer.3.batch_norm1.bias", "module.module.block3.nblockLayer.3.batch_norm1.running_mean", "module.module.block3.nblockLayer.3.batch_norm1.running_var", "module.module.block3.nblockLayer.3.batch_norm2.weight", "module.module.block3.nblockLayer.3.batch_norm2.bias", "module.module.block3.nblockLayer.3.batch_norm2.running_mean", "module.module.block3.nblockLayer.3.batch_norm2.running_var", "module.module.block3.nblockLayer.3.conv1.weight", "module.module.block3.nblockLayer.3.conv2.weight", "module.module.block3.nblockLayer.4.batch_norm1.weight", "module.module.block3.nblockLayer.4.batch_norm1.bias", "module.module.block3.nblockLayer.4.batch_norm1.running_mean", "module.module.block3.nblockLayer.4.batch_norm1.running_var", "module.module.block3.nblockLayer.4.batch_norm2.weight", "module.module.block3.nblockLayer.4.batch_norm2.bias", "module.module.block3.nblockLayer.4.batch_norm2.running_mean", "module.module.block3.nblockLayer.4.batch_norm2.running_var", "module.module.block3.nblockLayer.4.conv1.weight", "module.module.block3.nblockLayer.4.conv2.weight", "module.module.batch_norm.weight", "module.module.batch_norm.bias", "module.module.batch_norm.running_mean", "module.module.batch_norm.running_var", "module.module.fc.weight", "module.module.fc.bias". 
	Unexpected key(s) in state_dict: "module.conv1.weight", "module.block1.nblockLayer.0.batch_norm1.weight", "module.block1.nblockLayer.0.batch_norm1.bias", "module.block1.nblockLayer.0.batch_norm1.running_mean", "module.block1.nblockLayer.0.batch_norm1.running_var", "module.block1.nblockLayer.0.batch_norm1.num_batches_tracked", "module.block1.nblockLayer.0.batch_norm2.weight", "module.block1.nblockLayer.0.batch_norm2.bias", "module.block1.nblockLayer.0.batch_norm2.running_mean", "module.block1.nblockLayer.0.batch_norm2.running_var", "module.block1.nblockLayer.0.batch_norm2.num_batches_tracked", "module.block1.nblockLayer.0.conv1.weight", "module.block1.nblockLayer.0.conv2.weight", "module.block1.nblockLayer.0.conv_inp.weight", "module.block1.nblockLayer.1.batch_norm1.weight", "module.block1.nblockLayer.1.batch_norm1.bias", "module.block1.nblockLayer.1.batch_norm1.running_mean", "module.block1.nblockLayer.1.batch_norm1.running_var", "module.block1.nblockLayer.1.batch_norm1.num_batches_tracked", "module.block1.nblockLayer.1.batch_norm2.weight", "module.block1.nblockLayer.1.batch_norm2.bias", "module.block1.nblockLayer.1.batch_norm2.running_mean", "module.block1.nblockLayer.1.batch_norm2.running_var", "module.block1.nblockLayer.1.batch_norm2.num_batches_tracked", "module.block1.nblockLayer.1.conv1.weight", "module.block1.nblockLayer.1.conv2.weight", "module.block1.nblockLayer.2.batch_norm1.weight", "module.block1.nblockLayer.2.batch_norm1.bias", "module.block1.nblockLayer.2.batch_norm1.running_mean", "module.block1.nblockLayer.2.batch_norm1.running_var", "module.block1.nblockLayer.2.batch_norm1.num_batches_tracked", "module.block1.nblockLayer.2.batch_norm2.weight", "module.block1.nblockLayer.2.batch_norm2.bias", "module.block1.nblockLayer.2.batch_norm2.running_mean", "module.block1.nblockLayer.2.batch_norm2.running_var", "module.block1.nblockLayer.2.batch_norm2.num_batches_tracked", "module.block1.nblockLayer.2.conv1.weight", "module.block1.nblockLayer.2.conv2.weight", "module.block1.nblockLayer.3.batch_norm1.weight", "module.block1.nblockLayer.3.batch_norm1.bias", "module.block1.nblockLayer.3.batch_norm1.running_mean", "module.block1.nblockLayer.3.batch_norm1.running_var", "module.block1.nblockLayer.3.batch_norm1.num_batches_tracked", "module.block1.nblockLayer.3.batch_norm2.weight", "module.block1.nblockLayer.3.batch_norm2.bias", "module.block1.nblockLayer.3.batch_norm2.running_mean", "module.block1.nblockLayer.3.batch_norm2.running_var", "module.block1.nblockLayer.3.batch_norm2.num_batches_tracked", "module.block1.nblockLayer.3.conv1.weight", "module.block1.nblockLayer.3.conv2.weight", "module.block2.nblockLayer.0.batch_norm1.weight", "module.block2.nblockLayer.0.batch_norm1.bias", "module.block2.nblockLayer.0.batch_norm1.running_mean", "module.block2.nblockLayer.0.batch_norm1.running_var", "module.block2.nblockLayer.0.batch_norm1.num_batches_tracked", "module.block2.nblockLayer.0.batch_norm2.weight", "module.block2.nblockLayer.0.batch_norm2.bias", "module.block2.nblockLayer.0.batch_norm2.running_mean", "module.block2.nblockLayer.0.batch_norm2.running_var", "module.block2.nblockLayer.0.batch_norm2.num_batches_tracked", "module.block2.nblockLayer.0.conv1.weight", "module.block2.nblockLayer.0.conv2.weight", "module.block2.nblockLayer.0.conv_inp.weight", "module.block2.nblockLayer.1.batch_norm1.weight", "module.block2.nblockLayer.1.batch_norm1.bias", "module.block2.nblockLayer.1.batch_norm1.running_mean", "module.block2.nblockLayer.1.batch_norm1.running_var", "module.block2.nblockLayer.1.batch_norm1.num_batches_tracked", "module.block2.nblockLayer.1.batch_norm2.weight", "module.block2.nblockLayer.1.batch_norm2.bias", "module.block2.nblockLayer.1.batch_norm2.running_mean", "module.block2.nblockLayer.1.batch_norm2.running_var", "module.block2.nblockLayer.1.batch_norm2.num_batches_tracked", "module.block2.nblockLayer.1.conv1.weight", "module.block2.nblockLayer.1.conv2.weight", "module.block2.nblockLayer.2.batch_norm1.weight", "module.block2.nblockLayer.2.batch_norm1.bias", "module.block2.nblockLayer.2.batch_norm1.running_mean", "module.block2.nblockLayer.2.batch_norm1.running_var", "module.block2.nblockLayer.2.batch_norm1.num_batches_tracked", "module.block2.nblockLayer.2.batch_norm2.weight", "module.block2.nblockLayer.2.batch_norm2.bias", "module.block2.nblockLayer.2.batch_norm2.running_mean", "module.block2.nblockLayer.2.batch_norm2.running_var", "module.block2.nblockLayer.2.batch_norm2.num_batches_tracked", "module.block2.nblockLayer.2.conv1.weight", "module.block2.nblockLayer.2.conv2.weight", "module.block2.nblockLayer.3.batch_norm1.weight", "module.block2.nblockLayer.3.batch_norm1.bias", "module.block2.nblockLayer.3.batch_norm1.running_mean", "module.block2.nblockLayer.3.batch_norm1.running_var", "module.block2.nblockLayer.3.batch_norm1.num_batches_tracked", "module.block2.nblockLayer.3.batch_norm2.weight", "module.block2.nblockLayer.3.batch_norm2.bias", "module.block2.nblockLayer.3.batch_norm2.running_mean", "module.block2.nblockLayer.3.batch_norm2.running_var", "module.block2.nblockLayer.3.batch_norm2.num_batches_tracked", "module.block2.nblockLayer.3.conv1.weight", "module.block2.nblockLayer.3.conv2.weight", "module.block3.nblockLayer.0.batch_norm1.weight", "module.block3.nblockLayer.0.batch_norm1.bias", "module.block3.nblockLayer.0.batch_norm1.running_mean", "module.block3.nblockLayer.0.batch_norm1.running_var", "module.block3.nblockLayer.0.batch_norm1.num_batches_tracked", "module.block3.nblockLayer.0.batch_norm2.weight", "module.block3.nblockLayer.0.batch_norm2.bias", "module.block3.nblockLayer.0.batch_norm2.running_mean", "module.block3.nblockLayer.0.batch_norm2.running_var", "module.block3.nblockLayer.0.batch_norm2.num_batches_tracked", "module.block3.nblockLayer.0.conv1.weight", "module.block3.nblockLayer.0.conv2.weight", "module.block3.nblockLayer.0.conv_inp.weight", "module.block3.nblockLayer.1.batch_norm1.weight", "module.block3.nblockLayer.1.batch_norm1.bias", "module.block3.nblockLayer.1.batch_norm1.running_mean", "module.block3.nblockLayer.1.batch_norm1.running_var", "module.block3.nblockLayer.1.batch_norm1.num_batches_tracked", "module.block3.nblockLayer.1.batch_norm2.weight", "module.block3.nblockLayer.1.batch_norm2.bias", "module.block3.nblockLayer.1.batch_norm2.running_mean", "module.block3.nblockLayer.1.batch_norm2.running_var", "module.block3.nblockLayer.1.batch_norm2.num_batches_tracked", "module.block3.nblockLayer.1.conv1.weight", "module.block3.nblockLayer.1.conv2.weight", "module.block3.nblockLayer.2.batch_norm1.weight", "module.block3.nblockLayer.2.batch_norm1.bias", "module.block3.nblockLayer.2.batch_norm1.running_mean", "module.block3.nblockLayer.2.batch_norm1.running_var", "module.block3.nblockLayer.2.batch_norm1.num_batches_tracked", "module.block3.nblockLayer.2.batch_norm2.weight", "module.block3.nblockLayer.2.batch_norm2.bias", "module.block3.nblockLayer.2.batch_norm2.running_mean", "module.block3.nblockLayer.2.batch_norm2.running_var", "module.block3.nblockLayer.2.batch_norm2.num_batches_tracked", "module.block3.nblockLayer.2.conv1.weight", "module.block3.nblockLayer.2.conv2.weight", "module.block3.nblockLayer.3.batch_norm1.weight", "module.block3.nblockLayer.3.batch_norm1.bias", "module.block3.nblockLayer.3.batch_norm1.running_mean", "module.block3.nblockLayer.3.batch_norm1.running_var", "module.block3.nblockLayer.3.batch_norm1.num_batches_tracked", "module.block3.nblockLayer.3.batch_norm2.weight", "module.block3.nblockLayer.3.batch_norm2.bias", "module.block3.nblockLayer.3.batch_norm2.running_mean", "module.block3.nblockLayer.3.batch_norm2.running_var", "module.block3.nblockLayer.3.batch_norm2.num_batches_tracked", "module.block3.nblockLayer.3.conv1.weight", "module.block3.nblockLayer.3.conv2.weight", "module.batch_norm.weight", "module.batch_norm.bias", "module.batch_norm.running_mean", "module.batch_norm.running_var", "module.batch_norm.num_batches_tracked", "module.fc.weight", "module.fc.bias". 
